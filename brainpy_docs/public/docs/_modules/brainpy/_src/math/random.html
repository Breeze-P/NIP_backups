

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>brainpy._src.math.random &#8212; BrainPy documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-thebe.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '_modules/brainpy/_src/math/random';</script>
    <link rel="shortcut icon" href="../../../../_static/logo-square.png"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../../../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../../../../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../../../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Quickstart</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../../quickstart/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../quickstart/simulation.html">Simulating a Brain Dynamics Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../quickstart/training.html">Training a Brain Dynamics Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../quickstart/analysis.html">Analyzing a Brain Dynamics Model</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">BrainPy Core Concepts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../../core_concept/brainpy_transform_concept.html">Concept 1: Object-oriented Transformation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../core_concept/brainpy_dynamical_system.html">Concept 2: Dynamical System</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Brain Dynamics Tutorials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../tutorial_math/index.html">Math Foundation</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../tutorial_math/variables.html"><code class="docutils literal notranslate"><span class="pre">brainpy.math.Variable</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tutorial_math/control_flows.html">Control Flows for JIT compilation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tutorial_math/random_number_generation.html">Random Number Generation for JIT Compilation</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../tutorial_building/index.html">Model Building</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../tutorial_building/overview_of_dynamic_model.html">Using Built-in Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tutorial_building/build_conductance_neurons.html">Building Conductance-based Neuron Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tutorial_building/build_synapse_models.html">Building Synapse Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tutorial_building/build_network_models.html">Building Network Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tutorial_building/customize_neuron_models.html">Customizing Your Neuron Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tutorial_building/customize_synapse_models.html">Customizing Your Synapse Models</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../tutorial_simulation/index.html">Model Simulation</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../tutorial_simulation/simulation_dsrunner.html">Simulation with <code class="docutils literal notranslate"><span class="pre">DSRunner</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tutorial_simulation/parallel_computing.html">Parallel Simulation for Parameter Exploration</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../tutorial_training/index.html">Model Training</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../tutorial_training/build_training_models.html">Building Training Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tutorial_training/offline_training.html">Training with Offline Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tutorial_training/online_training.html">Training with Online Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tutorial_training/bp_training.html">Training with Back-propagation Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tutorial_training/esn_introduction.html">Introduction to Echo State Network</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../tutorial_analysis/index.html">Model Analysis</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../tutorial_analysis/lowdim_analysis.html">Low-dimensional Analyzers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tutorial_analysis/highdim_analysis.html">High-dimensional Analyzers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../tutorial_analysis/decision_making_model.html">Analysis of a Decision-making Model</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Advanced Tutorials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorial_advanced/adavanced_lowdim_analysis.html">How does low-dimensional analyzers work?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorial_advanced/interoperation.html">Interoperation with other JAX frameworks</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Toolboxes</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorial_toolbox/ode_numerical_solvers.html">Numerical Solvers for Ordinary Differential Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorial_toolbox/sde_numerical_solvers.html">Numerical Solvers for Stochastic Differential Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorial_toolbox/fde_numerical_solvers.html">Numerical Solvers for Fractional Differential Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorial_toolbox/dde_numerical_solvers.html">Numerical Solvers for Delay Differential Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorial_toolbox/joint_equations.html">Joint Differential Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorial_toolbox/synaptic_connections.html">Synaptic Connections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorial_toolbox/synaptic_weights.html">Synaptic Weights</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorial_toolbox/optimizers.html">Gradient Descent Optimizers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorial_toolbox/saving_and_loading.html">Saving and Loading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorial_toolbox/inputs.html">Inputs Construction</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Frequently Asked Questions</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorial_FAQs/citing_and_publication.html">How to cite BrainPy?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorial_FAQs/uniqueness_of-brainpy-math.html">How is <code class="docutils literal notranslate"><span class="pre">brainpy</span></code> different from other frameworks?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorial_FAQs/brainpy_ecosystem.html">BrainPy Ecosystem for Brain Dynamics Modeling</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../apis/auto/brainpy.html"><code class="docutils literal notranslate"><span class="pre">brainpy</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.Integrator.html">brainpy.Integrator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.JointEq.html">brainpy.JointEq</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.IntegratorRunner.html">brainpy.IntegratorRunner</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.odeint.html">brainpy.odeint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.sdeint.html">brainpy.sdeint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.fdeint.html">brainpy.fdeint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.DynamicalSystem.html">brainpy.DynamicalSystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.Container.html">brainpy.Container</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.Sequential.html">brainpy.Sequential</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.Network.html">brainpy.Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.NeuGroup.html">brainpy.NeuGroup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.SynConn.html">brainpy.SynConn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.SynOut.html">brainpy.SynOut</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.SynSTP.html">brainpy.SynSTP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.SynLTP.html">brainpy.SynLTP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.TwoEndConn.html">brainpy.TwoEndConn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.CondNeuGroup.html">brainpy.CondNeuGroup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.Channel.html">brainpy.Channel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.DSRunner.html">brainpy.DSRunner</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.DSTrainer.html">brainpy.DSTrainer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.BPTT.html">brainpy.BPTT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.BPFF.html">brainpy.BPFF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.OnlineTrainer.html">brainpy.OnlineTrainer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.ForceTrainer.html">brainpy.ForceTrainer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.OfflineTrainer.html">brainpy.OfflineTrainer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.RidgeTrainer.html">brainpy.RidgeTrainer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.NoSharedArg.html">brainpy.NoSharedArg</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.LoopOverTime.html">brainpy.LoopOverTime</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../apis/auto/math.html"><code class="docutils literal notranslate"><span class="pre">brainpy.math</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.BrainPyObject.html">brainpy.math.BrainPyObject</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.FunAsObject.html">brainpy.math.FunAsObject</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.dyn_seq.html">brainpy.math.dyn_seq</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.dyn_dict.html">brainpy.math.dyn_dict</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.Variable.html">brainpy.math.Variable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.Parameter.html">brainpy.math.Parameter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.TrainVar.html">brainpy.math.TrainVar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.Partial.html">brainpy.math.Partial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.grad.html">brainpy.math.grad</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.vector_grad.html">brainpy.math.vector_grad</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.jacobian.html">brainpy.math.jacobian</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.jacrev.html">brainpy.math.jacrev</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.jacfwd.html">brainpy.math.jacfwd</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.hessian.html">brainpy.math.hessian</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.make_loop.html">brainpy.math.make_loop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.make_while.html">brainpy.math.make_while</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.make_cond.html">brainpy.math.make_cond</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.cond.html">brainpy.math.cond</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.ifelse.html">brainpy.math.ifelse</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.for_loop.html">brainpy.math.for_loop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.while_loop.html">brainpy.math.while_loop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.to_object.html">brainpy.math.to_object</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.to_dynsys.html">brainpy.math.to_dynsys</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.function.html">brainpy.math.function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.jit.html">brainpy.math.jit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.ObjectTransform.html">brainpy.math.ObjectTransform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.pre2post_sum.html">brainpy.math.pre2post_sum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.pre2post_prod.html">brainpy.math.pre2post_prod</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.pre2post_max.html">brainpy.math.pre2post_max</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.pre2post_min.html">brainpy.math.pre2post_min</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.pre2post_mean.html">brainpy.math.pre2post_mean</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.pre2post_event_sum.html">brainpy.math.pre2post_event_sum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.pre2post_coo_event_sum.html">brainpy.math.pre2post_coo_event_sum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.pre2post_event_prod.html">brainpy.math.pre2post_event_prod</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.pre2syn.html">brainpy.math.pre2syn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.syn2post_sum.html">brainpy.math.syn2post_sum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.syn2post.html">brainpy.math.syn2post</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.syn2post_prod.html">brainpy.math.syn2post_prod</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.syn2post_max.html">brainpy.math.syn2post_max</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.syn2post_min.html">brainpy.math.syn2post_min</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.syn2post_mean.html">brainpy.math.syn2post_mean</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.syn2post_softmax.html">brainpy.math.syn2post_softmax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.sparse_matmul.html">brainpy.math.sparse_matmul</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.csr_matvec.html">brainpy.math.csr_matvec</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.event_csr_matvec.html">brainpy.math.event_csr_matvec</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.XLACustomOp.html">brainpy.math.XLACustomOp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.celu.html">brainpy.math.celu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.elu.html">brainpy.math.elu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.gelu.html">brainpy.math.gelu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.glu.html">brainpy.math.glu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.hard_tanh.html">brainpy.math.hard_tanh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.hard_sigmoid.html">brainpy.math.hard_sigmoid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.hard_silu.html">brainpy.math.hard_silu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.hard_swish.html">brainpy.math.hard_swish</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.leaky_relu.html">brainpy.math.leaky_relu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.log_sigmoid.html">brainpy.math.log_sigmoid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.log_softmax.html">brainpy.math.log_softmax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.one_hot.html">brainpy.math.one_hot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.normalize.html">brainpy.math.normalize</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.relu.html">brainpy.math.relu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.relu6.html">brainpy.math.relu6</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.sigmoid.html">brainpy.math.sigmoid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.soft_sign.html">brainpy.math.soft_sign</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.softmax.html">brainpy.math.softmax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.softplus.html">brainpy.math.softplus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.silu.html">brainpy.math.silu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.swish.html">brainpy.math.swish</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.selu.html">brainpy.math.selu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.identity.html">brainpy.math.identity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.TimeDelay.html">brainpy.math.TimeDelay</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.LengthDelay.html">brainpy.math.LengthDelay</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.NeuTimeDelay.html">brainpy.math.NeuTimeDelay</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.NeuLenDelay.html">brainpy.math.NeuLenDelay</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.DelayVariable.html">brainpy.math.DelayVariable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.ROTATE_UPDATE.html">brainpy.math.ROTATE_UPDATE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.CONCAT_UPDATE.html">brainpy.math.CONCAT_UPDATE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.set_float.html">brainpy.math.set_float</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.get_float.html">brainpy.math.get_float</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.set_int.html">brainpy.math.set_int</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.get_int.html">brainpy.math.get_int</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.set_bool.html">brainpy.math.set_bool</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.get_bool.html">brainpy.math.get_bool</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.set_complex.html">brainpy.math.set_complex</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.get_complex.html">brainpy.math.get_complex</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.set_dt.html">brainpy.math.set_dt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.get_dt.html">brainpy.math.get_dt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.set_mode.html">brainpy.math.set_mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.get_mode.html">brainpy.math.get_mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.set_environment.html">brainpy.math.set_environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.enable_x64.html">brainpy.math.enable_x64</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.disable_x64.html">brainpy.math.disable_x64</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.set_platform.html">brainpy.math.set_platform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.get_platform.html">brainpy.math.get_platform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.set_host_device_count.html">brainpy.math.set_host_device_count</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.clear_buffer_memory.html">brainpy.math.clear_buffer_memory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.enable_gpu_memory_preallocation.html">brainpy.math.enable_gpu_memory_preallocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.disable_gpu_memory_preallocation.html">brainpy.math.disable_gpu_memory_preallocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.ditype.html">brainpy.math.ditype</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.dftype.html">brainpy.math.dftype</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.environment.html">brainpy.math.environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.batching_environment.html">brainpy.math.batching_environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.training_environment.html">brainpy.math.training_environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.Mode.html">brainpy.math.Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.NonBatchingMode.html">brainpy.math.NonBatchingMode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.BatchingMode.html">brainpy.math.BatchingMode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.TrainingMode.html">brainpy.math.TrainingMode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.nonbatching_mode.html">brainpy.math.nonbatching_mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.batching_mode.html">brainpy.math.batching_mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.training_mode.html">brainpy.math.training_mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.as_device_array.html">brainpy.math.as_device_array</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.as_jax.html">brainpy.math.as_jax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.as_ndarray.html">brainpy.math.as_ndarray</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.as_numpy.html">brainpy.math.as_numpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.as_variable.html">brainpy.math.as_variable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.fill_diagonal.html">brainpy.math.fill_diagonal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.empty.html">brainpy.math.empty</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.empty_like.html">brainpy.math.empty_like</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.ones.html">brainpy.math.ones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.ones_like.html">brainpy.math.ones_like</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.zeros.html">brainpy.math.zeros</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.zeros_like.html">brainpy.math.zeros_like</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.array.html">brainpy.math.array</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.asarray.html">brainpy.math.asarray</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.arange.html">brainpy.math.arange</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.linspace.html">brainpy.math.linspace</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.logspace.html">brainpy.math.logspace</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.full.html">brainpy.math.full</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.full_like.html">brainpy.math.full_like</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.eye.html">brainpy.math.eye</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.identity.html">brainpy.math.identity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.diag.html">brainpy.math.diag</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.tri.html">brainpy.math.tri</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.tril.html">brainpy.math.tril</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.triu.html">brainpy.math.triu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.real.html">brainpy.math.real</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.imag.html">brainpy.math.imag</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.conj.html">brainpy.math.conj</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.conjugate.html">brainpy.math.conjugate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.ndim.html">brainpy.math.ndim</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.isreal.html">brainpy.math.isreal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.isscalar.html">brainpy.math.isscalar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.add.html">brainpy.math.add</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.reciprocal.html">brainpy.math.reciprocal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.negative.html">brainpy.math.negative</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.positive.html">brainpy.math.positive</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.multiply.html">brainpy.math.multiply</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.divide.html">brainpy.math.divide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.power.html">brainpy.math.power</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.subtract.html">brainpy.math.subtract</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.true_divide.html">brainpy.math.true_divide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.floor_divide.html">brainpy.math.floor_divide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.float_power.html">brainpy.math.float_power</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.fmod.html">brainpy.math.fmod</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.mod.html">brainpy.math.mod</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.modf.html">brainpy.math.modf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.divmod.html">brainpy.math.divmod</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.remainder.html">brainpy.math.remainder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.abs.html">brainpy.math.abs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.exp.html">brainpy.math.exp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.exp2.html">brainpy.math.exp2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.expm1.html">brainpy.math.expm1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.log.html">brainpy.math.log</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.log10.html">brainpy.math.log10</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.log1p.html">brainpy.math.log1p</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.log2.html">brainpy.math.log2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.logaddexp.html">brainpy.math.logaddexp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.logaddexp2.html">brainpy.math.logaddexp2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.lcm.html">brainpy.math.lcm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.gcd.html">brainpy.math.gcd</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.arccos.html">brainpy.math.arccos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.arccosh.html">brainpy.math.arccosh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.arcsin.html">brainpy.math.arcsin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.arcsinh.html">brainpy.math.arcsinh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.arctan.html">brainpy.math.arctan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.arctan2.html">brainpy.math.arctan2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.arctanh.html">brainpy.math.arctanh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.cos.html">brainpy.math.cos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.cosh.html">brainpy.math.cosh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.sin.html">brainpy.math.sin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.sinc.html">brainpy.math.sinc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.sinh.html">brainpy.math.sinh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.tan.html">brainpy.math.tan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.tanh.html">brainpy.math.tanh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.deg2rad.html">brainpy.math.deg2rad</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.hypot.html">brainpy.math.hypot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.rad2deg.html">brainpy.math.rad2deg</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.degrees.html">brainpy.math.degrees</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.radians.html">brainpy.math.radians</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.round.html">brainpy.math.round</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.around.html">brainpy.math.around</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.round_.html">brainpy.math.round_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.rint.html">brainpy.math.rint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.floor.html">brainpy.math.floor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.ceil.html">brainpy.math.ceil</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.trunc.html">brainpy.math.trunc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.fix.html">brainpy.math.fix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.prod.html">brainpy.math.prod</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.sum.html">brainpy.math.sum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.diff.html">brainpy.math.diff</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.median.html">brainpy.math.median</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.nancumprod.html">brainpy.math.nancumprod</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.nancumsum.html">brainpy.math.nancumsum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.nanprod.html">brainpy.math.nanprod</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.nansum.html">brainpy.math.nansum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.cumprod.html">brainpy.math.cumprod</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.cumsum.html">brainpy.math.cumsum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.ediff1d.html">brainpy.math.ediff1d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.cross.html">brainpy.math.cross</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.trapz.html">brainpy.math.trapz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.isfinite.html">brainpy.math.isfinite</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.isinf.html">brainpy.math.isinf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.isnan.html">brainpy.math.isnan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.signbit.html">brainpy.math.signbit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.copysign.html">brainpy.math.copysign</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.nextafter.html">brainpy.math.nextafter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.ldexp.html">brainpy.math.ldexp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.frexp.html">brainpy.math.frexp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.convolve.html">brainpy.math.convolve</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.sqrt.html">brainpy.math.sqrt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.cbrt.html">brainpy.math.cbrt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.square.html">brainpy.math.square</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.absolute.html">brainpy.math.absolute</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.fabs.html">brainpy.math.fabs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.sign.html">brainpy.math.sign</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.heaviside.html">brainpy.math.heaviside</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.maximum.html">brainpy.math.maximum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.minimum.html">brainpy.math.minimum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.fmax.html">brainpy.math.fmax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.fmin.html">brainpy.math.fmin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.interp.html">brainpy.math.interp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.clip.html">brainpy.math.clip</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.angle.html">brainpy.math.angle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.bitwise_and.html">brainpy.math.bitwise_and</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.bitwise_not.html">brainpy.math.bitwise_not</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.bitwise_or.html">brainpy.math.bitwise_or</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.bitwise_xor.html">brainpy.math.bitwise_xor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.invert.html">brainpy.math.invert</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.left_shift.html">brainpy.math.left_shift</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.right_shift.html">brainpy.math.right_shift</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.equal.html">brainpy.math.equal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.not_equal.html">brainpy.math.not_equal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.greater.html">brainpy.math.greater</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.greater_equal.html">brainpy.math.greater_equal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.less.html">brainpy.math.less</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.less_equal.html">brainpy.math.less_equal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.array_equal.html">brainpy.math.array_equal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.isclose.html">brainpy.math.isclose</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.allclose.html">brainpy.math.allclose</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.logical_and.html">brainpy.math.logical_and</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.logical_not.html">brainpy.math.logical_not</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.logical_or.html">brainpy.math.logical_or</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.logical_xor.html">brainpy.math.logical_xor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.all.html">brainpy.math.all</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.any.html">brainpy.math.any</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.alltrue.html">brainpy.math.alltrue</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.sometrue.html">brainpy.math.sometrue</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.shape.html">brainpy.math.shape</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.size.html">brainpy.math.size</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.reshape.html">brainpy.math.reshape</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.ravel.html">brainpy.math.ravel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.moveaxis.html">brainpy.math.moveaxis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.transpose.html">brainpy.math.transpose</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.swapaxes.html">brainpy.math.swapaxes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.concatenate.html">brainpy.math.concatenate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.stack.html">brainpy.math.stack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.vstack.html">brainpy.math.vstack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.hstack.html">brainpy.math.hstack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.dstack.html">brainpy.math.dstack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.column_stack.html">brainpy.math.column_stack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.split.html">brainpy.math.split</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.dsplit.html">brainpy.math.dsplit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.hsplit.html">brainpy.math.hsplit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.vsplit.html">brainpy.math.vsplit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.tile.html">brainpy.math.tile</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.repeat.html">brainpy.math.repeat</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.unique.html">brainpy.math.unique</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.append.html">brainpy.math.append</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.flip.html">brainpy.math.flip</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.fliplr.html">brainpy.math.fliplr</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.flipud.html">brainpy.math.flipud</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.roll.html">brainpy.math.roll</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.atleast_1d.html">brainpy.math.atleast_1d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.atleast_2d.html">brainpy.math.atleast_2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.atleast_3d.html">brainpy.math.atleast_3d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.expand_dims.html">brainpy.math.expand_dims</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.squeeze.html">brainpy.math.squeeze</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.sort.html">brainpy.math.sort</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.argsort.html">brainpy.math.argsort</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.argmax.html">brainpy.math.argmax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.argmin.html">brainpy.math.argmin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.argwhere.html">brainpy.math.argwhere</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.nonzero.html">brainpy.math.nonzero</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.flatnonzero.html">brainpy.math.flatnonzero</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.where.html">brainpy.math.where</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.searchsorted.html">brainpy.math.searchsorted</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.extract.html">brainpy.math.extract</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.count_nonzero.html">brainpy.math.count_nonzero</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.max.html">brainpy.math.max</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.min.html">brainpy.math.min</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.amax.html">brainpy.math.amax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.amin.html">brainpy.math.amin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.array_split.html">brainpy.math.array_split</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.meshgrid.html">brainpy.math.meshgrid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.vander.html">brainpy.math.vander</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.tril_indices.html">brainpy.math.tril_indices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.tril_indices_from.html">brainpy.math.tril_indices_from</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.triu_indices.html">brainpy.math.triu_indices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.triu_indices_from.html">brainpy.math.triu_indices_from</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.take.html">brainpy.math.take</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.select.html">brainpy.math.select</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.nanmin.html">brainpy.math.nanmin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.nanmax.html">brainpy.math.nanmax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.ptp.html">brainpy.math.ptp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.percentile.html">brainpy.math.percentile</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.nanpercentile.html">brainpy.math.nanpercentile</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.quantile.html">brainpy.math.quantile</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.nanquantile.html">brainpy.math.nanquantile</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.average.html">brainpy.math.average</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.mean.html">brainpy.math.mean</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.std.html">brainpy.math.std</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.var.html">brainpy.math.var</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.nanmedian.html">brainpy.math.nanmedian</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.nanmean.html">brainpy.math.nanmean</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.nanstd.html">brainpy.math.nanstd</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.nanvar.html">brainpy.math.nanvar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.corrcoef.html">brainpy.math.corrcoef</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.correlate.html">brainpy.math.correlate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.cov.html">brainpy.math.cov</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.histogram.html">brainpy.math.histogram</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.bincount.html">brainpy.math.bincount</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.digitize.html">brainpy.math.digitize</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.bartlett.html">brainpy.math.bartlett</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.blackman.html">brainpy.math.blackman</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.hamming.html">brainpy.math.hamming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.hanning.html">brainpy.math.hanning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.kaiser.html">brainpy.math.kaiser</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.dot.html">brainpy.math.dot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.vdot.html">brainpy.math.vdot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.inner.html">brainpy.math.inner</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.outer.html">brainpy.math.outer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.kron.html">brainpy.math.kron</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.matmul.html">brainpy.math.matmul</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.trace.html">brainpy.math.trace</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.product.html">brainpy.math.product</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.row_stack.html">brainpy.math.row_stack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.apply_over_axes.html">brainpy.math.apply_over_axes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.apply_along_axis.html">brainpy.math.apply_along_axis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.array_equiv.html">brainpy.math.array_equiv</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.array_repr.html">brainpy.math.array_repr</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.array_str.html">brainpy.math.array_str</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.block.html">brainpy.math.block</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.broadcast_arrays.html">brainpy.math.broadcast_arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.broadcast_shapes.html">brainpy.math.broadcast_shapes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.broadcast_to.html">brainpy.math.broadcast_to</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.compress.html">brainpy.math.compress</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.cumproduct.html">brainpy.math.cumproduct</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.diag_indices.html">brainpy.math.diag_indices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.diag_indices_from.html">brainpy.math.diag_indices_from</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.diagflat.html">brainpy.math.diagflat</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.diagonal.html">brainpy.math.diagonal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.einsum.html">brainpy.math.einsum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.einsum_path.html">brainpy.math.einsum_path</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.geomspace.html">brainpy.math.geomspace</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.gradient.html">brainpy.math.gradient</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.histogram2d.html">brainpy.math.histogram2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.histogram_bin_edges.html">brainpy.math.histogram_bin_edges</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.histogramdd.html">brainpy.math.histogramdd</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.i0.html">brainpy.math.i0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.in1d.html">brainpy.math.in1d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.indices.html">brainpy.math.indices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.insert.html">brainpy.math.insert</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.intersect1d.html">brainpy.math.intersect1d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.iscomplex.html">brainpy.math.iscomplex</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.isin.html">brainpy.math.isin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.ix_.html">brainpy.math.ix_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.lexsort.html">brainpy.math.lexsort</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.load.html">brainpy.math.load</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.save.html">brainpy.math.save</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.savez.html">brainpy.math.savez</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.mask_indices.html">brainpy.math.mask_indices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.msort.html">brainpy.math.msort</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.nan_to_num.html">brainpy.math.nan_to_num</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.nanargmax.html">brainpy.math.nanargmax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.setdiff1d.html">brainpy.math.setdiff1d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.nanargmin.html">brainpy.math.nanargmin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.pad.html">brainpy.math.pad</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.poly.html">brainpy.math.poly</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.polyadd.html">brainpy.math.polyadd</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.polyder.html">brainpy.math.polyder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.polyfit.html">brainpy.math.polyfit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.polyint.html">brainpy.math.polyint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.polymul.html">brainpy.math.polymul</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.polysub.html">brainpy.math.polysub</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.polyval.html">brainpy.math.polyval</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.resize.html">brainpy.math.resize</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.rollaxis.html">brainpy.math.rollaxis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.roots.html">brainpy.math.roots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.rot90.html">brainpy.math.rot90</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.setxor1d.html">brainpy.math.setxor1d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.tensordot.html">brainpy.math.tensordot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.trim_zeros.html">brainpy.math.trim_zeros</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.union1d.html">brainpy.math.union1d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.unravel_index.html">brainpy.math.unravel_index</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.unwrap.html">brainpy.math.unwrap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.take_along_axis.html">brainpy.math.take_along_axis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.can_cast.html">brainpy.math.can_cast</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.choose.html">brainpy.math.choose</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.copy.html">brainpy.math.copy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.frombuffer.html">brainpy.math.frombuffer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.fromfile.html">brainpy.math.fromfile</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.fromfunction.html">brainpy.math.fromfunction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.fromiter.html">brainpy.math.fromiter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.fromstring.html">brainpy.math.fromstring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.get_printoptions.html">brainpy.math.get_printoptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.iscomplexobj.html">brainpy.math.iscomplexobj</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.isneginf.html">brainpy.math.isneginf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.isposinf.html">brainpy.math.isposinf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.isrealobj.html">brainpy.math.isrealobj</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.issubdtype.html">brainpy.math.issubdtype</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.issubsctype.html">brainpy.math.issubsctype</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.iterable.html">brainpy.math.iterable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.packbits.html">brainpy.math.packbits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.piecewise.html">brainpy.math.piecewise</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.printoptions.html">brainpy.math.printoptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.set_printoptions.html">brainpy.math.set_printoptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.promote_types.html">brainpy.math.promote_types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.ravel_multi_index.html">brainpy.math.ravel_multi_index</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.result_type.html">brainpy.math.result_type</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.sort_complex.html">brainpy.math.sort_complex</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.unpackbits.html">brainpy.math.unpackbits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.delete.html">brainpy.math.delete</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.add_newdoc.html">brainpy.math.add_newdoc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.array2string.html">brainpy.math.array2string</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.asanyarray.html">brainpy.math.asanyarray</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.ascontiguousarray.html">brainpy.math.ascontiguousarray</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.asfarray.html">brainpy.math.asfarray</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.asscalar.html">brainpy.math.asscalar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.common_type.html">brainpy.math.common_type</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.disp.html">brainpy.math.disp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.genfromtxt.html">brainpy.math.genfromtxt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.loadtxt.html">brainpy.math.loadtxt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.info.html">brainpy.math.info</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.issubclass_.html">brainpy.math.issubclass_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.place.html">brainpy.math.place</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.polydiv.html">brainpy.math.polydiv</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.put.html">brainpy.math.put</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.putmask.html">brainpy.math.putmask</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.safe_eval.html">brainpy.math.safe_eval</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.savetxt.html">brainpy.math.savetxt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.savez_compressed.html">brainpy.math.savez_compressed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.show_config.html">brainpy.math.show_config</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.typename.html">brainpy.math.typename</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.copyto.html">brainpy.math.copyto</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.matrix.html">brainpy.math.matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.asmatrix.html">brainpy.math.asmatrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.mat.html">brainpy.math.mat</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.dtype.html">brainpy.math.dtype</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.finfo.html">brainpy.math.finfo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.iinfo.html">brainpy.math.iinfo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.e.html">brainpy.math.e</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.pi.html">brainpy.math.pi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.inf.html">brainpy.math.inf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.add_docstring.html">brainpy.math.add_docstring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.add_newdoc_ufunc.html">brainpy.math.add_newdoc_ufunc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.flatten.html">brainpy.math.flatten</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.cat.html">brainpy.math.cat</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.unsqueeze.html">brainpy.math.unsqueeze</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.abs.html">brainpy.math.abs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.absolute.html">brainpy.math.absolute</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.acos.html">brainpy.math.acos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.arccos.html">brainpy.math.arccos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.acosh.html">brainpy.math.acosh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.arccosh.html">brainpy.math.arccosh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.add.html">brainpy.math.add</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.addcdiv.html">brainpy.math.addcdiv</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.addcmul.html">brainpy.math.addcmul</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.angle.html">brainpy.math.angle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.asin.html">brainpy.math.asin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.arcsin.html">brainpy.math.arcsin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.asinh.html">brainpy.math.asinh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.atan.html">brainpy.math.atan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.arctan.html">brainpy.math.arctan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.atan2.html">brainpy.math.atan2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.atanh.html">brainpy.math.atanh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.Tensor.html">brainpy.math.Tensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.concat.html">brainpy.math.concat</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.reduce_sum.html">brainpy.math.reduce_sum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.reduce_max.html">brainpy.math.reduce_max</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.reduce_min.html">brainpy.math.reduce_min</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.reduce_mean.html">brainpy.math.reduce_mean</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.reduce_all.html">brainpy.math.reduce_all</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.reduce_any.html">brainpy.math.reduce_any</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.reduce_logsumexp.html">brainpy.math.reduce_logsumexp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.reduce_prod.html">brainpy.math.reduce_prod</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.reduce_std.html">brainpy.math.reduce_std</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.reduce_variance.html">brainpy.math.reduce_variance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.reduce_euclidean_norm.html">brainpy.math.reduce_euclidean_norm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.unsorted_segment_sqrt_n.html">brainpy.math.unsorted_segment_sqrt_n</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.segment_mean.html">brainpy.math.segment_mean</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.unsorted_segment_sum.html">brainpy.math.unsorted_segment_sum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.unsorted_segment_prod.html">brainpy.math.unsorted_segment_prod</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.unsorted_segment_max.html">brainpy.math.unsorted_segment_max</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.unsorted_segment_min.html">brainpy.math.unsorted_segment_min</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.unsorted_segment_mean.html">brainpy.math.unsorted_segment_mean</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.segment_sum.html">brainpy.math.segment_sum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.segment_prod.html">brainpy.math.segment_prod</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.segment_max.html">brainpy.math.segment_max</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.segment_min.html">brainpy.math.segment_min</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.clip_by_value.html">brainpy.math.clip_by_value</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.cast.html">brainpy.math.cast</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.surrogate.sigmoid.html">brainpy.math.surrogate.sigmoid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.surrogate.piecewise_quadratic.html">brainpy.math.surrogate.piecewise_quadratic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.surrogate.piecewise_exp.html">brainpy.math.surrogate.piecewise_exp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.surrogate.soft_sign.html">brainpy.math.surrogate.soft_sign</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.surrogate.arctan.html">brainpy.math.surrogate.arctan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.surrogate.nonzero_sign_log.html">brainpy.math.surrogate.nonzero_sign_log</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.surrogate.erf.html">brainpy.math.surrogate.erf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.surrogate.piecewise_leaky_relu.html">brainpy.math.surrogate.piecewise_leaky_relu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.surrogate.squarewave_fourier_series.html">brainpy.math.surrogate.squarewave_fourier_series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.surrogate.s2nn.html">brainpy.math.surrogate.s2nn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.surrogate.q_pseudo_spike.html">brainpy.math.surrogate.q_pseudo_spike</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.surrogate.leaky_relu.html">brainpy.math.surrogate.leaky_relu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.surrogate.log_tailed_relu.html">brainpy.math.surrogate.log_tailed_relu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.surrogate.relu_grad.html">brainpy.math.surrogate.relu_grad</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.surrogate.gaussian_grad.html">brainpy.math.surrogate.gaussian_grad</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.surrogate.inv_square_grad.html">brainpy.math.surrogate.inv_square_grad</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.surrogate.multi_gaussian_grad.html">brainpy.math.surrogate.multi_gaussian_grad</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.surrogate.slayer_grad.html">brainpy.math.surrogate.slayer_grad</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.surrogate.inv_square_grad2.html">brainpy.math.surrogate.inv_square_grad2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.surrogate.relu_grad2.html">brainpy.math.surrogate.relu_grad2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.seed.html">brainpy.math.random.seed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.split_key.html">brainpy.math.random.split_key</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.default_rng.html">brainpy.math.random.default_rng</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.rand.html">brainpy.math.random.rand</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.randint.html">brainpy.math.random.randint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.random_integers.html">brainpy.math.random.random_integers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.randn.html">brainpy.math.random.randn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.random.html">brainpy.math.random.random</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.random_sample.html">brainpy.math.random.random_sample</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.ranf.html">brainpy.math.random.ranf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.sample.html">brainpy.math.random.sample</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.choice.html">brainpy.math.random.choice</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.permutation.html">brainpy.math.random.permutation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.shuffle.html">brainpy.math.random.shuffle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.beta.html">brainpy.math.random.beta</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.exponential.html">brainpy.math.random.exponential</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.gamma.html">brainpy.math.random.gamma</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.gumbel.html">brainpy.math.random.gumbel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.laplace.html">brainpy.math.random.laplace</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.logistic.html">brainpy.math.random.logistic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.normal.html">brainpy.math.random.normal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.pareto.html">brainpy.math.random.pareto</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.poisson.html">brainpy.math.random.poisson</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.standard_cauchy.html">brainpy.math.random.standard_cauchy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.standard_exponential.html">brainpy.math.random.standard_exponential</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.standard_gamma.html">brainpy.math.random.standard_gamma</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.standard_normal.html">brainpy.math.random.standard_normal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.standard_t.html">brainpy.math.random.standard_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.uniform.html">brainpy.math.random.uniform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.truncated_normal.html">brainpy.math.random.truncated_normal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.bernoulli.html">brainpy.math.random.bernoulli</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.lognormal.html">brainpy.math.random.lognormal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.binomial.html">brainpy.math.random.binomial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.chisquare.html">brainpy.math.random.chisquare</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.dirichlet.html">brainpy.math.random.dirichlet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.geometric.html">brainpy.math.random.geometric</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.f.html">brainpy.math.random.f</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.hypergeometric.html">brainpy.math.random.hypergeometric</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.logseries.html">brainpy.math.random.logseries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.multinomial.html">brainpy.math.random.multinomial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.multivariate_normal.html">brainpy.math.random.multivariate_normal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.negative_binomial.html">brainpy.math.random.negative_binomial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.noncentral_chisquare.html">brainpy.math.random.noncentral_chisquare</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.noncentral_f.html">brainpy.math.random.noncentral_f</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.power.html">brainpy.math.random.power</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.rayleigh.html">brainpy.math.random.rayleigh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.triangular.html">brainpy.math.random.triangular</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.vonmises.html">brainpy.math.random.vonmises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.wald.html">brainpy.math.random.wald</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.weibull.html">brainpy.math.random.weibull</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.weibull_min.html">brainpy.math.random.weibull_min</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.zipf.html">brainpy.math.random.zipf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.maxwell.html">brainpy.math.random.maxwell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.t.html">brainpy.math.random.t</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.orthogonal.html">brainpy.math.random.orthogonal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.loggamma.html">brainpy.math.random.loggamma</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.categorical.html">brainpy.math.random.categorical</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.rand_like.html">brainpy.math.random.rand_like</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.randint_like.html">brainpy.math.random.randint_like</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.randn_like.html">brainpy.math.random.randn_like</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.RandomState.html">brainpy.math.random.RandomState</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.Generator.html">brainpy.math.random.Generator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.random.DEFAULT.html">brainpy.math.random.DEFAULT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.linalg.cholesky.html">brainpy.math.linalg.cholesky</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.linalg.cond.html">brainpy.math.linalg.cond</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.linalg.det.html">brainpy.math.linalg.det</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.linalg.eig.html">brainpy.math.linalg.eig</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.linalg.eigh.html">brainpy.math.linalg.eigh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.linalg.eigvals.html">brainpy.math.linalg.eigvals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.linalg.eigvalsh.html">brainpy.math.linalg.eigvalsh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.linalg.inv.html">brainpy.math.linalg.inv</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.linalg.svd.html">brainpy.math.linalg.svd</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.linalg.lstsq.html">brainpy.math.linalg.lstsq</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.linalg.matrix_power.html">brainpy.math.linalg.matrix_power</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.linalg.matrix_rank.html">brainpy.math.linalg.matrix_rank</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.linalg.norm.html">brainpy.math.linalg.norm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.linalg.pinv.html">brainpy.math.linalg.pinv</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.linalg.qr.html">brainpy.math.linalg.qr</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.linalg.solve.html">brainpy.math.linalg.solve</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.linalg.slogdet.html">brainpy.math.linalg.slogdet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.linalg.tensorinv.html">brainpy.math.linalg.tensorinv</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.linalg.tensorsolve.html">brainpy.math.linalg.tensorsolve</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.linalg.multi_dot.html">brainpy.math.linalg.multi_dot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.fft.fft.html">brainpy.math.fft.fft</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.fft.fft2.html">brainpy.math.fft.fft2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.fft.fftfreq.html">brainpy.math.fft.fftfreq</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.fft.fftn.html">brainpy.math.fft.fftn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.fft.fftshift.html">brainpy.math.fft.fftshift</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.fft.hfft.html">brainpy.math.fft.hfft</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.fft.ifft.html">brainpy.math.fft.ifft</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.fft.ifft2.html">brainpy.math.fft.ifft2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.fft.ifftn.html">brainpy.math.fft.ifftn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.fft.ifftshift.html">brainpy.math.fft.ifftshift</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.fft.ihfft.html">brainpy.math.fft.ihfft</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.fft.irfft.html">brainpy.math.fft.irfft</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.fft.irfft2.html">brainpy.math.fft.irfft2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.fft.irfftn.html">brainpy.math.fft.irfftn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.fft.rfft.html">brainpy.math.fft.rfft</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.fft.rfft2.html">brainpy.math.fft.rfft2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.fft.rfftfreq.html">brainpy.math.fft.rfftfreq</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.math.fft.rfftn.html">brainpy.math.fft.rfftn</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../apis/auto/channels.html"><code class="docutils literal notranslate"><span class="pre">brainpy.channels</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.channels.Ion.html">brainpy.channels.Ion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.channels.IonChannel.html">brainpy.channels.IonChannel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.channels.Calcium.html">brainpy.channels.Calcium</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.channels.IhChannel.html">brainpy.channels.IhChannel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.channels.CalciumChannel.html">brainpy.channels.CalciumChannel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.channels.SodiumChannel.html">brainpy.channels.SodiumChannel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.channels.PotassiumChannel.html">brainpy.channels.PotassiumChannel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.channels.LeakyChannel.html">brainpy.channels.LeakyChannel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.channels.INa_Ba2002.html">brainpy.channels.INa_Ba2002</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.channels.INa_TM1991.html">brainpy.channels.INa_TM1991</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.channels.INa_HH1952.html">brainpy.channels.INa_HH1952</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.channels.IKDR_Ba2002.html">brainpy.channels.IKDR_Ba2002</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.channels.IK_TM1991.html">brainpy.channels.IK_TM1991</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.channels.IK_HH1952.html">brainpy.channels.IK_HH1952</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.channels.IKA1_HM1992.html">brainpy.channels.IKA1_HM1992</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.channels.IKA2_HM1992.html">brainpy.channels.IKA2_HM1992</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.channels.IKK2A_HM1992.html">brainpy.channels.IKK2A_HM1992</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.channels.IKK2B_HM1992.html">brainpy.channels.IKK2B_HM1992</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.channels.IKNI_Ya1989.html">brainpy.channels.IKNI_Ya1989</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.channels.CalciumFixed.html">brainpy.channels.CalciumFixed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.channels.CalciumDyna.html">brainpy.channels.CalciumDyna</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.channels.CalciumDetailed.html">brainpy.channels.CalciumDetailed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.channels.CalciumFirstOrder.html">brainpy.channels.CalciumFirstOrder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.channels.ICaN_IS2008.html">brainpy.channels.ICaN_IS2008</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.channels.ICaT_HM1992.html">brainpy.channels.ICaT_HM1992</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.channels.ICaT_HP1992.html">brainpy.channels.ICaT_HP1992</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.channels.ICaHT_HM1992.html">brainpy.channels.ICaHT_HM1992</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.channels.ICaL_IS2008.html">brainpy.channels.ICaL_IS2008</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.channels.IAHP_De1994.html">brainpy.channels.IAHP_De1994</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.channels.Ih_HM1992.html">brainpy.channels.Ih_HM1992</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.channels.Ih_De1996.html">brainpy.channels.Ih_De1996</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.channels.IL.html">brainpy.channels.IL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.channels.IKL.html">brainpy.channels.IKL</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../apis/auto/layers.html"><code class="docutils literal notranslate"><span class="pre">brainpy.layers</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.Layer.html">brainpy.layers.Layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.Conv1D.html">brainpy.layers.Conv1d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.Conv2D.html">brainpy.layers.Conv2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.Conv3D.html">brainpy.layers.Conv3d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.ConvTranspose1d.html">brainpy.layers.ConvTranspose1d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.ConvTranspose2d.html">brainpy.layers.ConvTranspose2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.ConvTranspose3d.html">brainpy.layers.ConvTranspose3d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.Dropout.html">brainpy.layers.Dropout</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.Activation.html">brainpy.layers.Activation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.Flatten.html">brainpy.layers.Flatten</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.FunAsLayer.html">brainpy.layers.FunAsLayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.Dense.html">brainpy.layers.Dense</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.Linear.html">brainpy.layers.Linear</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.Identity.html">brainpy.layers.Identity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.BatchNorm1D.html">brainpy.layers.BatchNorm1d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.BatchNorm2D.html">brainpy.layers.BatchNorm2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.BatchNorm3D.html">brainpy.layers.BatchNorm3d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.LayerNorm.html">brainpy.layers.LayerNorm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.GroupNorm.html">brainpy.layers.GroupNorm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.InstanceNorm.html">brainpy.layers.InstanceNorm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.NVAR.html">brainpy.layers.NVAR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.MaxPool.html">brainpy.layers.MaxPool</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.MinPool.html">brainpy.layers.MinPool</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.AvgPool.html">brainpy.layers.AvgPool</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.AvgPool1d.html">brainpy.layers.AvgPool1d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.AvgPool2d.html">brainpy.layers.AvgPool2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.AvgPool3d.html">brainpy.layers.AvgPool3d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.MaxPool1d.html">brainpy.layers.MaxPool1d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.MaxPool2d.html">brainpy.layers.MaxPool2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.MaxPool3d.html">brainpy.layers.MaxPool3d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.AdaptiveAvgPool1d.html">brainpy.layers.AdaptiveAvgPool1d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.AdaptiveAvgPool2d.html">brainpy.layers.AdaptiveAvgPool2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.AdaptiveAvgPool3d.html">brainpy.layers.AdaptiveAvgPool3d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.AdaptiveMaxPool1d.html">brainpy.layers.AdaptiveMaxPool1d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.AdaptiveMaxPool2d.html">brainpy.layers.AdaptiveMaxPool2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.AdaptiveMaxPool3d.html">brainpy.layers.AdaptiveMaxPool3d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.Reservoir.html">brainpy.layers.Reservoir</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.RNNCell.html">brainpy.layers.RNNCell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.GRUCell.html">brainpy.layers.GRUCell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.LSTMCell.html">brainpy.layers.LSTMCell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.Conv1dLSTMCell.html">brainpy.layers.Conv1dLSTMCell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.Conv2dLSTMCell.html">brainpy.layers.Conv2dLSTMCell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.Conv3dLSTMCell.html">brainpy.layers.Conv3dLSTMCell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.VanillaRNN.html">brainpy.layers.VanillaRNN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.GRU.html">brainpy.layers.GRU</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.layers.LSTM.html">brainpy.layers.LSTM</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../apis/auto/neurons.html"><code class="docutils literal notranslate"><span class="pre">brainpy.neurons</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.neurons.HH.html">brainpy.neurons.HH</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.neurons.MorrisLecar.html">brainpy.neurons.MorrisLecar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.neurons.PinskyRinzelModel.html">brainpy.neurons.PinskyRinzelModel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.neurons.WangBuzsakiModel.html">brainpy.neurons.WangBuzsakiModel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.neurons.FractionalNeuron.html">brainpy.neurons.FractionalNeuron</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.neurons.FractionalFHR.html">brainpy.neurons.FractionalFHR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.neurons.FractionalIzhikevich.html">brainpy.neurons.FractionalIzhikevich</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.neurons.LeakyIntegrator.html">brainpy.neurons.LeakyIntegrator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.neurons.LIF.html">brainpy.neurons.LIF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.neurons.ExpIF.html">brainpy.neurons.ExpIF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.neurons.AdExIF.html">brainpy.neurons.AdExIF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.neurons.QuaIF.html">brainpy.neurons.QuaIF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.neurons.AdQuaIF.html">brainpy.neurons.AdQuaIF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.neurons.GIF.html">brainpy.neurons.GIF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.neurons.ALIFBellec2020.html">brainpy.neurons.ALIFBellec2020</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.neurons.Izhikevich.html">brainpy.neurons.Izhikevich</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.neurons.HindmarshRose.html">brainpy.neurons.HindmarshRose</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.neurons.FHN.html">brainpy.neurons.FHN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.neurons.OUProcess.html">brainpy.neurons.OUProcess</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.neurons.InputGroup.html">brainpy.neurons.InputGroup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.neurons.OutputGroup.html">brainpy.neurons.OutputGroup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.neurons.SpikeTimeGroup.html">brainpy.neurons.SpikeTimeGroup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.neurons.PoissonGroup.html">brainpy.neurons.PoissonGroup</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../apis/auto/rates.html"><code class="docutils literal notranslate"><span class="pre">brainpy.rates</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.rates.RateModel.html">brainpy.rates.RateModel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.rates.FHN.html">brainpy.rates.FHN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.rates.FeedbackFHN.html">brainpy.rates.FeedbackFHN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.rates.QIF.html">brainpy.rates.QIF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.rates.StuartLandauOscillator.html">brainpy.rates.StuartLandauOscillator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.rates.WilsonCowanModel.html">brainpy.rates.WilsonCowanModel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.rates.ThresholdLinearModel.html">brainpy.rates.ThresholdLinearModel</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../apis/auto/synapses.html"><code class="docutils literal notranslate"><span class="pre">brainpy.synapses</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.synapses.Delta.html">brainpy.synapses.Delta</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.synapses.Exponential.html">brainpy.synapses.Exponential</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.synapses.DualExponential.html">brainpy.synapses.DualExponential</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.synapses.Alpha.html">brainpy.synapses.Alpha</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.synapses.NMDA.html">brainpy.synapses.NMDA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.synapses.PoissonInput.html">brainpy.synapses.PoissonInput</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.synapses.AMPA.html">brainpy.synapses.AMPA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.synapses.GABAa.html">brainpy.synapses.GABAa</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.synapses.BioNMDA.html">brainpy.synapses.BioNMDA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.synapses.DelayCoupling.html">brainpy.synapses.DelayCoupling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.synapses.DiffusiveCoupling.html">brainpy.synapses.DiffusiveCoupling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.synapses.AdditiveCoupling.html">brainpy.synapses.AdditiveCoupling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.synapses.GapJunction.html">brainpy.synapses.GapJunction</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../apis/auto/synouts.html"><code class="docutils literal notranslate"><span class="pre">brainpy.synouts</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.synouts.COBA.html">brainpy.synouts.COBA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.synouts.CUBA.html">brainpy.synouts.CUBA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.synouts.MgBlock.html">brainpy.synouts.MgBlock</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../apis/auto/synplast.html"><code class="docutils literal notranslate"><span class="pre">brainpy.synplast</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.synplast.STD.html">brainpy.synplast.STD</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.synplast.STP.html">brainpy.synplast.STP</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../apis/auto/integrators.html"><code class="docutils literal notranslate"><span class="pre">brainpy.integrators</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.ode.ODEIntegrator.html">brainpy.integrators.ode.ODEIntegrator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.ode.set_default_odeint.html">brainpy.integrators.ode.set_default_odeint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.ode.get_default_odeint.html">brainpy.integrators.ode.get_default_odeint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.ode.register_ode_integrator.html">brainpy.integrators.ode.register_ode_integrator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.ode.get_supported_methods.html">brainpy.integrators.ode.get_supported_methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.ode.ExplicitRKIntegrator.html">brainpy.integrators.ode.ExplicitRKIntegrator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.ode.Euler.html">brainpy.integrators.ode.Euler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.ode.MidPoint.html">brainpy.integrators.ode.MidPoint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.ode.Heun2.html">brainpy.integrators.ode.Heun2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.ode.Ralston2.html">brainpy.integrators.ode.Ralston2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.ode.RK2.html">brainpy.integrators.ode.RK2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.ode.RK3.html">brainpy.integrators.ode.RK3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.ode.Heun3.html">brainpy.integrators.ode.Heun3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.ode.Ralston3.html">brainpy.integrators.ode.Ralston3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.ode.SSPRK3.html">brainpy.integrators.ode.SSPRK3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.ode.RK4.html">brainpy.integrators.ode.RK4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.ode.Ralston4.html">brainpy.integrators.ode.Ralston4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.ode.RK4Rule38.html">brainpy.integrators.ode.RK4Rule38</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.ode.AdaptiveRKIntegrator.html">brainpy.integrators.ode.AdaptiveRKIntegrator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.ode.RKF12.html">brainpy.integrators.ode.RKF12</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.ode.RKF45.html">brainpy.integrators.ode.RKF45</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.ode.DormandPrince.html">brainpy.integrators.ode.DormandPrince</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.ode.CashKarp.html">brainpy.integrators.ode.CashKarp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.ode.BogackiShampine.html">brainpy.integrators.ode.BogackiShampine</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.ode.HeunEuler.html">brainpy.integrators.ode.HeunEuler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.ode.ExponentialEuler.html">brainpy.integrators.ode.ExponentialEuler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.sde.SDEIntegrator.html">brainpy.integrators.sde.SDEIntegrator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.sde.set_default_sdeint.html">brainpy.integrators.sde.set_default_sdeint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.sde.get_default_sdeint.html">brainpy.integrators.sde.get_default_sdeint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.sde.register_sde_integrator.html">brainpy.integrators.sde.register_sde_integrator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.sde.get_supported_methods.html">brainpy.integrators.sde.get_supported_methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.sde.Euler.html">brainpy.integrators.sde.Euler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.sde.Heun.html">brainpy.integrators.sde.Heun</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.sde.Milstein.html">brainpy.integrators.sde.Milstein</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.sde.MilsteinGradFree.html">brainpy.integrators.sde.MilsteinGradFree</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.sde.ExponentialEuler.html">brainpy.integrators.sde.ExponentialEuler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.sde.SRK1W1.html">brainpy.integrators.sde.SRK1W1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.sde.SRK2W1.html">brainpy.integrators.sde.SRK2W1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.sde.KlPl.html">brainpy.integrators.sde.KlPl</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.fde.FDEIntegrator.html">brainpy.integrators.fde.FDEIntegrator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.fde.set_default_fdeint.html">brainpy.integrators.fde.set_default_fdeint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.fde.get_default_fdeint.html">brainpy.integrators.fde.get_default_fdeint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.fde.register_fde_integrator.html">brainpy.integrators.fde.register_fde_integrator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.fde.get_supported_methods.html">brainpy.integrators.fde.get_supported_methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.fde.CaputoEuler.html">brainpy.integrators.fde.CaputoEuler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.fde.CaputoL1Schema.html">brainpy.integrators.fde.CaputoL1Schema</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.integrators.fde.GLShortMemory.html">brainpy.integrators.fde.GLShortMemory</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../apis/auto/analysis.html"><code class="docutils literal notranslate"><span class="pre">brainpy.analysis</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.analysis.PhasePlane1D.html">brainpy.analysis.PhasePlane1D</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.analysis.PhasePlane2D.html">brainpy.analysis.PhasePlane2D</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.analysis.Bifurcation1D.html">brainpy.analysis.Bifurcation1D</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.analysis.Bifurcation2D.html">brainpy.analysis.Bifurcation2D</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.analysis.FastSlow1D.html">brainpy.analysis.FastSlow1D</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.analysis.FastSlow2D.html">brainpy.analysis.FastSlow2D</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.analysis.SlowPointFinder.html">brainpy.analysis.SlowPointFinder</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../apis/auto/connect.html"><code class="docutils literal notranslate"><span class="pre">brainpy.connect</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-17"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.mat2coo.html">brainpy.connect.mat2coo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.mat2csc.html">brainpy.connect.mat2csc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.mat2csr.html">brainpy.connect.mat2csr</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.csr2csc.html">brainpy.connect.csr2csc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.csr2mat.html">brainpy.connect.csr2mat</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.csr2coo.html">brainpy.connect.csr2coo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.coo2csr.html">brainpy.connect.coo2csr</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.coo2csc.html">brainpy.connect.coo2csc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.coo2mat.html">brainpy.connect.coo2mat</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.Connector.html">brainpy.connect.Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.TwoEndConnector.html">brainpy.connect.TwoEndConnector</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.OneEndConnector.html">brainpy.connect.OneEndConnector</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.CONN_MAT.html">brainpy.connect.CONN_MAT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.PRE_IDS.html">brainpy.connect.PRE_IDS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.POST_IDS.html">brainpy.connect.POST_IDS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.PRE2POST.html">brainpy.connect.PRE2POST</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.POST2PRE.html">brainpy.connect.POST2PRE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.PRE2SYN.html">brainpy.connect.PRE2SYN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.POST2SYN.html">brainpy.connect.POST2SYN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.MatConn.html">brainpy.connect.MatConn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.IJConn.html">brainpy.connect.IJConn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.CSRConn.html">brainpy.connect.CSRConn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.SparseMatConn.html">brainpy.connect.SparseMatConn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.FixedProb.html">brainpy.connect.FixedProb</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.FixedPreNum.html">brainpy.connect.FixedPreNum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.FixedPostNum.html">brainpy.connect.FixedPostNum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.FixedTotalNum.html">brainpy.connect.FixedTotalNum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.GaussianProb.html">brainpy.connect.GaussianProb</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.ProbDist.html">brainpy.connect.ProbDist</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.SmallWorld.html">brainpy.connect.SmallWorld</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.ScaleFreeBA.html">brainpy.connect.ScaleFreeBA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.ScaleFreeBADual.html">brainpy.connect.ScaleFreeBADual</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.PowerLaw.html">brainpy.connect.PowerLaw</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.One2One.html">brainpy.connect.one2one</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.All2All.html">brainpy.connect.all2all</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.GridFour.html">brainpy.connect.GridFour</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.GridEight.html">brainpy.connect.GridEight</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.GridN.html">brainpy.connect.GridN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.grid_four.html">brainpy.connect.grid_four</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.connect.grid_eight.html">brainpy.connect.grid_eight</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../apis/auto/encoding.html"><code class="docutils literal notranslate"><span class="pre">brainpy.encoding</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-18"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.encoding.Encoder.html">brainpy.encoding.Encoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.encoding.LatencyEncoder.html">brainpy.encoding.LatencyEncoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.encoding.WeightedPhaseEncoder.html">brainpy.encoding.WeightedPhaseEncoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.encoding.PoissonEncoder.html">brainpy.encoding.PoissonEncoder</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../apis/auto/initialize.html"><code class="docutils literal notranslate"><span class="pre">brainpy.initialize</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-19"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.initialize.Initializer.html">brainpy.initialize.Initializer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.initialize.InterLayerInitializer.html">brainpy.initialize.InterLayerInitializer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.initialize.IntraLayerInitializer.html">brainpy.initialize.IntraLayerInitializer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.initialize.ZeroInit.html">brainpy.initialize.ZeroInit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.initialize.Constant.html">brainpy.initialize.Constant</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.initialize.OneInit.html">brainpy.initialize.OneInit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.initialize.Identity.html">brainpy.initialize.Identity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.initialize.Normal.html">brainpy.initialize.Normal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.initialize.Uniform.html">brainpy.initialize.Uniform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.initialize.VarianceScaling.html">brainpy.initialize.VarianceScaling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.initialize.KaimingUniform.html">brainpy.initialize.KaimingUniform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.initialize.KaimingNormal.html">brainpy.initialize.KaimingNormal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.initialize.XavierUniform.html">brainpy.initialize.XavierUniform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.initialize.XavierNormal.html">brainpy.initialize.XavierNormal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.initialize.LecunUniform.html">brainpy.initialize.LecunUniform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.initialize.LecunNormal.html">brainpy.initialize.LecunNormal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.initialize.Orthogonal.html">brainpy.initialize.Orthogonal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.initialize.DeltaOrthogonal.html">brainpy.initialize.DeltaOrthogonal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.initialize.GaussianDecay.html">brainpy.initialize.GaussianDecay</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.initialize.DOGDecay.html">brainpy.initialize.DOGDecay</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../apis/auto/inputs.html"><code class="docutils literal notranslate"><span class="pre">brainpy.inputs</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-20"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.inputs.section_input.html">brainpy.inputs.section_input</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.inputs.constant_input.html">brainpy.inputs.constant_input</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.inputs.spike_input.html">brainpy.inputs.spike_input</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.inputs.ramp_input.html">brainpy.inputs.ramp_input</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.inputs.wiener_process.html">brainpy.inputs.wiener_process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.inputs.ou_process.html">brainpy.inputs.ou_process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.inputs.sinusoidal_input.html">brainpy.inputs.sinusoidal_input</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.inputs.square_input.html">brainpy.inputs.square_input</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../apis/auto/losses.html"><code class="docutils literal notranslate"><span class="pre">brainpy.losses</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-21"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.losses.cross_entropy_loss.html">brainpy.losses.cross_entropy_loss</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.losses.cross_entropy_sparse.html">brainpy.losses.cross_entropy_sparse</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.losses.cross_entropy_sigmoid.html">brainpy.losses.cross_entropy_sigmoid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.losses.l1_loos.html">brainpy.losses.l1_loos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.losses.l2_loss.html">brainpy.losses.l2_loss</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.losses.huber_loss.html">brainpy.losses.huber_loss</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.losses.mean_absolute_error.html">brainpy.losses.mean_absolute_error</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.losses.mean_squared_error.html">brainpy.losses.mean_squared_error</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.losses.mean_squared_log_error.html">brainpy.losses.mean_squared_log_error</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.losses.binary_logistic_loss.html">brainpy.losses.binary_logistic_loss</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.losses.multiclass_logistic_loss.html">brainpy.losses.multiclass_logistic_loss</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.losses.sigmoid_binary_cross_entropy.html">brainpy.losses.sigmoid_binary_cross_entropy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.losses.softmax_cross_entropy.html">brainpy.losses.softmax_cross_entropy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.losses.log_cosh_loss.html">brainpy.losses.log_cosh_loss</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.losses.ctc_loss_with_forward_probs.html">brainpy.losses.ctc_loss_with_forward_probs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.losses.ctc_loss.html">brainpy.losses.ctc_loss</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.losses.l2_norm.html">brainpy.losses.l2_norm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.losses.mean_absolute.html">brainpy.losses.mean_absolute</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.losses.mean_square.html">brainpy.losses.mean_square</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.losses.log_cosh.html">brainpy.losses.log_cosh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.losses.smooth_labels.html">brainpy.losses.smooth_labels</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../apis/auto/measure.html"><code class="docutils literal notranslate"><span class="pre">brainpy.measure</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-22"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.measure.cross_correlation.html">brainpy.measure.cross_correlation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.measure.voltage_fluctuation.html">brainpy.measure.voltage_fluctuation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.measure.matrix_correlation.html">brainpy.measure.matrix_correlation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.measure.weighted_correlation.html">brainpy.measure.weighted_correlation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.measure.functional_connectivity.html">brainpy.measure.functional_connectivity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.measure.raster_plot.html">brainpy.measure.raster_plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.measure.firing_rate.html">brainpy.measure.firing_rate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.measure.unitary_LFP.html">brainpy.measure.unitary_LFP</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../apis/auto/optim.html"><code class="docutils literal notranslate"><span class="pre">brainpy.optim</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-23"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.optim.Optimizer.html">brainpy.optim.Optimizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.optim.SGD.html">brainpy.optim.SGD</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.optim.Momentum.html">brainpy.optim.Momentum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.optim.MomentumNesterov.html">brainpy.optim.MomentumNesterov</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.optim.Adagrad.html">brainpy.optim.Adagrad</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.optim.Adadelta.html">brainpy.optim.Adadelta</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.optim.RMSProp.html">brainpy.optim.RMSProp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.optim.Adam.html">brainpy.optim.Adam</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.optim.LARS.html">brainpy.optim.LARS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.optim.Adan.html">brainpy.optim.Adan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.optim.AdamW.html">brainpy.optim.AdamW</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.optim.make_schedule.html">brainpy.optim.make_schedule</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.optim.Scheduler.html">brainpy.optim.Scheduler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.optim.Constant.html">brainpy.optim.Constant</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.optim.StepLR.html">brainpy.optim.StepLR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.optim.MultiStepLR.html">brainpy.optim.MultiStepLR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.optim.CosineAnnealingLR.html">brainpy.optim.CosineAnnealingLR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.optim.CosineAnnealingWarmRestarts.html">brainpy.optim.CosineAnnealingWarmRestarts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.optim.ExponentialLR.html">brainpy.optim.ExponentialLR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.optim.ExponentialDecay.html">brainpy.optim.ExponentialDecay</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.optim.InverseTimeDecay.html">brainpy.optim.InverseTimeDecay</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.optim.PolynomialDecay.html">brainpy.optim.PolynomialDecay</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.optim.PiecewiseConstant.html">brainpy.optim.PiecewiseConstant</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../apis/auto/running.html"><code class="docutils literal notranslate"><span class="pre">brainpy.running</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-24"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.running.jax_vectorize_map.html">brainpy.running.jax_vectorize_map</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.running.jax_parallelize_map.html">brainpy.running.jax_parallelize_map</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.running.process_pool.html">brainpy.running.process_pool</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.running.process_pool_lock.html">brainpy.running.process_pool_lock</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.running.cpu_ordered_parallel.html">brainpy.running.cpu_ordered_parallel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../apis/auto/generated/brainpy.running.cpu_unordered_parallel.html">brainpy.running.cpu_unordered_parallel</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../apis/auto/changelog.html">Release notes (brainpy)</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">



<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>

</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1></h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <h1>Source code for brainpy._src.math.random</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">index</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">import</span> <span class="nn">jax</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">jax</span> <span class="kn">import</span> <span class="n">lax</span><span class="p">,</span> <span class="n">jit</span><span class="p">,</span> <span class="n">vmap</span><span class="p">,</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">jnp</span><span class="p">,</span> <span class="n">random</span> <span class="k">as</span> <span class="n">jr</span><span class="p">,</span> <span class="n">core</span>
<span class="kn">from</span> <span class="nn">jax._src</span> <span class="kn">import</span> <span class="n">dtypes</span>
<span class="kn">from</span> <span class="nn">jax.experimental.host_callback</span> <span class="kn">import</span> <span class="n">call</span>
<span class="kn">from</span> <span class="nn">jax.tree_util</span> <span class="kn">import</span> <span class="n">register_pytree_node</span>

<span class="kn">from</span> <span class="nn">brainpy.check</span> <span class="kn">import</span> <span class="n">jit_error_checking</span>
<span class="kn">from</span> <span class="nn">.ndarray</span> <span class="kn">import</span> <span class="n">Array</span><span class="p">,</span> <span class="n">Variable</span><span class="p">,</span> <span class="n">_return</span>
<span class="kn">from</span> <span class="nn">.compat_numpy</span> <span class="kn">import</span> <span class="n">shape</span>
<span class="kn">from</span> <span class="nn">.environment</span> <span class="kn">import</span> <span class="n">get_int</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
  <span class="s1">&#39;RandomState&#39;</span><span class="p">,</span> <span class="s1">&#39;Generator&#39;</span><span class="p">,</span> <span class="s1">&#39;DEFAULT&#39;</span><span class="p">,</span>

  <span class="s1">&#39;seed&#39;</span><span class="p">,</span> <span class="s1">&#39;default_rng&#39;</span><span class="p">,</span> <span class="s1">&#39;split_key&#39;</span><span class="p">,</span>

  <span class="c1"># numpy compatibility</span>
  <span class="s1">&#39;rand&#39;</span><span class="p">,</span> <span class="s1">&#39;randint&#39;</span><span class="p">,</span> <span class="s1">&#39;random_integers&#39;</span><span class="p">,</span> <span class="s1">&#39;randn&#39;</span><span class="p">,</span> <span class="s1">&#39;random&#39;</span><span class="p">,</span>
  <span class="s1">&#39;random_sample&#39;</span><span class="p">,</span> <span class="s1">&#39;ranf&#39;</span><span class="p">,</span> <span class="s1">&#39;sample&#39;</span><span class="p">,</span> <span class="s1">&#39;choice&#39;</span><span class="p">,</span> <span class="s1">&#39;permutation&#39;</span><span class="p">,</span> <span class="s1">&#39;shuffle&#39;</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">,</span>
  <span class="s1">&#39;exponential&#39;</span><span class="p">,</span> <span class="s1">&#39;gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;gumbel&#39;</span><span class="p">,</span> <span class="s1">&#39;laplace&#39;</span><span class="p">,</span> <span class="s1">&#39;logistic&#39;</span><span class="p">,</span> <span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="s1">&#39;pareto&#39;</span><span class="p">,</span>
  <span class="s1">&#39;poisson&#39;</span><span class="p">,</span> <span class="s1">&#39;standard_cauchy&#39;</span><span class="p">,</span> <span class="s1">&#39;standard_exponential&#39;</span><span class="p">,</span> <span class="s1">&#39;standard_gamma&#39;</span><span class="p">,</span>
  <span class="s1">&#39;standard_normal&#39;</span><span class="p">,</span> <span class="s1">&#39;standard_t&#39;</span><span class="p">,</span> <span class="s1">&#39;uniform&#39;</span><span class="p">,</span> <span class="s1">&#39;truncated_normal&#39;</span><span class="p">,</span> <span class="s1">&#39;bernoulli&#39;</span><span class="p">,</span>
  <span class="s1">&#39;lognormal&#39;</span><span class="p">,</span> <span class="s1">&#39;binomial&#39;</span><span class="p">,</span> <span class="s1">&#39;chisquare&#39;</span><span class="p">,</span> <span class="s1">&#39;dirichlet&#39;</span><span class="p">,</span> <span class="s1">&#39;geometric&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span>
  <span class="s1">&#39;hypergeometric&#39;</span><span class="p">,</span> <span class="s1">&#39;logseries&#39;</span><span class="p">,</span> <span class="s1">&#39;multinomial&#39;</span><span class="p">,</span> <span class="s1">&#39;multivariate_normal&#39;</span><span class="p">,</span>
  <span class="s1">&#39;negative_binomial&#39;</span><span class="p">,</span> <span class="s1">&#39;noncentral_chisquare&#39;</span><span class="p">,</span> <span class="s1">&#39;noncentral_f&#39;</span><span class="p">,</span> <span class="s1">&#39;power&#39;</span><span class="p">,</span>
  <span class="s1">&#39;rayleigh&#39;</span><span class="p">,</span> <span class="s1">&#39;triangular&#39;</span><span class="p">,</span> <span class="s1">&#39;vonmises&#39;</span><span class="p">,</span> <span class="s1">&#39;wald&#39;</span><span class="p">,</span> <span class="s1">&#39;weibull&#39;</span><span class="p">,</span> <span class="s1">&#39;weibull_min&#39;</span><span class="p">,</span>
  <span class="s1">&#39;zipf&#39;</span><span class="p">,</span> <span class="s1">&#39;maxwell&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;orthogonal&#39;</span><span class="p">,</span> <span class="s1">&#39;loggamma&#39;</span><span class="p">,</span> <span class="s1">&#39;categorical&#39;</span><span class="p">,</span>

  <span class="c1"># pytorch compatibility</span>
  <span class="s1">&#39;rand_like&#39;</span><span class="p">,</span> <span class="s1">&#39;randint_like&#39;</span><span class="p">,</span> <span class="s1">&#39;randn_like&#39;</span><span class="p">,</span>
<span class="p">]</span>


<span class="k">def</span> <span class="nf">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
  <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">jr</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
  <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="n">Array</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">uint32</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;key must be a int or an array with two uint32.&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;key must be a int or an array with two uint32.&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;key must be a int or an array with two uint32.&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">return</span> <span class="p">()</span>
  <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">size</span><span class="p">,)</span>
  <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Must be a list/tuple of int, but got </span><span class="si">{</span><span class="n">size</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_check_shape</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="o">*</span><span class="n">param_shapes</span><span class="p">):</span>
  <span class="n">shape</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">as_named_shape</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">param_shapes</span><span class="p">:</span>
    <span class="n">shape_</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">broadcast_shapes</span><span class="p">(</span><span class="n">shape</span><span class="o">.</span><span class="n">positional</span><span class="p">,</span> <span class="o">*</span><span class="n">param_shapes</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">shape</span><span class="o">.</span><span class="n">positional</span> <span class="o">!=</span> <span class="n">shape_</span><span class="p">:</span>
      <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> parameter shapes must be broadcast-compatible with shape &quot;</span>
             <span class="s2">&quot;argument, and the result of broadcasting the shapes must equal &quot;</span>
             <span class="s2">&quot;the shape argument, but got result </span><span class="si">{}</span><span class="s2"> for shape argument </span><span class="si">{}</span><span class="s2">.&quot;</span><span class="p">)</span>
      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">shape_</span><span class="p">,</span> <span class="n">shape</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">_as_jax_array</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">value</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">Array</span><span class="p">)</span> <span class="k">else</span> <span class="n">a</span>


<span class="k">def</span> <span class="nf">_const</span><span class="p">(</span><span class="n">example</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">dtypes</span><span class="o">.</span><span class="n">is_python_scalar</span><span class="p">(</span><span class="n">example</span><span class="p">):</span>
    <span class="n">dtype</span> <span class="o">=</span> <span class="n">dtypes</span><span class="o">.</span><span class="n">canonicalize_dtype</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">example</span><span class="p">))</span>
    <span class="n">val</span> <span class="o">=</span> <span class="n">dtypes</span><span class="o">.</span><span class="n">scalar_type_of</span><span class="p">(</span><span class="n">example</span><span class="p">)(</span><span class="n">val</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">val</span> <span class="k">if</span> <span class="n">dtype</span> <span class="o">==</span> <span class="n">dtypes</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">canonicalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">dtype</span> <span class="o">=</span> <span class="n">dtypes</span><span class="o">.</span><span class="n">canonicalize_dtype</span><span class="p">(</span><span class="n">example</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>


<span class="n">_tr_params</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span>
  <span class="s2">&quot;tr_params&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;alpha&quot;</span><span class="p">,</span> <span class="s2">&quot;u_r&quot;</span><span class="p">,</span> <span class="s2">&quot;v_r&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;log_p&quot;</span><span class="p">,</span> <span class="s2">&quot;log1_p&quot;</span><span class="p">,</span> <span class="s2">&quot;log_h&quot;</span><span class="p">]</span>
<span class="p">)</span>


<span class="k">def</span> <span class="nf">_get_tr_params</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
  <span class="c1"># See Table 1. Additionally, we pre-compute log(p), log1(-p) and the</span>
  <span class="c1"># constant terms, that depend only on (n, p, m) in log(f(k)) (bottom of page 5).</span>
  <span class="n">mu</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">p</span>
  <span class="n">spq</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mu</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p</span><span class="p">))</span>
  <span class="n">c</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">+</span> <span class="mf">0.5</span>
  <span class="n">b</span> <span class="o">=</span> <span class="mf">1.15</span> <span class="o">+</span> <span class="mf">2.53</span> <span class="o">*</span> <span class="n">spq</span>
  <span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.0873</span> <span class="o">+</span> <span class="mf">0.0248</span> <span class="o">*</span> <span class="n">b</span> <span class="o">+</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">p</span>
  <span class="n">alpha</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2.83</span> <span class="o">+</span> <span class="mf">5.1</span> <span class="o">/</span> <span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="n">spq</span>
  <span class="n">u_r</span> <span class="o">=</span> <span class="mf">0.43</span>
  <span class="n">v_r</span> <span class="o">=</span> <span class="mf">0.92</span> <span class="o">-</span> <span class="mf">4.2</span> <span class="o">/</span> <span class="n">b</span>
  <span class="n">m</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">floor</span><span class="p">((</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
  <span class="n">log_p</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
  <span class="n">log1_p</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">)</span>
  <span class="n">log_h</span> <span class="o">=</span> <span class="p">((</span><span class="n">m</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">m</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">m</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">))</span> <span class="o">+</span> <span class="n">log1_p</span> <span class="o">-</span> <span class="n">log_p</span><span class="p">)</span> <span class="o">+</span>
           <span class="n">_stirling_approx_tail</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">+</span> <span class="n">_stirling_approx_tail</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">m</span><span class="p">))</span>
  <span class="k">return</span> <span class="n">_tr_params</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">u_r</span><span class="p">,</span> <span class="n">v_r</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">log_p</span><span class="p">,</span> <span class="n">log1_p</span><span class="p">,</span> <span class="n">log_h</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_stirling_approx_tail</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
  <span class="n">precomputed</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.08106146679532726</span><span class="p">,</span>
                           <span class="mf">0.04134069595540929</span><span class="p">,</span>
                           <span class="mf">0.02767792568499834</span><span class="p">,</span>
                           <span class="mf">0.02079067210376509</span><span class="p">,</span>
                           <span class="mf">0.01664469118982119</span><span class="p">,</span>
                           <span class="mf">0.01387612882307075</span><span class="p">,</span>
                           <span class="mf">0.01189670994589177</span><span class="p">,</span>
                           <span class="mf">0.01041126526197209</span><span class="p">,</span>
                           <span class="mf">0.009255462182712733</span><span class="p">,</span>
                           <span class="mf">0.008330563433362871</span><span class="p">,</span> <span class="p">])</span>
  <span class="n">kp1</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
  <span class="n">kp1sq</span> <span class="o">=</span> <span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
  <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">k</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">,</span>
                   <span class="n">precomputed</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                   <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mi">12</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mi">360</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mi">1260</span><span class="p">)</span> <span class="o">/</span> <span class="n">kp1sq</span><span class="p">)</span> <span class="o">/</span> <span class="n">kp1sq</span><span class="p">)</span> <span class="o">/</span> <span class="n">kp1</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_binomial_btrs</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Based on the transformed rejection sampling algorithm (BTRS) from the</span>
<span class="sd">  following reference:</span>

<span class="sd">  Hormann, &quot;The Generation of Binonmial Random Variates&quot;</span>
<span class="sd">  (https://core.ac.uk/download/pdf/11007254.pdf)</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="nf">_btrs_body_fn</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">val</span>
    <span class="n">key</span><span class="p">,</span> <span class="n">key_u</span><span class="p">,</span> <span class="n">key_v</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">key_u</span><span class="p">)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">key_v</span><span class="p">)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">u</span> <span class="o">-</span> <span class="mf">0.5</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span>
      <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">tr_params</span><span class="o">.</span><span class="n">a</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">u</span><span class="p">))</span> <span class="o">+</span> <span class="n">tr_params</span><span class="o">.</span><span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span> <span class="o">+</span> <span class="n">tr_params</span><span class="o">.</span><span class="n">c</span>
    <span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">k</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span>

  <span class="k">def</span> <span class="nf">_btrs_cond_fn</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">accept_fn</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
      <span class="c1"># See acceptance condition in Step 3. (Page 3) of TRS algorithm</span>
      <span class="c1"># v &lt;= f(k) * g_grad(u) / alpha</span>

      <span class="n">m</span> <span class="o">=</span> <span class="n">tr_params</span><span class="o">.</span><span class="n">m</span>
      <span class="n">log_p</span> <span class="o">=</span> <span class="n">tr_params</span><span class="o">.</span><span class="n">log_p</span>
      <span class="n">log1_p</span> <span class="o">=</span> <span class="n">tr_params</span><span class="o">.</span><span class="n">log1_p</span>
      <span class="c1"># See: formula for log(f(k)) at bottom of Page 5.</span>
      <span class="n">log_f</span> <span class="o">=</span> <span class="p">(</span>
          <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">n</span> <span class="o">-</span> <span class="n">m</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">k</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">))</span>
          <span class="o">+</span> <span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">n</span> <span class="o">-</span> <span class="n">k</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">))</span> <span class="o">+</span> <span class="n">log_p</span> <span class="o">-</span> <span class="n">log1_p</span><span class="p">)</span>
          <span class="o">+</span> <span class="p">(</span><span class="n">_stirling_approx_tail</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="n">_stirling_approx_tail</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">k</span><span class="p">))</span>
          <span class="o">+</span> <span class="n">tr_params</span><span class="o">.</span><span class="n">log_h</span>
      <span class="p">)</span>
      <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="n">tr_params</span><span class="o">.</span><span class="n">a</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">u</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">tr_params</span><span class="o">.</span><span class="n">b</span>
      <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">v</span> <span class="o">*</span> <span class="n">tr_params</span><span class="o">.</span><span class="n">alpha</span><span class="p">)</span> <span class="o">/</span> <span class="n">g</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">log_f</span>

    <span class="n">k</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">val</span>
    <span class="n">early_accept</span> <span class="o">=</span> <span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">tr_params</span><span class="o">.</span><span class="n">u_r</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">v</span> <span class="o">&lt;=</span> <span class="n">tr_params</span><span class="o">.</span><span class="n">v_r</span><span class="p">)</span>
    <span class="n">early_reject</span> <span class="o">=</span> <span class="p">(</span><span class="n">k</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">k</span> <span class="o">&gt;</span> <span class="n">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lax</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span>
      <span class="n">early_accept</span> <span class="o">|</span> <span class="n">early_reject</span><span class="p">,</span>
      <span class="p">(),</span>
      <span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="o">~</span><span class="n">early_accept</span><span class="p">,</span>
      <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">),</span>
      <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">~</span><span class="n">accept_fn</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">),</span>
    <span class="p">)</span>

  <span class="n">tr_params</span> <span class="o">=</span> <span class="n">_get_tr_params</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
  <span class="n">ret</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">while_loop</span><span class="p">(</span>
    <span class="n">_btrs_cond_fn</span><span class="p">,</span> <span class="n">_btrs_body_fn</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
  <span class="p">)</span>  <span class="c1"># use k=-1 initially so that cond_fn returns True</span>
  <span class="k">return</span> <span class="n">ret</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">_binomial_inversion</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">_binom_inv_body_fn</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="n">i</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">geom_acc</span> <span class="o">=</span> <span class="n">val</span>
    <span class="n">key</span><span class="p">,</span> <span class="n">key_u</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">key_u</span><span class="p">)</span>
    <span class="n">geom</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="o">-</span><span class="n">u</span><span class="p">)</span> <span class="o">/</span> <span class="n">log1_p</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">geom_acc</span> <span class="o">=</span> <span class="n">geom_acc</span> <span class="o">+</span> <span class="n">geom</span>
    <span class="k">return</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">geom_acc</span>

  <span class="k">def</span> <span class="nf">_binom_inv_cond_fn</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="n">i</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">geom_acc</span> <span class="o">=</span> <span class="n">val</span>
    <span class="k">return</span> <span class="n">geom_acc</span> <span class="o">&lt;=</span> <span class="n">n</span>

  <span class="n">log1_p</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">)</span>
  <span class="n">ret</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">while_loop</span><span class="p">(</span><span class="n">_binom_inv_cond_fn</span><span class="p">,</span> <span class="n">_binom_inv_body_fn</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>
  <span class="k">return</span> <span class="n">ret</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">_binomial_dispatch</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">dispatch</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="n">is_le_mid</span> <span class="o">=</span> <span class="n">p</span> <span class="o">&lt;=</span> <span class="mf">0.5</span>
    <span class="n">pq</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">is_le_mid</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">p</span><span class="p">)</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">pq</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span>
      <span class="n">mu</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">,</span>
      <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">pq</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span>
      <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_binomial_inversion</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">),</span>
      <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">pq</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span>
      <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_binomial_btrs</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">is_le_mid</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="n">k</span><span class="p">)</span>

  <span class="c1"># Return 0 for nan `p` or negative `n`, since nan values are not allowed for integer types</span>
  <span class="n">cond0</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">p</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">lax</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span>
    <span class="n">cond0</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">p</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">),</span>
    <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span>
    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">dispatch</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">),</span>
    <span class="p">(),</span>
    <span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cond0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
  <span class="p">)</span>


<span class="nd">@partial</span><span class="p">(</span><span class="n">jit</span><span class="p">,</span> <span class="n">static_argnums</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,))</span>
<span class="k">def</span> <span class="nf">_binomial</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">shape</span><span class="p">):</span>
  <span class="n">shape</span> <span class="o">=</span> <span class="n">shape</span> <span class="ow">or</span> <span class="n">lax</span><span class="o">.</span><span class="n">broadcast_shapes</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
  <span class="c1"># reshape to map over axis 0</span>
  <span class="n">p</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">shape</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">n</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">shape</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">key</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
  <span class="k">if</span> <span class="n">jax</span><span class="o">.</span><span class="n">default_backend</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;cpu&quot;</span><span class="p">:</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_binomial_dispatch</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">vmap</span><span class="p">(</span><span class="k">lambda</span> <span class="o">*</span><span class="n">x</span><span class="p">:</span> <span class="n">_binomial_dispatch</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">))(</span><span class="n">key</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span>


<span class="nd">@partial</span><span class="p">(</span><span class="n">jit</span><span class="p">,</span> <span class="n">static_argnums</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,))</span>
<span class="k">def</span> <span class="nf">_categorical</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">shape</span><span class="p">):</span>
  <span class="c1"># this implementation is fast when event shape is small, and slow otherwise</span>
  <span class="c1"># Ref: https://stackoverflow.com/a/34190035</span>
  <span class="n">shape</span> <span class="o">=</span> <span class="n">shape</span> <span class="ow">or</span> <span class="n">p</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
  <span class="n">s</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">r</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">shape</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="p">,))</span>
  <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">s</span> <span class="o">&lt;</span> <span class="n">r</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_scatter_add_one</span><span class="p">(</span><span class="n">operand</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">updates</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">lax</span><span class="o">.</span><span class="n">scatter_add</span><span class="p">(</span>
    <span class="n">operand</span><span class="p">,</span>
    <span class="n">indices</span><span class="p">,</span>
    <span class="n">updates</span><span class="p">,</span>
    <span class="n">lax</span><span class="o">.</span><span class="n">ScatterDimensionNumbers</span><span class="p">(</span>
      <span class="n">update_window_dims</span><span class="o">=</span><span class="p">(),</span>
      <span class="n">inserted_window_dims</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,),</span>
      <span class="n">scatter_dims_to_operand_dims</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,),</span>
    <span class="p">),</span>
  <span class="p">)</span>


<span class="k">def</span> <span class="nf">_reshape</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">shape</span><span class="p">):</span>
  <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">generic</span><span class="p">)):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_promote_shapes</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">()):</span>
  <span class="c1"># adapted from lax.lax_numpy</span>
  <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">shape</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">args</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">shapes</span> <span class="o">=</span> <span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">]</span>
    <span class="n">num_dims</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lax</span><span class="o">.</span><span class="n">broadcast_shapes</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="o">*</span><span class="n">shapes</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">[</span>
      <span class="n">_reshape</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,)</span> <span class="o">*</span> <span class="p">(</span><span class="n">num_dims</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="o">+</span> <span class="n">s</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">num_dims</span> <span class="k">else</span> <span class="n">arg</span>
      <span class="k">for</span> <span class="n">arg</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">shapes</span><span class="p">)</span>
    <span class="p">]</span>


<span class="nd">@partial</span><span class="p">(</span><span class="n">jit</span><span class="p">,</span> <span class="n">static_argnums</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">_multinomial</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n_max</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">()):</span>
  <span class="k">if</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">!=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">p</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
    <span class="n">broadcast_shape</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">broadcast_shapes</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">p</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">broadcast_shape</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">broadcast_shape</span> <span class="o">+</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">p</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">:])</span>
  <span class="n">shape</span> <span class="o">=</span> <span class="n">shape</span> <span class="ow">or</span> <span class="n">p</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
  <span class="k">if</span> <span class="n">n_max</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span> <span class="o">+</span> <span class="n">p</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">result_type</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
  <span class="c1"># get indices from categorical distribution then gather the result</span>
  <span class="n">indices</span> <span class="o">=</span> <span class="n">_categorical</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="p">(</span><span class="n">n_max</span><span class="p">,)</span> <span class="o">+</span> <span class="n">shape</span><span class="p">)</span>
  <span class="c1"># mask out values when counts is heterogeneous</span>
  <span class="k">if</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">_promote_shapes</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_max</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">shape</span><span class="o">=</span><span class="n">shape</span> <span class="o">+</span> <span class="p">(</span><span class="n">n_max</span><span class="p">,))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">indices</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
    <span class="n">excess</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">jnp</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">n_max</span> <span class="o">-</span> <span class="n">n</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                              <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,))],</span>
                             <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">excess</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="c1"># NB: we transpose to move batch shape to the front</span>
  <span class="n">indices_2D</span> <span class="o">=</span> <span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">indices</span> <span class="o">*</span> <span class="n">mask</span><span class="p">,</span> <span class="p">(</span><span class="n">n_max</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)))</span><span class="o">.</span><span class="n">T</span>
  <span class="n">samples_2D</span> <span class="o">=</span> <span class="n">vmap</span><span class="p">(</span><span class="n">_scatter_add_one</span><span class="p">)(</span><span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">indices_2D</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">indices</span><span class="o">.</span><span class="n">dtype</span><span class="p">),</span>
                                      <span class="n">jnp</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">indices_2D</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">),</span>
                                      <span class="n">jnp</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">indices_2D</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">indices</span><span class="o">.</span><span class="n">dtype</span><span class="p">))</span>
  <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">samples_2D</span><span class="p">,</span> <span class="n">shape</span> <span class="o">+</span> <span class="n">p</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:])</span> <span class="o">-</span> <span class="n">excess</span>


<span class="nd">@partial</span><span class="p">(</span><span class="n">jit</span><span class="p">,</span> <span class="n">static_argnums</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">_von_mises_centered</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">concentration</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">float64</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;Compute centered von Mises samples using rejection sampling from [1]_ with wrapped Cauchy proposal.</span>

<span class="sd">  Returns</span>
<span class="sd">  -------</span>
<span class="sd">  out: array_like</span>
<span class="sd">     centered samples from von Mises</span>

<span class="sd">  References</span>
<span class="sd">  ----------</span>
<span class="sd">  .. [1] Luc Devroye &quot;Non-Uniform Random Variate Generation&quot;, Springer-Verlag, 1986;</span>
<span class="sd">         Chapter 9, p. 473-476. http://www.nrbook.com/devroye/Devroye_files/chapter_nine.pdf</span>

<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">shape</span> <span class="o">=</span> <span class="n">shape</span> <span class="ow">or</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">concentration</span><span class="p">)</span>
  <span class="n">dtype</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">result_type</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
  <span class="n">concentration</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">convert_element_type</span><span class="p">(</span><span class="n">concentration</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
  <span class="n">concentration</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">concentration</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span>

  <span class="n">s_cutoff_map</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">jnp</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">float16</span><span class="p">):</span> <span class="mf">1.8e-1</span><span class="p">,</span>
    <span class="n">jnp</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">float32</span><span class="p">):</span> <span class="mf">2e-2</span><span class="p">,</span>
    <span class="n">jnp</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">float64</span><span class="p">):</span> <span class="mf">1.2e-4</span><span class="p">,</span>
  <span class="p">}</span>
  <span class="n">s_cutoff</span> <span class="o">=</span> <span class="n">s_cutoff_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>

  <span class="n">r</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">concentration</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
  <span class="n">rho</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">r</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">concentration</span><span class="p">)</span>
  <span class="n">s_exact</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">rho</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">rho</span><span class="p">)</span>

  <span class="n">s_approximate</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">concentration</span>

  <span class="n">s</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">concentration</span> <span class="o">&gt;</span> <span class="n">s_cutoff</span><span class="p">,</span> <span class="n">s_exact</span><span class="p">,</span> <span class="n">s_approximate</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">cond_fn</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;check if all are done or reached max number of iterations&quot;&quot;&quot;</span>
    <span class="n">i</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">bitwise_and</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">done</span><span class="p">)))</span>

  <span class="k">def</span> <span class="nf">body_fn</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="n">i</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">uni_ukey</span><span class="p">,</span> <span class="n">uni_vkey</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span>
      <span class="n">key</span><span class="o">=</span><span class="n">uni_ukey</span><span class="p">,</span>
      <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span>
      <span class="n">dtype</span><span class="o">=</span><span class="n">concentration</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span>
      <span class="n">minval</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span>
      <span class="n">maxval</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">u</span><span class="p">)</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">done</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">s</span> <span class="o">*</span> <span class="n">z</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">s</span> <span class="o">+</span> <span class="n">z</span><span class="p">))</span>  <span class="c1"># Update where not done</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">concentration</span> <span class="o">*</span> <span class="p">(</span><span class="n">s</span> <span class="o">-</span> <span class="n">w</span><span class="p">)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">uni_vkey</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">concentration</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
    <span class="n">accept</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">*</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">v</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">y</span> <span class="o">/</span> <span class="n">v</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.0</span> <span class="o">&gt;=</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">accept</span> <span class="o">|</span> <span class="n">done</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">w</span>

  <span class="n">init_done</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
  <span class="n">init_u</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
  <span class="n">init_w</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>

  <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">while_loop</span><span class="p">(</span>
    <span class="n">cond_fun</span><span class="o">=</span><span class="n">cond_fn</span><span class="p">,</span>
    <span class="n">body_fun</span><span class="o">=</span><span class="n">body_fn</span><span class="p">,</span>
    <span class="n">init_val</span><span class="o">=</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">key</span><span class="p">,</span> <span class="n">init_done</span><span class="p">,</span> <span class="n">init_u</span><span class="p">,</span> <span class="n">init_w</span><span class="p">),</span>
  <span class="p">)</span>

  <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_loc_scale</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">loc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">scale</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">value</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">value</span> <span class="o">*</span> <span class="n">scale</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">scale</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">value</span> <span class="o">+</span> <span class="n">loc</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">value</span> <span class="o">*</span> <span class="n">scale</span> <span class="o">+</span> <span class="n">loc</span>


<span class="k">def</span> <span class="nf">_check_py_seq</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">))</span> <span class="k">else</span> <span class="n">seq</span>


<div class="viewcode-block" id="RandomState"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.RandomState.html#brainpy.math.random.RandomState">[docs]</a><span class="k">class</span> <span class="nc">RandomState</span><span class="p">(</span><span class="n">Variable</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;RandomState that track the random generator state. &quot;&quot;&quot;</span>
  <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

<div class="viewcode-block" id="RandomState.__init__"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.RandomState.html#brainpy.math.random.RandomState.__init__">[docs]</a>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
               <span class="n">seed_or_key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Array</span><span class="p">,</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">seed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;RandomState constructor.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    seed_or_key: int, Array, optional</span>
<span class="sd">      It can be an integer for initial seed of the random number generator,</span>
<span class="sd">      or it can be a JAX&#39;s PRNKey, which is an array with two elements and `uint32` dtype.</span>

<span class="sd">      .. versionadded:: 2.2.3.4</span>

<span class="sd">    seed : int, ArrayType, optional</span>
<span class="sd">      Same as `seed_or_key`.</span>

<span class="sd">      .. deprecated:: 2.2.3.4</span>
<span class="sd">         Will be removed since version 2.4.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">seed_or_key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Please set &quot;seed_or_key&quot; or &quot;seed&quot;, not both.&#39;</span><span class="p">)</span>
      <span class="n">seed_or_key</span> <span class="o">=</span> <span class="n">seed</span>
      <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Please use `seed_or_key` instead. &#39;</span>
                    <span class="s1">&#39;seed will be removed since 2.4.0&#39;</span><span class="p">,</span> <span class="ne">UserWarning</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">seed_or_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">seed_or_key</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100000</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint32</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">seed_or_key</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
      <span class="n">key</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="n">seed_or_key</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">seed_or_key</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">seed_or_key</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;key must be an array with dtype uint32. &#39;</span>
                         <span class="sa">f</span><span class="s1">&#39;But we got </span><span class="si">{</span><span class="n">seed_or_key</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
      <span class="n">key</span> <span class="o">=</span> <span class="n">seed_or_key</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">RandomState</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></div>

  <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="n">print_code</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">print_code</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">(key=</span><span class="si">{</span><span class="n">print_code</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span><span class="si">}</span><span class="s1">)&#39;</span>

  <span class="c1"># ------------------- #</span>
  <span class="c1"># seed and random key #</span>
  <span class="c1"># ------------------- #</span>

  <span class="k">def</span> <span class="nf">clone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">())</span>

  <span class="k">def</span> <span class="nf">seed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed_or_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets a new random seed.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    seed_or_key: int, ArrayType, optional</span>
<span class="sd">      It can be an integer for initial seed of the random number generator,</span>
<span class="sd">      or it can be a JAX&#39;s PRNKey, which is an array with two elements and `uint32` dtype.</span>

<span class="sd">      .. versionadded:: 2.2.3.4</span>

<span class="sd">    seed : int, ArrayType, optional</span>
<span class="sd">      Same as `seed_or_key`.</span>

<span class="sd">      .. deprecated:: 2.2.3.4</span>
<span class="sd">         Will be removed since version 2.4.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">seed_or_key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Please set &quot;seed_or_key&quot; or &quot;seed&quot;, not both.&#39;</span><span class="p">)</span>
      <span class="n">seed_or_key</span> <span class="o">=</span> <span class="n">seed</span>
      <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Please use seed_or_key instead. &#39;</span>
                    <span class="s1">&#39;seed will be removed since 2.4.0&#39;</span><span class="p">,</span> <span class="ne">UserWarning</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">seed_or_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">seed_or_key</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100000</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint32</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">seed_or_key</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
      <span class="n">key</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="n">seed_or_key</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">seed_or_key</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">seed_or_key</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;key must be an array with dtype uint32. &#39;</span>
                         <span class="sa">f</span><span class="s1">&#39;But we got </span><span class="si">{</span><span class="n">seed_or_key</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
      <span class="n">key</span> <span class="o">=</span> <span class="n">seed_or_key</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">key</span>

  <span class="k">def</span> <span class="nf">split_key</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a new seed from the current seed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

  <span class="k">def</span> <span class="nf">split_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create multiple seeds from the current seed. This is used</span>
<span class="sd">    internally by `pmap` and `vmap` to ensure that random numbers</span>
<span class="sd">    are different in parallel threads.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    n : int</span>
<span class="sd">      The number of seeds to generate.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

  <span class="c1"># ---------------- #</span>
  <span class="c1"># random functions #</span>
  <span class="c1"># ---------------- #</span>

  <span class="k">def</span> <span class="nf">rand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">dn</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">dn</span><span class="p">,</span> <span class="n">minval</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">maxval</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">randint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">dtype</span> <span class="o">=</span> <span class="n">get_int</span><span class="p">()</span> <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">dtype</span>
    <span class="n">low</span> <span class="o">=</span> <span class="n">_as_jax_array</span><span class="p">(</span><span class="n">low</span><span class="p">)</span>
    <span class="n">high</span> <span class="o">=</span> <span class="n">_as_jax_array</span><span class="p">(</span><span class="n">high</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">high</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">high</span> <span class="o">=</span> <span class="n">low</span>
      <span class="n">low</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">high</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">high</span><span class="p">)</span>
    <span class="n">low</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">low</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">broadcast_shapes</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">low</span><span class="p">),</span>
                                  <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">high</span><span class="p">))</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">key</span><span class="p">,</span>
                   <span class="n">shape</span><span class="o">=</span><span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">),</span>
                   <span class="n">minval</span><span class="o">=</span><span class="n">low</span><span class="p">,</span> <span class="n">maxval</span><span class="o">=</span><span class="n">high</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">random_integers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">low</span> <span class="o">=</span> <span class="n">_as_jax_array</span><span class="p">(</span><span class="n">low</span><span class="p">)</span>
    <span class="n">high</span> <span class="o">=</span> <span class="n">_as_jax_array</span><span class="p">(</span><span class="n">high</span><span class="p">)</span>
    <span class="n">low</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">low</span><span class="p">)</span>
    <span class="n">high</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">high</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">high</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">high</span> <span class="o">=</span> <span class="n">low</span>
      <span class="n">low</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">high</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">broadcast_shapes</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">low</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">high</span><span class="p">))</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">key</span><span class="p">,</span>
                   <span class="n">shape</span><span class="o">=</span><span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">),</span>
                   <span class="n">minval</span><span class="o">=</span><span class="n">low</span><span class="p">,</span>
                   <span class="n">maxval</span><span class="o">=</span><span class="n">high</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">randn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">dn</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">dn</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">),</span> <span class="n">minval</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">maxval</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">random_sample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">ranf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">sample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">choice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">_as_jax_array</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">_as_jax_array</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">),</span> <span class="n">replace</span><span class="o">=</span><span class="n">replace</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">permutation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">independent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Array</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">independent</span><span class="o">=</span><span class="n">independent</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">shuffle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Array</span><span class="p">):</span>
      <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;This numpy operator needs in-place updating, therefore &#39;</span>
                      <span class="s1">&#39;inputs should be brainpy Array.&#39;</span><span class="p">)</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">x</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">beta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">value</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">Array</span><span class="p">)</span> <span class="k">else</span> <span class="n">a</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">value</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">Array</span><span class="p">)</span> <span class="k">else</span> <span class="n">b</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">broadcast_shapes</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">exponential</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="n">_as_jax_array</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">scale</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">r</span> <span class="o">=</span> <span class="n">r</span> <span class="o">/</span> <span class="n">scale</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">gamma</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="n">_as_jax_array</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="n">_as_jax_array</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">broadcast_shapes</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">shape</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">scale</span><span class="p">))</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">scale</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">r</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">scale</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">gumbel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">loc</span> <span class="o">=</span> <span class="n">_as_jax_array</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="n">_as_jax_array</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
    <span class="n">loc</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">broadcast_shapes</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">loc</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">scale</span><span class="p">))</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">_loc_scale</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">jr</span><span class="o">.</span><span class="n">gumbel</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">laplace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">loc</span> <span class="o">=</span> <span class="n">_as_jax_array</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="n">_as_jax_array</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
    <span class="n">loc</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">broadcast_shapes</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">loc</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">scale</span><span class="p">))</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">_loc_scale</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">jr</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">logistic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">loc</span> <span class="o">=</span> <span class="n">_as_jax_array</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="n">_as_jax_array</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
    <span class="n">loc</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">broadcast_shapes</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">loc</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">scale</span><span class="p">))</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">_loc_scale</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">jr</span><span class="o">.</span><span class="n">logistic</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">normal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">loc</span> <span class="o">=</span> <span class="n">_as_jax_array</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="n">_as_jax_array</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
    <span class="n">loc</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">broadcast_shapes</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">scale</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">loc</span><span class="p">))</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">_loc_scale</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">jr</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">pareto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">_as_jax_array</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">pareto</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">poisson</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lam</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">lam</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">_as_jax_array</span><span class="p">(</span><span class="n">lam</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">lam</span><span class="p">)</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">lam</span><span class="o">=</span><span class="n">lam</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">standard_cauchy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">cauchy</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">standard_exponential</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">standard_gamma</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="n">_as_jax_array</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">standard_normal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">standard_t</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">_as_jax_array</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">t</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">uniform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">low</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">low</span> <span class="o">=</span> <span class="n">_as_jax_array</span><span class="p">(</span><span class="n">low</span><span class="p">)</span>
    <span class="n">high</span> <span class="o">=</span> <span class="n">_as_jax_array</span><span class="p">(</span><span class="n">high</span><span class="p">)</span>
    <span class="n">low</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">low</span><span class="p">)</span>
    <span class="n">high</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">high</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">broadcast_shapes</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">low</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">high</span><span class="p">))</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">),</span> <span class="n">minval</span><span class="o">=</span><span class="n">low</span><span class="p">,</span> <span class="n">maxval</span><span class="o">=</span><span class="n">high</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">truncated_normal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">lower</span> <span class="o">=</span> <span class="n">_as_jax_array</span><span class="p">(</span><span class="n">lower</span><span class="p">)</span>
    <span class="n">lower</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">lower</span><span class="p">)</span>
    <span class="n">upper</span> <span class="o">=</span> <span class="n">_as_jax_array</span><span class="p">(</span><span class="n">upper</span><span class="p">)</span>
    <span class="n">upper</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">upper</span><span class="p">)</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="n">_as_jax_array</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">broadcast_shapes</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">lower</span><span class="p">),</span>
                                  <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">upper</span><span class="p">),</span>
                                  <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">scale</span><span class="p">))</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">rands</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">truncated_normal</span><span class="p">(</span><span class="n">key</span><span class="p">,</span>
                                <span class="n">lower</span><span class="o">=</span><span class="n">lower</span><span class="p">,</span>
                                <span class="n">upper</span><span class="o">=</span><span class="n">upper</span><span class="p">,</span>
                                <span class="n">shape</span><span class="o">=</span><span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">scale</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">rands</span> <span class="o">=</span> <span class="n">rands</span> <span class="o">*</span> <span class="n">scale</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">rands</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">_check_p</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parameter p should be within [0, 1], but we got </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">bernoulli</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">_as_jax_array</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
    <span class="n">jit_error_checking</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">p</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_p</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">bernoulli</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">lognormal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">_as_jax_array</span><span class="p">(</span><span class="n">mean</span><span class="p">))</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">_as_jax_array</span><span class="p">(</span><span class="n">sigma</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">broadcast_shapes</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">mean</span><span class="p">),</span>
                                  <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">sigma</span><span class="p">))</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">samples</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">))</span>
    <span class="n">samples</span> <span class="o">=</span> <span class="n">_loc_scale</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">samples</span><span class="p">)</span>
    <span class="n">samples</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">binomial</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">value</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">Array</span><span class="p">)</span> <span class="k">else</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">value</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">Array</span><span class="p">)</span> <span class="k">else</span> <span class="n">p</span><span class="p">)</span>
    <span class="n">jit_error_checking</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">p</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_p</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">broadcast_shapes</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">_binomial</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">chisquare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">_as_jax_array</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="n">df</span><span class="p">,))</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;Do not support non-scale &quot;df&quot; when &quot;size&quot; is None&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">dist</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="n">df</span><span class="p">,)</span> <span class="o">+</span> <span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span>
      <span class="n">dist</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">dirichlet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">_as_jax_array</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">dirichlet</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">geometric</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">_as_jax_array</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="o">-</span><span class="n">u</span><span class="p">)</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">_check_p2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;We require `sum(pvals[:-1]) &lt;= 1`. But we got </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">multinomial</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">pvals</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">_as_jax_array</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="n">pvals</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">_as_jax_array</span><span class="p">(</span><span class="n">pvals</span><span class="p">))</span>
    <span class="n">jit_error_checking</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">pvals</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mf">1.</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_p2</span><span class="p">,</span> <span class="n">pvals</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">jax</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Tracer</span><span class="p">):</span>
      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The total count parameter `n` should not be a jax abstract array.&quot;</span><span class="p">)</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
    <span class="n">n_max</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">jax</span><span class="o">.</span><span class="n">device_get</span><span class="p">(</span><span class="n">n</span><span class="p">)))</span>
    <span class="n">batch_shape</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">broadcast_shapes</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">pvals</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">_multinomial</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">pvals</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n_max</span><span class="p">,</span> <span class="n">batch_shape</span> <span class="o">+</span> <span class="n">size</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">multivariate_normal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">cov</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;cholesky&#39;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;svd&#39;</span><span class="p">,</span> <span class="s1">&#39;eigh&#39;</span><span class="p">,</span> <span class="s1">&#39;cholesky&#39;</span><span class="p">}:</span>
      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;method must be one of {&#39;svd&#39;, &#39;eigh&#39;, &#39;cholesky&#39;}&quot;</span><span class="p">)</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">_as_jax_array</span><span class="p">(</span><span class="n">mean</span><span class="p">))</span>
    <span class="n">cov</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">_as_jax_array</span><span class="p">(</span><span class="n">cov</span><span class="p">))</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;multivariate_normal requires mean.ndim &gt;= 1, got mean.ndim == </span><span class="si">{</span><span class="n">jnp</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">cov</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;multivariate_normal requires cov.ndim &gt;= 2, got cov.ndim == </span><span class="si">{</span><span class="n">jnp</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">cov</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">mean</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">cov</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span> <span class="o">!=</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;multivariate_normal requires cov.shape == (..., n, n) for n=</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">, &quot;</span>
                       <span class="sa">f</span><span class="s2">&quot;but got cov.shape == </span><span class="si">{</span><span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">cov</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">broadcast_shapes</span><span class="p">(</span><span class="n">mean</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">cov</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
      <span class="n">_check_shape</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">mean</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">cov</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;svd&#39;</span><span class="p">:</span>
      <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">cov</span><span class="p">)</span>
      <span class="n">factor</span> <span class="o">=</span> <span class="n">u</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">:])</span>
    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;eigh&#39;</span><span class="p">:</span>
      <span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">cov</span><span class="p">)</span>
      <span class="n">factor</span> <span class="o">=</span> <span class="n">v</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">:])</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># &#39;cholesky&#39;</span>
      <span class="n">factor</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cholesky</span><span class="p">(</span><span class="n">cov</span><span class="p">)</span>
    <span class="n">normal_samples</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">size</span> <span class="o">+</span> <span class="n">mean</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:])</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">+</span> <span class="n">jnp</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;...ij,...j-&gt;...i&#39;</span><span class="p">,</span> <span class="n">factor</span><span class="p">,</span> <span class="n">normal_samples</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">rayleigh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">_as_jax_array</span><span class="p">(</span><span class="n">scale</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">jr</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">),</span> <span class="n">minval</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">maxval</span><span class="o">=</span><span class="mi">1</span><span class="p">)))</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">scale</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">triangular</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">bernoulli_samples</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">bernoulli</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">))</span>
    <span class="n">r</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">bernoulli_samples</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">vonmises</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">kappa</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">_as_jax_array</span><span class="p">(</span><span class="n">mu</span><span class="p">))</span>
    <span class="n">kappa</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">_as_jax_array</span><span class="p">(</span><span class="n">kappa</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">broadcast_shapes</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">mu</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">kappa</span><span class="p">))</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
    <span class="n">samples</span> <span class="o">=</span> <span class="n">_von_mises_centered</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">kappa</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
    <span class="n">samples</span> <span class="o">=</span> <span class="n">samples</span> <span class="o">+</span> <span class="n">mu</span>
    <span class="n">samples</span> <span class="o">=</span> <span class="p">(</span><span class="n">samples</span> <span class="o">+</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">-</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">weibull</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">_as_jax_array</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">jnp</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&quot;a&quot; should be a scalar when &quot;size&quot; is provided. But we got </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
    <span class="n">random_uniform</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">minval</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">maxval</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="o">-</span><span class="n">jnp</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="o">-</span><span class="n">random_uniform</span><span class="p">),</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">a</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">weibull_min</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sample from a Weibull minimum distribution.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a: float, array_like</span>
<span class="sd">      The concentration parameter of the distribution.</span>
<span class="sd">    scale: float, array_like</span>
<span class="sd">      The scale parameter of the distribution.</span>
<span class="sd">    size: optional, int, tuple of int</span>
<span class="sd">      The shape added to the parameters loc and scale broadcastable shape.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    out: array_like</span>
<span class="sd">      The sampling results.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">_as_jax_array</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">_as_jax_array</span><span class="p">(</span><span class="n">scale</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">broadcast_shapes</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">scale</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">jnp</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&quot;a&quot; should be a scalar when &quot;size&quot; is provided. But we got </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
    <span class="n">random_uniform</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">minval</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">maxval</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="o">-</span><span class="n">jnp</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="o">-</span><span class="n">random_uniform</span><span class="p">),</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">a</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">scale</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">r</span> <span class="o">/=</span> <span class="n">scale</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">maxwell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">canonicalize_shape</span><span class="p">(</span><span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="mi">3</span><span class="p">,)</span>
    <span class="n">norm_rvs</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">norm_rvs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">negative_binomial</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">_as_jax_array</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">_as_jax_array</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">broadcast_shapes</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
    <span class="n">logits</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">-</span> <span class="n">jnp</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_keys</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">keys</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">rate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">logits</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="n">lam</span><span class="o">=</span><span class="n">rate</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">wald</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">_as_jax_array</span><span class="p">(</span><span class="n">mean</span><span class="p">))</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">_as_jax_array</span><span class="p">(</span><span class="n">scale</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">broadcast_shapes</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">mean</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">scale</span><span class="p">))</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
    <span class="n">sampled_chi2</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">_as_jax_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="o">*</span><span class="n">size</span><span class="p">)))</span>
    <span class="n">sampled_uniform</span> <span class="o">=</span> <span class="n">_as_jax_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">))</span>
    <span class="c1"># Wikipedia defines an intermediate x with the formula</span>
    <span class="c1">#   x = loc + loc ** 2 * y / (2 * conc) - loc / (2 * conc) * sqrt(4 * loc * conc * y + loc ** 2 * y ** 2)</span>
    <span class="c1"># where y ~ N(0, 1)**2 (sampled_chi2 above) and conc is the concentration.</span>
    <span class="c1"># Let us write</span>
    <span class="c1">#   w = loc * y / (2 * conc)</span>
    <span class="c1"># Then we can extract the common factor in the last two terms to obtain</span>
    <span class="c1">#   x = loc + loc * w * (1 - sqrt(2 / w + 1))</span>
    <span class="c1"># Now we see that the Wikipedia formula suffers from catastrphic</span>
    <span class="c1"># cancellation for large w (e.g., if conc &lt;&lt; loc).</span>
    <span class="c1">#</span>
    <span class="c1"># Fortunately, we can fix this by multiplying both sides</span>
    <span class="c1"># by 1 + sqrt(2 / w + 1).  We get</span>
    <span class="c1">#   x * (1 + sqrt(2 / w + 1)) =</span>
    <span class="c1">#     = loc * (1 + sqrt(2 / w + 1)) + loc * w * (1 - (2 / w + 1))</span>
    <span class="c1">#     = loc * (sqrt(2 / w + 1) - 1)</span>
    <span class="c1"># The term sqrt(2 / w + 1) + 1 no longer presents numerical</span>
    <span class="c1"># difficulties for large w, and sqrt(2 / w + 1) - 1 is just</span>
    <span class="c1"># sqrt1pm1(2 / w), which we know how to compute accurately.</span>
    <span class="c1"># This just leaves the matter of small w, where 2 / w may</span>
    <span class="c1"># overflow.  In the limit a w -&gt; 0, x -&gt; loc, so we just mask</span>
    <span class="c1"># that case.</span>
    <span class="n">sqrt1pm1_arg</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">scale</span> <span class="o">/</span> <span class="p">(</span><span class="n">mean</span> <span class="o">*</span> <span class="n">sampled_chi2</span><span class="p">)</span>  <span class="c1"># 2 / w above</span>
    <span class="n">safe_sqrt1pm1_arg</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sqrt1pm1_arg</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">sqrt1pm1_arg</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">denominator</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">safe_sqrt1pm1_arg</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">ratio</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">safe_sqrt1pm1_arg</span><span class="p">))</span> <span class="o">/</span> <span class="n">denominator</span>
    <span class="n">sampled</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sqrt1pm1_arg</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">ratio</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>  <span class="c1"># x above</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sampled_uniform</span> <span class="o">&lt;=</span> <span class="n">mean</span> <span class="o">/</span> <span class="p">(</span><span class="n">mean</span> <span class="o">+</span> <span class="n">sampled</span><span class="p">),</span>
                    <span class="n">sampled</span><span class="p">,</span>
                    <span class="n">jnp</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span> <span class="o">/</span> <span class="n">sampled</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">t</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">_as_jax_array</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
      <span class="n">_check_shape</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_keys</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">keys</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">size</span><span class="p">)</span>
    <span class="n">two</span> <span class="o">=</span> <span class="n">_const</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">half_df</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">two</span><span class="p">)</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">half_df</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">half_df</span> <span class="o">/</span> <span class="n">g</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">orthogonal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
    <span class="n">_check_shape</span><span class="p">(</span><span class="s2">&quot;orthogonal&quot;</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">concrete_or_error</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="s2">&quot;The error occurred in jax.random.orthogonal()&quot;</span><span class="p">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">size</span> <span class="o">+</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
    <span class="n">q</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">qr</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">diagonal</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">q</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">d</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">noncentral_chisquare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">nonc</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">_as_jax_array</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
    <span class="n">nonc</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">_as_jax_array</span><span class="p">(</span><span class="n">nonc</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">broadcast_shapes</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">nonc</span><span class="p">))</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_keys</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">keys</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">nonc</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="n">size</span><span class="p">)</span> <span class="o">+</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">nonc</span><span class="p">)</span>
    <span class="n">cond</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">greater</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">df2</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="n">df</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">df</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">chi2</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">jr</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">df2</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="n">chi2</span> <span class="o">+</span> <span class="n">n</span> <span class="o">*</span> <span class="n">n</span><span class="p">,</span> <span class="n">chi2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">loggamma</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">_as_jax_array</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">loggamma</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">categorical</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">logits</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_formalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">logits</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">_as_jax_array</span><span class="p">(</span><span class="n">logits</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">logits</span><span class="p">))</span>
      <span class="n">size</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">categorical</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">logits</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">zipf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">_as_jax_array</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">call</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">zipf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">size</span><span class="p">),</span>
             <span class="n">a</span><span class="p">,</span>
             <span class="n">result_shape</span><span class="o">=</span><span class="n">jax</span><span class="o">.</span><span class="n">ShapeDtypeStruct</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">int_</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">power</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">_as_jax_array</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">call</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">),</span>
             <span class="n">a</span><span class="p">,</span> <span class="n">result_shape</span><span class="o">=</span><span class="n">jax</span><span class="o">.</span><span class="n">ShapeDtypeStruct</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">float_</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dfnum</span><span class="p">,</span> <span class="n">dfden</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">dfnum</span> <span class="o">=</span> <span class="n">_as_jax_array</span><span class="p">(</span><span class="n">dfnum</span><span class="p">)</span>
    <span class="n">dfden</span> <span class="o">=</span> <span class="n">_as_jax_array</span><span class="p">(</span><span class="n">dfden</span><span class="p">)</span>
    <span class="n">dfnum</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">dfnum</span><span class="p">)</span>
    <span class="n">dfden</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">dfden</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">broadcast_shapes</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">dfnum</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">dfden</span><span class="p">))</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dfnum&#39;</span><span class="p">:</span> <span class="n">dfnum</span><span class="p">,</span> <span class="s1">&#39;dfden&#39;</span><span class="p">:</span> <span class="n">dfden</span><span class="p">}</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">call</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="n">dfnum</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;dfnum&#39;</span><span class="p">],</span>
                                   <span class="n">dfden</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;dfden&#39;</span><span class="p">],</span>
                                   <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">),</span>
             <span class="n">d</span><span class="p">,</span>
             <span class="n">result_shape</span><span class="o">=</span><span class="n">jax</span><span class="o">.</span><span class="n">ShapeDtypeStruct</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">float_</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">hypergeometric</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ngood</span><span class="p">,</span> <span class="n">nbad</span><span class="p">,</span> <span class="n">nsample</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">ngood</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">_as_jax_array</span><span class="p">(</span><span class="n">ngood</span><span class="p">))</span>
    <span class="n">nbad</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">_as_jax_array</span><span class="p">(</span><span class="n">nbad</span><span class="p">))</span>
    <span class="n">nsample</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">_as_jax_array</span><span class="p">(</span><span class="n">nsample</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">broadcast_shapes</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">ngood</span><span class="p">),</span>
                                  <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">nbad</span><span class="p">),</span>
                                  <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">nsample</span><span class="p">))</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ngood&#39;</span><span class="p">:</span> <span class="n">ngood</span><span class="p">,</span> <span class="s1">&#39;nbad&#39;</span><span class="p">:</span> <span class="n">nbad</span><span class="p">,</span> <span class="s1">&#39;nsample&#39;</span><span class="p">:</span> <span class="n">nsample</span><span class="p">}</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">call</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">hypergeometric</span><span class="p">(</span><span class="n">ngood</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;ngood&#39;</span><span class="p">],</span>
                                                <span class="n">nbad</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;nbad&#39;</span><span class="p">],</span>
                                                <span class="n">nsample</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;nsample&#39;</span><span class="p">],</span>
                                                <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">),</span>
             <span class="n">d</span><span class="p">,</span> <span class="n">result_shape</span><span class="o">=</span><span class="n">jax</span><span class="o">.</span><span class="n">ShapeDtypeStruct</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">int_</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">logseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">_as_jax_array</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">call</span><span class="p">(</span><span class="k">lambda</span> <span class="n">p</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">logseries</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">),</span>
             <span class="n">p</span><span class="p">,</span> <span class="n">result_shape</span><span class="o">=</span><span class="n">jax</span><span class="o">.</span><span class="n">ShapeDtypeStruct</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">int_</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">noncentral_f</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dfnum</span><span class="p">,</span> <span class="n">dfden</span><span class="p">,</span> <span class="n">nonc</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">dfnum</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">_as_jax_array</span><span class="p">(</span><span class="n">dfnum</span><span class="p">))</span>
    <span class="n">dfden</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">_as_jax_array</span><span class="p">(</span><span class="n">dfden</span><span class="p">))</span>
    <span class="n">nonc</span> <span class="o">=</span> <span class="n">_check_py_seq</span><span class="p">(</span><span class="n">_as_jax_array</span><span class="p">(</span><span class="n">nonc</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">size</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">broadcast_shapes</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">dfnum</span><span class="p">),</span>
                                  <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">dfden</span><span class="p">),</span>
                                  <span class="n">jnp</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">nonc</span><span class="p">))</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">_size2shape</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dfnum&#39;</span><span class="p">:</span> <span class="n">dfnum</span><span class="p">,</span> <span class="s1">&#39;dfden&#39;</span><span class="p">:</span> <span class="n">dfden</span><span class="p">,</span> <span class="s1">&#39;nonc&#39;</span><span class="p">:</span> <span class="n">nonc</span><span class="p">}</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">call</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">noncentral_f</span><span class="p">(</span><span class="n">dfnum</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;dfnum&#39;</span><span class="p">],</span>
                                              <span class="n">dfden</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;dfden&#39;</span><span class="p">],</span>
                                              <span class="n">nonc</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;nonc&#39;</span><span class="p">],</span>
                                              <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">),</span>
             <span class="n">d</span><span class="p">,</span> <span class="n">result_shape</span><span class="o">=</span><span class="n">jax</span><span class="o">.</span><span class="n">ShapeDtypeStruct</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">float_</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">_return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

  <span class="c1"># PyTorch compatibility #</span>
  <span class="c1"># --------------------- #</span>

  <span class="k">def</span> <span class="nf">rand_like</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">input</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a tensor with the same size as input that is filled with random</span>
<span class="sd">    numbers from a uniform distribution on the interval ``[0, 1)``.</span>

<span class="sd">    Args:</span>
<span class="sd">      input:  the ``size`` of input will determine size of the output tensor.</span>
<span class="sd">      dtype:  the desired data type of returned Tensor. Default: if ``None``, defaults to the dtype of input.</span>
<span class="sd">      key: the seed or key for the random.</span>

<span class="sd">    Returns:</span>
<span class="sd">      The random data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">shape</span><span class="p">(</span><span class="nb">input</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">randn_like</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">input</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a tensor with the same size as ``input`` that is filled with</span>
<span class="sd">    random numbers from a normal distribution with mean 0 and variance 1.</span>

<span class="sd">    Args:</span>
<span class="sd">      input:  the ``size`` of input will determine size of the output tensor.</span>
<span class="sd">      dtype:  the desired data type of returned Tensor. Default: if ``None``, defaults to the dtype of input.</span>
<span class="sd">      key: the seed or key for the random.</span>

<span class="sd">    Returns:</span>
<span class="sd">      The random data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="o">*</span><span class="n">shape</span><span class="p">(</span><span class="nb">input</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">randint_like</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">input</span><span class="p">,</span> <span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">high</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">high</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">high</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">shape</span><span class="p">(</span><span class="nb">input</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<span class="c1"># alias</span>
<span class="n">Generator</span> <span class="o">=</span> <span class="n">RandomState</span>

<span class="c1"># register pytree</span>
<span class="n">register_pytree_node</span><span class="p">(</span><span class="n">RandomState</span><span class="p">,</span>
                     <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="p">((</span><span class="n">t</span><span class="o">.</span><span class="n">value</span><span class="p">,),</span> <span class="kc">None</span><span class="p">),</span>
                     <span class="k">lambda</span> <span class="n">aux_data</span><span class="p">,</span> <span class="n">flat_contents</span><span class="p">:</span> <span class="n">RandomState</span><span class="p">(</span><span class="o">*</span><span class="n">flat_contents</span><span class="p">))</span>

<span class="c1"># default random generator</span>
<span class="n">__a</span> <span class="o">=</span> <span class="n">Array</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="n">__a</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint32</span><span class="p">)</span>
<span class="n">DEFAULT</span> <span class="o">=</span> <span class="n">RandomState</span><span class="p">(</span><span class="n">__a</span><span class="p">)</span>
<span class="k">del</span> <span class="n">__a</span>


<div class="viewcode-block" id="split_key"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.split_key.html#brainpy.math.random.split_key">[docs]</a><span class="k">def</span> <span class="nf">split_key</span><span class="p">():</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">split_key</span><span class="p">()</span></div>


<span class="k">def</span> <span class="nf">clone_rng</span><span class="p">(</span><span class="n">seed_or_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">clone</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RandomState</span><span class="p">:</span>
  <span class="k">if</span> <span class="n">seed_or_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span> <span class="k">if</span> <span class="n">clone</span> <span class="k">else</span> <span class="n">DEFAULT</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">RandomState</span><span class="p">(</span><span class="n">seed_or_key</span><span class="p">)</span>


<span class="c1"># @wraps(np.random.default_rng)</span>
<div class="viewcode-block" id="default_rng"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.default_rng.html#brainpy.math.random.default_rng">[docs]</a><span class="k">def</span> <span class="nf">default_rng</span><span class="p">(</span><span class="n">seed_or_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">clone</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RandomState</span><span class="p">:</span>
  <span class="k">if</span> <span class="n">seed_or_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span> <span class="k">if</span> <span class="n">clone</span> <span class="k">else</span> <span class="n">DEFAULT</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">RandomState</span><span class="p">(</span><span class="n">seed_or_key</span><span class="p">)</span></div>


<div class="viewcode-block" id="seed"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.seed.html#brainpy.math.random.seed">[docs]</a><span class="k">def</span> <span class="nf">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;Sets a new random seed.</span>

<span class="sd">  Parameters</span>
<span class="sd">  ----------</span>
<span class="sd">  seed: int, optional</span>
<span class="sd">    The random seed.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100000</span><span class="p">)</span>
  <span class="n">DEFAULT</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
  <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span></div>


<div class="viewcode-block" id="rand"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.rand.html#brainpy.math.random.rand">[docs]</a><span class="k">def</span> <span class="nf">rand</span><span class="p">(</span><span class="o">*</span><span class="n">dn</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Random values in a given shape.</span>

<span class="sd">  .. note::</span>
<span class="sd">      This is a convenience function for users porting code from Matlab,</span>
<span class="sd">      and wraps `random_sample`. That function takes a</span>
<span class="sd">      tuple to specify the size of the output, which is consistent with</span>
<span class="sd">      other NumPy functions like `numpy.zeros` and `numpy.ones`.</span>

<span class="sd">  Create an array of the given shape and populate it with</span>
<span class="sd">  random samples from a uniform distribution</span>
<span class="sd">  over ``[0, 1)``.</span>

<span class="sd">  Parameters</span>
<span class="sd">  ----------</span>
<span class="sd">  d0, d1, ..., dn : int, optional</span>
<span class="sd">      The dimensions of the returned array, must be non-negative.</span>
<span class="sd">      If no argument is given a single Python float is returned.</span>

<span class="sd">  Returns</span>
<span class="sd">  -------</span>
<span class="sd">  out : ndarray, shape ``(d0, d1, ..., dn)``</span>
<span class="sd">      Random values.</span>

<span class="sd">  See Also</span>
<span class="sd">  --------</span>
<span class="sd">  random</span>

<span class="sd">  Examples</span>
<span class="sd">  --------</span>
<span class="sd">  &gt;&gt;&gt; brainpy.math.random.rand(3,2)</span>
<span class="sd">  array([[ 0.14022471,  0.96360618],  #random</span>
<span class="sd">         [ 0.37601032,  0.25528411],  #random</span>
<span class="sd">         [ 0.49313049,  0.94909878]]) #random</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="o">*</span><span class="n">dn</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>




<div class="viewcode-block" id="randint"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.randint.html#brainpy.math.random.randint">[docs]</a><span class="k">def</span> <span class="nf">randint</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">int_</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Return random integers from `low` (inclusive) to `high` (exclusive).</span>

<span class="sd">  Return random integers from the &quot;discrete uniform&quot; distribution of</span>
<span class="sd">  the specified dtype in the &quot;half-open&quot; interval [`low`, `high`). If</span>
<span class="sd">  `high` is None (the default), then results are from [0, `low`).</span>

<span class="sd">  Parameters</span>
<span class="sd">  ----------</span>
<span class="sd">  low : int or array-like of ints</span>
<span class="sd">      Lowest (signed) integers to be drawn from the distribution (unless</span>
<span class="sd">      ``high=None``, in which case this parameter is one above the</span>
<span class="sd">      *highest* such integer).</span>
<span class="sd">  high : int or array-like of ints, optional</span>
<span class="sd">      If provided, one above the largest (signed) integer to be drawn</span>
<span class="sd">      from the distribution (see above for behavior if ``high=None``).</span>
<span class="sd">      If array-like, must contain integer values</span>
<span class="sd">  size : int or tuple of ints, optional</span>
<span class="sd">      Output shape.  If the given shape is, e.g., ``(m, n, k)``, then</span>
<span class="sd">      ``m * n * k`` samples are drawn.  Default is None, in which case a</span>
<span class="sd">      single value is returned.</span>
<span class="sd">  dtype : dtype, optional</span>
<span class="sd">      Desired dtype of the result. Byteorder must be native.</span>
<span class="sd">      The default value is int.</span>

<span class="sd">  Returns</span>
<span class="sd">  -------</span>
<span class="sd">  out : int or ndarray of ints</span>
<span class="sd">      `size`-shaped array of random integers from the appropriate</span>
<span class="sd">      distribution, or a single such random int if `size` not provided.</span>

<span class="sd">  See Also</span>
<span class="sd">  --------</span>
<span class="sd">  random_integers : similar to `randint`, only for the closed</span>
<span class="sd">      interval [`low`, `high`], and 1 is the lowest value if `high` is</span>
<span class="sd">      omitted.</span>
<span class="sd">  Generator.integers: which should be used for new code.</span>

<span class="sd">  Examples</span>
<span class="sd">  --------</span>
<span class="sd">  &gt;&gt;&gt; bm.random.randint(2, size=10)</span>
<span class="sd">  array([1, 0, 0, 0, 1, 1, 0, 0, 1, 0]) # random</span>
<span class="sd">  &gt;&gt;&gt; bm.random.randint(1, size=10)</span>
<span class="sd">  array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0])</span>

<span class="sd">  Generate a 2 x 4 array of ints between 0 and 4, inclusive:</span>

<span class="sd">  &gt;&gt;&gt; bm.random.randint(5, size=(2, 4))</span>
<span class="sd">  array([[4, 0, 2, 1], # random</span>
<span class="sd">         [3, 2, 2, 0]])</span>

<span class="sd">  Generate a 1 x 3 array with 3 different upper bounds</span>

<span class="sd">  &gt;&gt;&gt; bm.random.randint(1, [3, 5, 10])</span>
<span class="sd">  array([2, 2, 9]) # random</span>

<span class="sd">  Generate a 1 by 3 array with 3 different lower bounds</span>

<span class="sd">  &gt;&gt;&gt; bm.random.randint([1, 5, 7], 10)</span>
<span class="sd">  array([9, 8, 7]) # random</span>

<span class="sd">  Generate a 2 by 4 array using broadcasting with dtype of uint8</span>

<span class="sd">  &gt;&gt;&gt; bm.random.randint([1, 3, 5, 7], [[10], [20]], dtype=np.uint8)</span>
<span class="sd">  array([[ 8,  6,  9,  7], # random</span>
<span class="sd">         [ 1, 16,  9, 12]], dtype=uint8)</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">high</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>



<div class="viewcode-block" id="random_integers"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.random_integers.html#brainpy.math.random.random_integers">[docs]</a><span class="k">def</span> <span class="nf">random_integers</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Random integers of type `np.int_` between `low` and `high`, inclusive.</span>

<span class="sd">  Return random integers of type `np.int_` from the &quot;discrete uniform&quot;</span>
<span class="sd">  distribution in the closed interval [`low`, `high`].  If `high` is</span>
<span class="sd">  None (the default), then results are from [1, `low`]. The `np.int_`</span>
<span class="sd">  type translates to the C long integer type and its precision</span>
<span class="sd">  is platform dependent.</span>

<span class="sd">  Parameters</span>
<span class="sd">  ----------</span>
<span class="sd">  low : int</span>
<span class="sd">      Lowest (signed) integer to be drawn from the distribution (unless</span>
<span class="sd">      ``high=None``, in which case this parameter is the *highest* such</span>
<span class="sd">      integer).</span>
<span class="sd">  high : int, optional</span>
<span class="sd">      If provided, the largest (signed) integer to be drawn from the</span>
<span class="sd">      distribution (see above for behavior if ``high=None``).</span>
<span class="sd">  size : int or tuple of ints, optional</span>
<span class="sd">      Output shape.  If the given shape is, e.g., ``(m, n, k)``, then</span>
<span class="sd">      ``m * n * k`` samples are drawn.  Default is None, in which case a</span>
<span class="sd">      single value is returned.</span>

<span class="sd">  Returns</span>
<span class="sd">  -------</span>
<span class="sd">  out : int or ndarray of ints</span>
<span class="sd">      `size`-shaped array of random integers from the appropriate</span>
<span class="sd">      distribution, or a single such random int if `size` not provided.</span>

<span class="sd">  See Also</span>
<span class="sd">  --------</span>
<span class="sd">  randint : Similar to `random_integers`, only for the half-open</span>
<span class="sd">      interval [`low`, `high`), and 0 is the lowest value if `high` is</span>
<span class="sd">      omitted.</span>

<span class="sd">  Notes</span>
<span class="sd">  -----</span>
<span class="sd">  To sample from N evenly spaced floating-point numbers between a and b,</span>
<span class="sd">  use::</span>

<span class="sd">    a + (b - a) * (bm.random.random_integers(N) - 1) / (N - 1.)</span>

<span class="sd">  Examples</span>
<span class="sd">  --------</span>
<span class="sd">  &gt;&gt;&gt; bm.random.random_integers(5)</span>
<span class="sd">  4 # random</span>
<span class="sd">  &gt;&gt;&gt; type(bm.random.random_integers(5))</span>
<span class="sd">  &lt;class &#39;numpy.int64&#39;&gt;</span>
<span class="sd">  &gt;&gt;&gt; bm.random.random_integers(5, size=(3,2))</span>
<span class="sd">  array([[5, 4], # random</span>
<span class="sd">         [3, 3],</span>
<span class="sd">         [4, 5]])</span>

<span class="sd">  Choose five random numbers from the set of five evenly-spaced</span>
<span class="sd">  numbers between 0 and 2.5, inclusive (*i.e.*, from the set</span>
<span class="sd">  :math:`{0, 5/8, 10/8, 15/8, 20/8}`):</span>

<span class="sd">  &gt;&gt;&gt; 2.5 * (bm.random.random_integers(5, size=(5,)) - 1) / 4.</span>
<span class="sd">  array([ 0.625,  1.25 ,  0.625,  0.625,  2.5  ]) # random</span>

<span class="sd">  Roll two six sided dice 1000 times and sum the results:</span>

<span class="sd">  &gt;&gt;&gt; d1 = bm.random.random_integers(1, 6, 1000)</span>
<span class="sd">  &gt;&gt;&gt; d2 = bm.random.random_integers(1, 6, 1000)</span>
<span class="sd">  &gt;&gt;&gt; dsums = d1 + d2</span>

<span class="sd">  Display results as a histogram:</span>

<span class="sd">  &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
<span class="sd">  &gt;&gt;&gt; count, bins, ignored = plt.hist(dsums, 11, density=True)</span>
<span class="sd">  &gt;&gt;&gt; plt.show()</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">random_integers</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">high</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>




<div class="viewcode-block" id="randn"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.randn.html#brainpy.math.random.randn">[docs]</a><span class="k">def</span> <span class="nf">randn</span><span class="p">(</span><span class="o">*</span><span class="n">dn</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Return a sample (or samples) from the &quot;standard normal&quot; distribution.</span>

<span class="sd">  .. note::</span>
<span class="sd">      This is a convenience function for users porting code from Matlab,</span>
<span class="sd">      and wraps `standard_normal`. That function takes a</span>
<span class="sd">      tuple to specify the size of the output, which is consistent with</span>
<span class="sd">      other NumPy functions like `numpy.zeros` and `numpy.ones`.</span>

<span class="sd">  .. note::</span>
<span class="sd">      New code should use the ``standard_normal`` method of a ``default_rng()``</span>
<span class="sd">      instance instead; please see the :ref:`random-quick-start`.</span>

<span class="sd">  If positive int_like arguments are provided, `randn` generates an array</span>
<span class="sd">  of shape ``(d0, d1, ..., dn)``, filled</span>
<span class="sd">  with random floats sampled from a univariate &quot;normal&quot; (Gaussian)</span>
<span class="sd">  distribution of mean 0 and variance 1. A single float randomly sampled</span>
<span class="sd">  from the distribution is returned if no argument is provided.</span>

<span class="sd">  Parameters</span>
<span class="sd">  ----------</span>
<span class="sd">  d0, d1, ..., dn : int, optional</span>
<span class="sd">      The dimensions of the returned array, must be non-negative.</span>
<span class="sd">      If no argument is given a single Python float is returned.</span>

<span class="sd">  Returns</span>
<span class="sd">  -------</span>
<span class="sd">  Z : ndarray or float</span>
<span class="sd">      A ``(d0, d1, ..., dn)``-shaped array of floating-point samples from</span>
<span class="sd">      the standard normal distribution, or a single such float if</span>
<span class="sd">      no parameters were supplied.</span>

<span class="sd">  See Also</span>
<span class="sd">  --------</span>
<span class="sd">  standard_normal : Similar, but takes a tuple as its argument.</span>
<span class="sd">  normal : Also accepts mu and sigma arguments.</span>
<span class="sd">  random.Generator.standard_normal: which should be used for new code.</span>

<span class="sd">  Notes</span>
<span class="sd">  -----</span>
<span class="sd">  For random samples from :math:`N(\mu, \sigma^2)`, use:</span>

<span class="sd">  ``sigma * bm.random.randn(...) + mu``</span>

<span class="sd">  Examples</span>
<span class="sd">  --------</span>
<span class="sd">  &gt;&gt;&gt; bm.random.randn()</span>
<span class="sd">  2.1923875335537315  # random</span>

<span class="sd">  Two-by-four array of samples from N(3, 6.25):</span>

<span class="sd">  &gt;&gt;&gt; 3 + 2.5 * bm.random.randn(2, 4)</span>
<span class="sd">  array([[-4.49401501,  4.00950034, -1.81814867,  7.29718677],   # random</span>
<span class="sd">         [ 0.39924804,  4.68456316,  4.99394529,  4.84057254]])  # random</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="o">*</span><span class="n">dn</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>




<div class="viewcode-block" id="random"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.random.html#brainpy.math.random.random">[docs]</a><span class="k">def</span> <span class="nf">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Return random floats in the half-open interval [0.0, 1.0). Alias for</span>
<span class="sd">  `random_sample` to ease forward-porting to the new random API.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>



<div class="viewcode-block" id="random_sample"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.random_sample.html#brainpy.math.random.random_sample">[docs]</a><span class="k">def</span> <span class="nf">random_sample</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Return random floats in the half-open interval [0.0, 1.0).</span>

<span class="sd">  Results are from the &quot;continuous uniform&quot; distribution over the</span>
<span class="sd">  stated interval.  To sample :math:`Unif[a, b), b &gt; a` multiply</span>
<span class="sd">  the output of `random_sample` by `(b-a)` and add `a`::</span>

<span class="sd">    (b - a) * random_sample() + a</span>

<span class="sd">  .. note::</span>
<span class="sd">      New code should use the ``random`` method of a ``default_rng()``</span>
<span class="sd">      instance instead; please see the :ref:`random-quick-start`.</span>

<span class="sd">  Parameters</span>
<span class="sd">  ----------</span>
<span class="sd">  size : int or tuple of ints, optional</span>
<span class="sd">      Output shape.  If the given shape is, e.g., ``(m, n, k)``, then</span>
<span class="sd">      ``m * n * k`` samples are drawn.  Default is None, in which case a</span>
<span class="sd">      single value is returned.</span>

<span class="sd">  Returns</span>
<span class="sd">  -------</span>
<span class="sd">  out : float or ndarray of floats</span>
<span class="sd">      Array of random floats of shape `size` (unless ``size=None``, in which</span>
<span class="sd">      case a single float is returned).</span>

<span class="sd">  See Also</span>
<span class="sd">  --------</span>
<span class="sd">  Generator.random: which should be used for new code.</span>

<span class="sd">  Examples</span>
<span class="sd">  --------</span>
<span class="sd">  &gt;&gt;&gt; brainpy.math.random.random_sample()</span>
<span class="sd">  0.47108547995356098 # random</span>
<span class="sd">  &gt;&gt;&gt; type(brainpy.math.random.random_sample())</span>
<span class="sd">  &lt;class &#39;float&#39;&gt;</span>
<span class="sd">  &gt;&gt;&gt; brainpy.math.random.random_sample((5,))</span>
<span class="sd">  array([ 0.30220482,  0.86820401,  0.1654503 ,  0.11659149,  0.54323428]) # random</span>

<span class="sd">  Three-by-two array of random numbers from [-5, 0):</span>

<span class="sd">  &gt;&gt;&gt; 5 * brainpy.math.random.random_sample((3, 2)) - 5</span>
<span class="sd">  array([[-3.99149989, -0.52338984], # random</span>
<span class="sd">         [-2.99091858, -0.79479508],</span>
<span class="sd">         [-1.23204345, -1.75224494]])</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">random_sample</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<div class="viewcode-block" id="ranf"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.ranf.html#brainpy.math.random.ranf">[docs]</a><span class="k">def</span> <span class="nf">ranf</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  This is an alias of `random_sample`. See `random_sample`  for the complete</span>
<span class="sd">      documentation.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">ranf</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<div class="viewcode-block" id="sample"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.sample.html#brainpy.math.random.sample">[docs]</a><span class="k">def</span> <span class="nf">sample</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  This is an alias of `random_sample`. See `random_sample`  for the complete</span>
<span class="sd">      documentation.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<div class="viewcode-block" id="choice"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.choice.html#brainpy.math.random.choice">[docs]</a><span class="k">def</span> <span class="nf">choice</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Generates a random sample from a given 1-D array</span>

<span class="sd">  Parameters</span>
<span class="sd">  ----------</span>
<span class="sd">  a : 1-D array-like or int</span>
<span class="sd">      If an ndarray, a random sample is generated from its elements.</span>
<span class="sd">      If an int, the random sample is generated as if it were ``np.arange(a)``</span>
<span class="sd">  size : int or tuple of ints, optional</span>
<span class="sd">      Output shape.  If the given shape is, e.g., ``(m, n, k)``, then</span>
<span class="sd">      ``m * n * k`` samples are drawn.  Default is None, in which case a</span>
<span class="sd">      single value is returned.</span>
<span class="sd">  replace : boolean, optional</span>
<span class="sd">      Whether the sample is with or without replacement. Default is True,</span>
<span class="sd">      meaning that a value of ``a`` can be selected multiple times.</span>
<span class="sd">  p : 1-D array-like, optional</span>
<span class="sd">      The probabilities associated with each entry in a.</span>
<span class="sd">      If not given, the sample assumes a uniform distribution over all</span>
<span class="sd">      entries in ``a``.</span>

<span class="sd">  Returns</span>
<span class="sd">  -------</span>
<span class="sd">  samples : single item or ndarray</span>
<span class="sd">      The generated random samples</span>

<span class="sd">  Raises</span>
<span class="sd">  ------</span>
<span class="sd">  ValueError</span>
<span class="sd">      If a is an int and less than zero, if a or p are not 1-dimensional,</span>
<span class="sd">      if a is an array-like of size 0, if p is not a vector of</span>
<span class="sd">      probabilities, if a and p have different lengths, or if</span>
<span class="sd">      replace=False and the sample size is greater than the population</span>
<span class="sd">      size</span>

<span class="sd">  See Also</span>
<span class="sd">  --------</span>
<span class="sd">  randint, shuffle, permutation</span>
<span class="sd">  Generator.choice: which should be used in new code</span>

<span class="sd">  Notes</span>
<span class="sd">  -----</span>
<span class="sd">  Setting user-specified probabilities through ``p`` uses a more general but less</span>
<span class="sd">  efficient sampler than the default. The general sampler produces a different sample</span>
<span class="sd">  than the optimized sampler even if each element of ``p`` is 1 / len(a).</span>

<span class="sd">  Sampling random rows from a 2-D array is not possible with this function,</span>
<span class="sd">  but is possible with `Generator.choice` through its ``axis`` keyword.</span>

<span class="sd">  Examples</span>
<span class="sd">  --------</span>
<span class="sd">  Generate a uniform random sample from np.arange(5) of size 3:</span>

<span class="sd">  &gt;&gt;&gt; brainpy.math.random.choice(5, 3)</span>
<span class="sd">  array([0, 3, 4]) # random</span>
<span class="sd">  &gt;&gt;&gt; #This is equivalent to brainpy.math.random.randint(0,5,3)</span>

<span class="sd">  Generate a non-uniform random sample from np.arange(5) of size 3:</span>

<span class="sd">  &gt;&gt;&gt; brainpy.math.random.choice(5, 3, p=[0.1, 0, 0.3, 0.6, 0])</span>
<span class="sd">  array([3, 3, 0]) # random</span>

<span class="sd">  Generate a uniform random sample from np.arange(5) of size 3 without</span>
<span class="sd">  replacement:</span>

<span class="sd">  &gt;&gt;&gt; brainpy.math.random.choice(5, 3, replace=False)</span>
<span class="sd">  array([3,1,0]) # random</span>
<span class="sd">  &gt;&gt;&gt; #This is equivalent to brainpy.math.random.permutation(np.arange(5))[:3]</span>

<span class="sd">  Generate a non-uniform random sample from np.arange(5) of size</span>
<span class="sd">  3 without replacement:</span>

<span class="sd">  &gt;&gt;&gt; brainpy.math.random.choice(5, 3, replace=False, p=[0.1, 0, 0.3, 0.6, 0])</span>
<span class="sd">  array([2, 3, 0]) # random</span>

<span class="sd">  Any of the above can be repeated with an arbitrary array-like</span>
<span class="sd">  instead of just integers. For instance:</span>

<span class="sd">  &gt;&gt;&gt; aa_milne_arr = [&#39;pooh&#39;, &#39;rabbit&#39;, &#39;piglet&#39;, &#39;Christopher&#39;]</span>
<span class="sd">  &gt;&gt;&gt; brainpy.math.random.choice(aa_milne_arr, 5, p=[0.5, 0.1, 0.1, 0.3])</span>
<span class="sd">  array([&#39;pooh&#39;, &#39;pooh&#39;, &#39;pooh&#39;, &#39;Christopher&#39;, &#39;piglet&#39;], # random</span>
<span class="sd">        dtype=&#39;&lt;U11&#39;)</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">a</span> <span class="o">=</span> <span class="n">_as_jax_array</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="n">replace</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<div class="viewcode-block" id="permutation"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.permutation.html#brainpy.math.random.permutation">[docs]</a><span class="k">def</span> <span class="nf">permutation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">independent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Randomly permute a sequence, or return a permuted range.</span>

<span class="sd">  If `x` is a multi-dimensional array, it is only shuffled along its</span>
<span class="sd">  first index.</span>

<span class="sd">  Parameters</span>
<span class="sd">  ----------</span>
<span class="sd">  x : int or array_like</span>
<span class="sd">      If `x` is an integer, randomly permute ``np.arange(x)``.</span>
<span class="sd">      If `x` is an array, make a copy and shuffle the elements</span>
<span class="sd">      randomly.</span>

<span class="sd">  Returns</span>
<span class="sd">  -------</span>
<span class="sd">  out : ndarray</span>
<span class="sd">      Permuted sequence or array range.</span>

<span class="sd">  See Also</span>
<span class="sd">  --------</span>
<span class="sd">  random.Generator.permutation: which should be used for new code.</span>

<span class="sd">  Examples</span>
<span class="sd">  --------</span>
<span class="sd">  &gt;&gt;&gt; brainpy.math.random.permutation(10)</span>
<span class="sd">  array([1, 7, 4, 3, 0, 9, 2, 5, 8, 6]) # random</span>

<span class="sd">  &gt;&gt;&gt; brainpy.math.random.permutation([1, 4, 9, 12, 15])</span>
<span class="sd">  array([15,  1,  9,  4, 12]) # random</span>

<span class="sd">  &gt;&gt;&gt; arr = np.arange(9).reshape((3, 3))</span>
<span class="sd">  &gt;&gt;&gt; brainpy.math.random.permutation(arr)</span>
<span class="sd">  array([[6, 7, 8], # random</span>
<span class="sd">         [0, 1, 2],</span>
<span class="sd">         [3, 4, 5]])</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">independent</span><span class="o">=</span><span class="n">independent</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<div class="viewcode-block" id="shuffle"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.shuffle.html#brainpy.math.random.shuffle">[docs]</a><span class="k">def</span> <span class="nf">shuffle</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Modify a sequence in-place by shuffling its contents.</span>

<span class="sd">  This function only shuffles the array along the first axis of a</span>
<span class="sd">  multi-dimensional array. The order of sub-arrays is changed but</span>
<span class="sd">  their contents remains the same.</span>

<span class="sd">  Parameters</span>
<span class="sd">  ----------</span>
<span class="sd">  x : ndarray or MutableSequence</span>
<span class="sd">      The array, list or mutable sequence to be shuffled.</span>

<span class="sd">  Returns</span>
<span class="sd">  -------</span>
<span class="sd">  None</span>

<span class="sd">  See Also</span>
<span class="sd">  --------</span>
<span class="sd">  random.Generator.shuffle: which should be used for new code.</span>

<span class="sd">  Examples</span>
<span class="sd">  --------</span>
<span class="sd">  &gt;&gt;&gt; arr = np.arange(10)</span>
<span class="sd">  &gt;&gt;&gt; brainpy.math.random.shuffle(arr)</span>
<span class="sd">  &gt;&gt;&gt; arr</span>
<span class="sd">  [1 7 5 2 9 4 3 6 0 8] # random</span>

<span class="sd">  Multi-dimensional arrays are only shuffled along the first axis:</span>

<span class="sd">  &gt;&gt;&gt; arr = np.arange(9).reshape((3, 3))</span>
<span class="sd">  &gt;&gt;&gt; brainpy.math.random.shuffle(arr)</span>
<span class="sd">  &gt;&gt;&gt; arr</span>
<span class="sd">  array([[3, 4, 5], # random</span>
<span class="sd">         [6, 7, 8],</span>
<span class="sd">         [0, 1, 2]])</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">DEFAULT</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<div class="viewcode-block" id="beta"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.beta.html#brainpy.math.random.beta">[docs]</a><span class="k">def</span> <span class="nf">beta</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Draw samples from a Beta distribution.</span>

<span class="sd">  The Beta distribution is a special case of the Dirichlet distribution,</span>
<span class="sd">  and is related to the Gamma distribution.  It has the probability</span>
<span class="sd">  distribution function</span>

<span class="sd">  .. math:: f(x; a,b) = \frac{1}{B(\alpha, \beta)} x^{\alpha - 1}</span>
<span class="sd">                                                   (1 - x)^{\beta - 1},</span>

<span class="sd">  where the normalization, B, is the beta function,</span>

<span class="sd">  .. math:: B(\alpha, \beta) = \int_0^1 t^{\alpha - 1}</span>
<span class="sd">                               (1 - t)^{\beta - 1} dt.</span>

<span class="sd">  It is often seen in Bayesian inference and order statistics.</span>

<span class="sd">  Parameters</span>
<span class="sd">  ----------</span>
<span class="sd">  a : float or array_like of floats</span>
<span class="sd">      Alpha, positive (&gt;0).</span>
<span class="sd">  b : float or array_like of floats</span>
<span class="sd">      Beta, positive (&gt;0).</span>
<span class="sd">  size : int or tuple of ints, optional</span>
<span class="sd">      Output shape.  If the given shape is, e.g., ``(m, n, k)``, then</span>
<span class="sd">      ``m * n * k`` samples are drawn.  If size is ``None`` (default),</span>
<span class="sd">      a single value is returned if ``a`` and ``b`` are both scalars.</span>
<span class="sd">      Otherwise, ``np.broadcast(a, b).size`` samples are drawn.</span>

<span class="sd">  Returns</span>
<span class="sd">  -------</span>
<span class="sd">  out : ndarray or scalar</span>
<span class="sd">      Drawn samples from the parameterized beta distribution.</span>

<span class="sd">  See Also</span>
<span class="sd">  --------</span>
<span class="sd">  random.Generator.beta: which should be used for new code.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<span class="c1"># @wraps(np.random.exponential)</span>
<div class="viewcode-block" id="exponential"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.exponential.html#brainpy.math.random.exponential">[docs]</a><span class="k">def</span> <span class="nf">exponential</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<span class="c1"># @wraps(np.random.gamma)</span>
<div class="viewcode-block" id="gamma"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.gamma.html#brainpy.math.random.gamma">[docs]</a><span class="k">def</span> <span class="nf">gamma</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<span class="c1"># @wraps(np.random.gumbel)</span>
<div class="viewcode-block" id="gumbel"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.gumbel.html#brainpy.math.random.gumbel">[docs]</a><span class="k">def</span> <span class="nf">gumbel</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">gumbel</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<span class="c1"># @wraps(np.random.laplace)</span>
<div class="viewcode-block" id="laplace"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.laplace.html#brainpy.math.random.laplace">[docs]</a><span class="k">def</span> <span class="nf">laplace</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<span class="c1"># @wraps(np.random.logistic)</span>
<div class="viewcode-block" id="logistic"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.logistic.html#brainpy.math.random.logistic">[docs]</a><span class="k">def</span> <span class="nf">logistic</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">logistic</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<span class="c1"># @wraps(np.random.normal)</span>
<div class="viewcode-block" id="normal"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.normal.html#brainpy.math.random.normal">[docs]</a><span class="k">def</span> <span class="nf">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<span class="c1"># @wraps(np.random.pareto)</span>
<div class="viewcode-block" id="pareto"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.pareto.html#brainpy.math.random.pareto">[docs]</a><span class="k">def</span> <span class="nf">pareto</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">pareto</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<span class="c1"># @wraps(np.random.poisson)</span>
<div class="viewcode-block" id="poisson"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.poisson.html#brainpy.math.random.poisson">[docs]</a><span class="k">def</span> <span class="nf">poisson</span><span class="p">(</span><span class="n">lam</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<span class="c1"># @wraps(np.random.standard_cauchy)</span>
<div class="viewcode-block" id="standard_cauchy"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.standard_cauchy.html#brainpy.math.random.standard_cauchy">[docs]</a><span class="k">def</span> <span class="nf">standard_cauchy</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">standard_cauchy</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<span class="c1"># @wraps(np.random.standard_exponential)</span>
<div class="viewcode-block" id="standard_exponential"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.standard_exponential.html#brainpy.math.random.standard_exponential">[docs]</a><span class="k">def</span> <span class="nf">standard_exponential</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">standard_exponential</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<span class="c1"># @wraps(np.random.standard_gamma)</span>
<div class="viewcode-block" id="standard_gamma"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.standard_gamma.html#brainpy.math.random.standard_gamma">[docs]</a><span class="k">def</span> <span class="nf">standard_gamma</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">standard_gamma</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<span class="c1"># @wraps(np.random.standard_normal)</span>
<div class="viewcode-block" id="standard_normal"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.standard_normal.html#brainpy.math.random.standard_normal">[docs]</a><span class="k">def</span> <span class="nf">standard_normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<span class="c1"># @wraps(np.random.standard_t)</span>
<div class="viewcode-block" id="standard_t"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.standard_t.html#brainpy.math.random.standard_t">[docs]</a><span class="k">def</span> <span class="nf">standard_t</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">standard_t</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<span class="c1"># @wraps(np.random.uniform)</span>
<div class="viewcode-block" id="uniform"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.uniform.html#brainpy.math.random.uniform">[docs]</a><span class="k">def</span> <span class="nf">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<div class="viewcode-block" id="truncated_normal"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.truncated_normal.html#brainpy.math.random.truncated_normal">[docs]</a><span class="k">def</span> <span class="nf">truncated_normal</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;Sample truncated standard normal random values with given shape and dtype.</span>

<span class="sd">  Parameters</span>
<span class="sd">  ----------</span>
<span class="sd">  lower : float, ndarray</span>
<span class="sd">    A float or array of floats representing the lower bound for</span>
<span class="sd">    truncation. Must be broadcast-compatible with ``upper``.</span>
<span class="sd">  upper : float, ndarray</span>
<span class="sd">    A float or array of floats representing the  upper bound for</span>
<span class="sd">    truncation. Must be broadcast-compatible with ``lower``.</span>
<span class="sd">  size : optional, list of int, tuple of int</span>
<span class="sd">    A tuple of nonnegative integers specifying the result</span>
<span class="sd">    shape. Must be broadcast-compatible with ``lower`` and ``upper``. The</span>
<span class="sd">    default (None) produces a result shape by broadcasting ``lower`` and</span>
<span class="sd">    ``upper``.</span>
<span class="sd">  scale : float, ndarray</span>
<span class="sd">    Standard deviation (spread or &quot;width&quot;) of the distribution. Must be</span>
<span class="sd">    non-negative.</span>

<span class="sd">  Returns</span>
<span class="sd">  -------</span>
<span class="sd">  out : Array</span>
<span class="sd">    A random array with the specified dtype and shape given by ``shape`` if</span>
<span class="sd">    ``shape`` is not None, or else by broadcasting ``lower`` and ``upper``.</span>
<span class="sd">    Returns values in the open interval ``(lower, upper)``.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">truncated_normal</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<div class="viewcode-block" id="bernoulli"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.bernoulli.html#brainpy.math.random.bernoulli">[docs]</a><span class="k">def</span> <span class="nf">bernoulli</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;Sample Bernoulli random values with given shape and mean.</span>

<span class="sd">  Parameters</span>
<span class="sd">  ----------</span>
<span class="sd">  p: float, array_like, optional</span>
<span class="sd">    A float or array of floats for the mean of the random</span>
<span class="sd">    variables. Must be broadcast-compatible with ``shape`` and the values</span>
<span class="sd">    should be within [0, 1]. Default 0.5.</span>
<span class="sd">  size: optional, tuple of int, int</span>
<span class="sd">    A tuple of nonnegative integers representing the result</span>
<span class="sd">    shape. Must be broadcast-compatible with ``p.shape``. The default (None)</span>
<span class="sd">    produces a result shape equal to ``p.shape``.</span>

<span class="sd">  Returns</span>
<span class="sd">  -------</span>
<span class="sd">  out: array_like</span>
<span class="sd">    A random array with boolean dtype and shape given by ``shape`` if ``shape``</span>
<span class="sd">    is not None, or else ``p.shape``.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">bernoulli</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<span class="c1"># @wraps(np.random.lognormal)</span>
<div class="viewcode-block" id="lognormal"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.lognormal.html#brainpy.math.random.lognormal">[docs]</a><span class="k">def</span> <span class="nf">lognormal</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">lognormal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<span class="c1"># @wraps(np.random.binomial)</span>
<div class="viewcode-block" id="binomial"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.binomial.html#brainpy.math.random.binomial">[docs]</a><span class="k">def</span> <span class="nf">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<span class="c1"># @wraps(np.random.chisquare)</span>
<div class="viewcode-block" id="chisquare"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.chisquare.html#brainpy.math.random.chisquare">[docs]</a><span class="k">def</span> <span class="nf">chisquare</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">chisquare</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<span class="c1"># @wraps(np.random.dirichlet)</span>
<div class="viewcode-block" id="dirichlet"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.dirichlet.html#brainpy.math.random.dirichlet">[docs]</a><span class="k">def</span> <span class="nf">dirichlet</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">dirichlet</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<span class="c1"># @wraps(np.random.geometric)</span>
<div class="viewcode-block" id="geometric"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.geometric.html#brainpy.math.random.geometric">[docs]</a><span class="k">def</span> <span class="nf">geometric</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">geometric</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<span class="c1"># @wraps(np.random.f)</span>
<div class="viewcode-block" id="f"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.f.html#brainpy.math.random.f">[docs]</a><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">dfnum</span><span class="p">,</span> <span class="n">dfden</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="n">dfnum</span><span class="p">,</span> <span class="n">dfden</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<span class="c1"># @wraps(np.random.hypergeometric)</span>
<div class="viewcode-block" id="hypergeometric"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.hypergeometric.html#brainpy.math.random.hypergeometric">[docs]</a><span class="k">def</span> <span class="nf">hypergeometric</span><span class="p">(</span><span class="n">ngood</span><span class="p">,</span> <span class="n">nbad</span><span class="p">,</span> <span class="n">nsample</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">hypergeometric</span><span class="p">(</span><span class="n">ngood</span><span class="p">,</span> <span class="n">nbad</span><span class="p">,</span> <span class="n">nsample</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<span class="c1"># @wraps(np.random.logseries)</span>
<div class="viewcode-block" id="logseries"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.logseries.html#brainpy.math.random.logseries">[docs]</a><span class="k">def</span> <span class="nf">logseries</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">logseries</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<span class="c1"># @wraps(np.random.multinomial)</span>
<div class="viewcode-block" id="multinomial"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.multinomial.html#brainpy.math.random.multinomial">[docs]</a><span class="k">def</span> <span class="nf">multinomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">pvals</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">multinomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">pvals</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<span class="c1"># @wraps(np.random.multivariate_normal)</span>
<div class="viewcode-block" id="multivariate_normal"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.multivariate_normal.html#brainpy.math.random.multivariate_normal">[docs]</a><span class="k">def</span> <span class="nf">multivariate_normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">cov</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;cholesky&#39;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">cov</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<span class="c1"># @wraps(np.random.negative_binomial)</span>
<div class="viewcode-block" id="negative_binomial"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.negative_binomial.html#brainpy.math.random.negative_binomial">[docs]</a><span class="k">def</span> <span class="nf">negative_binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">negative_binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<span class="c1"># @wraps(np.random.noncentral_chisquare)</span>
<div class="viewcode-block" id="noncentral_chisquare"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.noncentral_chisquare.html#brainpy.math.random.noncentral_chisquare">[docs]</a><span class="k">def</span> <span class="nf">noncentral_chisquare</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">nonc</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">noncentral_chisquare</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">nonc</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<span class="c1"># @wraps(np.random.noncentral_f)</span>
<div class="viewcode-block" id="noncentral_f"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.noncentral_f.html#brainpy.math.random.noncentral_f">[docs]</a><span class="k">def</span> <span class="nf">noncentral_f</span><span class="p">(</span><span class="n">dfnum</span><span class="p">,</span> <span class="n">dfden</span><span class="p">,</span> <span class="n">nonc</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">noncentral_f</span><span class="p">(</span><span class="n">dfnum</span><span class="p">,</span> <span class="n">dfden</span><span class="p">,</span> <span class="n">nonc</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<span class="c1"># @wraps(np.random.power)</span>
<div class="viewcode-block" id="power"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.power.html#brainpy.math.random.power">[docs]</a><span class="k">def</span> <span class="nf">power</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<span class="c1"># @wraps(np.random.rayleigh)</span>
<div class="viewcode-block" id="rayleigh"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.rayleigh.html#brainpy.math.random.rayleigh">[docs]</a><span class="k">def</span> <span class="nf">rayleigh</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">rayleigh</span><span class="p">(</span><span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<span class="c1"># @wraps(np.random.triangular)</span>
<div class="viewcode-block" id="triangular"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.triangular.html#brainpy.math.random.triangular">[docs]</a><span class="k">def</span> <span class="nf">triangular</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">triangular</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<span class="c1"># @wraps(np.random.vonmises)</span>
<div class="viewcode-block" id="vonmises"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.vonmises.html#brainpy.math.random.vonmises">[docs]</a><span class="k">def</span> <span class="nf">vonmises</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">kappa</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">vonmises</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">kappa</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<span class="c1"># @wraps(np.random.wald)</span>
<div class="viewcode-block" id="wald"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.wald.html#brainpy.math.random.wald">[docs]</a><span class="k">def</span> <span class="nf">wald</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">wald</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<div class="viewcode-block" id="weibull"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.weibull.html#brainpy.math.random.weibull">[docs]</a><span class="k">def</span> <span class="nf">weibull</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Draw samples from a Weibull distribution.</span>
<span class="sd">    </span>
<span class="sd">  Draw samples from a 1-parameter Weibull distribution with the given</span>
<span class="sd">  shape parameter `a`.</span>

<span class="sd">  .. math:: X = (-ln(U))^{1/a}</span>

<span class="sd">  Here, U is drawn from the uniform distribution over (0,1].</span>

<span class="sd">  The more common 2-parameter Weibull, including a scale parameter</span>
<span class="sd">  :math:`\lambda` is just :math:`X = \lambda(-ln(U))^{1/a}`.</span>

<span class="sd">  .. note::</span>
<span class="sd">      New code should use the ``weibull`` method of a ``default_rng()``</span>
<span class="sd">      instance instead; please see the :ref:`random-quick-start`.</span>

<span class="sd">  Parameters</span>
<span class="sd">  ----------</span>
<span class="sd">  a : float or array_like of floats</span>
<span class="sd">      Shape parameter of the distribution.  Must be nonnegative.</span>
<span class="sd">  size : int or tuple of ints, optional</span>
<span class="sd">      Output shape.  If the given shape is, e.g., ``(m, n, k)``, then</span>
<span class="sd">      ``m * n * k`` samples are drawn.  If size is ``None`` (default),</span>
<span class="sd">      a single value is returned if ``a`` is a scalar.  Otherwise,</span>
<span class="sd">      ``np.array(a).size`` samples are drawn.</span>

<span class="sd">  Returns</span>
<span class="sd">  -------</span>
<span class="sd">  out : ndarray or scalar</span>
<span class="sd">      Drawn samples from the parameterized Weibull distribution.</span>

<span class="sd">  See Also</span>
<span class="sd">  --------</span>
<span class="sd">  scipy.stats.weibull_max</span>
<span class="sd">  scipy.stats.weibull_min</span>
<span class="sd">  scipy.stats.genextreme</span>
<span class="sd">  gumbel</span>
<span class="sd">  random.Generator.weibull: which should be used for new code.</span>

<span class="sd">  Notes</span>
<span class="sd">  -----</span>
<span class="sd">  The Weibull (or Type III asymptotic extreme value distribution</span>
<span class="sd">  for smallest values, SEV Type III, or Rosin-Rammler</span>
<span class="sd">  distribution) is one of a class of Generalized Extreme Value</span>
<span class="sd">  (GEV) distributions used in modeling extreme value problems.</span>
<span class="sd">  This class includes the Gumbel and Frechet distributions.</span>

<span class="sd">  The probability density for the Weibull distribution is</span>

<span class="sd">  .. math:: p(x) = \frac{a}</span>
<span class="sd">                   {\lambda}(\frac{x}{\lambda})^{a-1}e^{-(x/\lambda)^a},</span>

<span class="sd">  where :math:`a` is the shape and :math:`\lambda` the scale.</span>

<span class="sd">  The function has its peak (the mode) at</span>
<span class="sd">  :math:`\lambda(\frac{a-1}{a})^{1/a}`.</span>

<span class="sd">  When ``a = 1``, the Weibull distribution reduces to the exponential</span>
<span class="sd">  distribution.</span>

<span class="sd">  References</span>
<span class="sd">  ----------</span>
<span class="sd">  .. [1] Waloddi Weibull, Royal Technical University, Stockholm,</span>
<span class="sd">         1939 &quot;A Statistical Theory Of The Strength Of Materials&quot;,</span>
<span class="sd">         Ingeniorsvetenskapsakademiens Handlingar Nr 151, 1939,</span>
<span class="sd">         Generalstabens Litografiska Anstalts Forlag, Stockholm.</span>
<span class="sd">  .. [2] Waloddi Weibull, &quot;A Statistical Distribution Function of</span>
<span class="sd">         Wide Applicability&quot;, Journal Of Applied Mechanics ASME Paper</span>
<span class="sd">         1951.</span>
<span class="sd">  .. [3] Wikipedia, &quot;Weibull distribution&quot;,</span>
<span class="sd">         https://en.wikipedia.org/wiki/Weibull_distribution</span>

<span class="sd">  Examples</span>
<span class="sd">  --------</span>
<span class="sd">  Draw samples from the distribution:</span>

<span class="sd">  &gt;&gt;&gt; a = 5. # shape</span>
<span class="sd">  &gt;&gt;&gt; s = brainpy.math.random.weibull(a, 1000)</span>

<span class="sd">  Display the histogram of the samples, along with</span>
<span class="sd">  the probability density function:</span>

<span class="sd">  &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
<span class="sd">  &gt;&gt;&gt; x = np.arange(1,100.)/50.</span>
<span class="sd">  &gt;&gt;&gt; def weib(x,n,a):</span>
<span class="sd">  ...     return (a / n) * (x / n)**(a - 1) * np.exp(-(x / n)**a)</span>

<span class="sd">  &gt;&gt;&gt; count, bins, ignored = plt.hist(brainpy.math.random.weibull(5.,1000))</span>
<span class="sd">  &gt;&gt;&gt; x = np.arange(1,100.)/50.</span>
<span class="sd">  &gt;&gt;&gt; scale = count.max()/weib(x, 1., 5.).max()</span>
<span class="sd">  &gt;&gt;&gt; plt.plot(x, weib(x, 1., 5.)*scale)</span>
<span class="sd">  &gt;&gt;&gt; plt.show()</span>

<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">weibull</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<div class="viewcode-block" id="weibull_min"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.weibull_min.html#brainpy.math.random.weibull_min">[docs]</a><span class="k">def</span> <span class="nf">weibull_min</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;Sample from a Weibull distribution.</span>

<span class="sd">  The scipy counterpart is `scipy.stats.weibull_min`.</span>

<span class="sd">  Args:</span>
<span class="sd">    scale: The scale parameter of the distribution.</span>
<span class="sd">    concentration: The concentration parameter of the distribution.</span>
<span class="sd">    shape: The shape added to the parameters loc and scale broadcastable shape.</span>
<span class="sd">    dtype: The type used for samples.</span>
<span class="sd">    key: a PRNG key or a seed.</span>

<span class="sd">  Returns:</span>
<span class="sd">    A jnp.array of samples.</span>

<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">weibull_min</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<div class="viewcode-block" id="zipf"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.zipf.html#brainpy.math.random.zipf">[docs]</a><span class="k">def</span> <span class="nf">zipf</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Draw samples from a Zipf distribution.</span>

<span class="sd">  Samples are drawn from a Zipf distribution with specified parameter</span>
<span class="sd">  `a` &gt; 1.</span>

<span class="sd">  The Zipf distribution (also known as the zeta distribution) is a</span>
<span class="sd">  discrete probability distribution that satisfies Zipf&#39;s law: the</span>
<span class="sd">  frequency of an item is inversely proportional to its rank in a</span>
<span class="sd">  frequency table.</span>

<span class="sd">  .. note::</span>
<span class="sd">      New code should use the ``zipf`` method of a ``default_rng()``</span>
<span class="sd">      instance instead; please see the :ref:`random-quick-start`.</span>

<span class="sd">  Parameters</span>
<span class="sd">  ----------</span>
<span class="sd">  a : float or array_like of floats</span>
<span class="sd">      Distribution parameter. Must be greater than 1.</span>
<span class="sd">  size : int or tuple of ints, optional</span>
<span class="sd">      Output shape.  If the given shape is, e.g., ``(m, n, k)``, then</span>
<span class="sd">      ``m * n * k`` samples are drawn.  If size is ``None`` (default),</span>
<span class="sd">      a single value is returned if ``a`` is a scalar. Otherwise,</span>
<span class="sd">      ``np.array(a).size`` samples are drawn.</span>

<span class="sd">  Returns</span>
<span class="sd">  -------</span>
<span class="sd">  out : ndarray or scalar</span>
<span class="sd">      Drawn samples from the parameterized Zipf distribution.</span>

<span class="sd">  See Also</span>
<span class="sd">  --------</span>
<span class="sd">  scipy.stats.zipf : probability density function, distribution, or</span>
<span class="sd">      cumulative density function, etc.</span>
<span class="sd">  random.Generator.zipf: which should be used for new code.</span>

<span class="sd">  Notes</span>
<span class="sd">  -----</span>
<span class="sd">  The probability density for the Zipf distribution is</span>

<span class="sd">  .. math:: p(k) = \frac{k^{-a}}{\zeta(a)},</span>

<span class="sd">  for integers :math:`k \geq 1`, where :math:`\zeta` is the Riemann Zeta</span>
<span class="sd">  function.</span>

<span class="sd">  It is named for the American linguist George Kingsley Zipf, who noted</span>
<span class="sd">  that the frequency of any word in a sample of a language is inversely</span>
<span class="sd">  proportional to its rank in the frequency table.</span>

<span class="sd">  References</span>
<span class="sd">  ----------</span>
<span class="sd">  .. [1] Zipf, G. K., &quot;Selected Studies of the Principle of Relative</span>
<span class="sd">         Frequency in Language,&quot; Cambridge, MA: Harvard Univ. Press,</span>
<span class="sd">         1932.</span>

<span class="sd">  Examples</span>
<span class="sd">  --------</span>
<span class="sd">  Draw samples from the distribution:</span>

<span class="sd">  &gt;&gt;&gt; a = 4.0</span>
<span class="sd">  &gt;&gt;&gt; n = 20000</span>
<span class="sd">  &gt;&gt;&gt; s = brainpy.math.random.zipf(a, n)</span>

<span class="sd">  Display the histogram of the samples, along with</span>
<span class="sd">  the expected histogram based on the probability</span>
<span class="sd">  density function:</span>

<span class="sd">  &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
<span class="sd">  &gt;&gt;&gt; from scipy.special import zeta  # doctest: +SKIP</span>

<span class="sd">  `bincount` provides a fast histogram for small integers.</span>

<span class="sd">  &gt;&gt;&gt; count = np.bincount(s)</span>
<span class="sd">  &gt;&gt;&gt; k = np.arange(1, s.max() + 1)</span>

<span class="sd">  &gt;&gt;&gt; plt.bar(k, count[1:], alpha=0.5, label=&#39;sample count&#39;)</span>
<span class="sd">  &gt;&gt;&gt; plt.plot(k, n*(k**-a)/zeta(a), &#39;k.-&#39;, alpha=0.5,</span>
<span class="sd">  ...          label=&#39;expected count&#39;)   # doctest: +SKIP</span>
<span class="sd">  &gt;&gt;&gt; plt.semilogy()</span>
<span class="sd">  &gt;&gt;&gt; plt.grid(alpha=0.4)</span>
<span class="sd">  &gt;&gt;&gt; plt.legend()</span>
<span class="sd">  &gt;&gt;&gt; plt.title(f&#39;Zipf sample, a={a}, size={n}&#39;)</span>
<span class="sd">  &gt;&gt;&gt; plt.show()</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">zipf</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<div class="viewcode-block" id="maxwell"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.maxwell.html#brainpy.math.random.maxwell">[docs]</a><span class="k">def</span> <span class="nf">maxwell</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;Sample from a one sided Maxwell distribution.</span>

<span class="sd">  The scipy counterpart is `scipy.stats.maxwell`.</span>

<span class="sd">  Args:</span>
<span class="sd">    key: a PRNG key.</span>
<span class="sd">    size: The shape of the returned samples.</span>
<span class="sd">    dtype: The type used for samples.</span>

<span class="sd">  Returns:</span>
<span class="sd">    A jnp.array of samples, of shape `shape`.</span>

<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">maxwell</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<div class="viewcode-block" id="t"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.t.html#brainpy.math.random.t">[docs]</a><span class="k">def</span> <span class="nf">t</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;Sample Students t random values.</span>

<span class="sd">  Parameters</span>
<span class="sd">  ----------</span>
<span class="sd">  df: float, array_like</span>
<span class="sd">    A float or array of floats broadcast-compatible with shape representing the parameter of the distribution.</span>
<span class="sd">  size: optional, int, tuple of int</span>
<span class="sd">    A tuple of non-negative integers specifying the result shape.</span>
<span class="sd">    Must be broadcast-compatible with `df`. The default (None) produces a result shape equal to `df.shape`.</span>

<span class="sd">  Returns</span>
<span class="sd">  -------</span>
<span class="sd">  out: array_like</span>
<span class="sd">    The sampled value.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">t</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<div class="viewcode-block" id="orthogonal"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.orthogonal.html#brainpy.math.random.orthogonal">[docs]</a><span class="k">def</span> <span class="nf">orthogonal</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;Sample uniformly from the orthogonal group `O(n)`.</span>

<span class="sd">  Parameters</span>
<span class="sd">  ----------</span>
<span class="sd">  n: int</span>
<span class="sd">     An integer indicating the resulting dimension.</span>
<span class="sd">  size: optional, int, tuple of int</span>
<span class="sd">    The batch dimensions of the result.</span>

<span class="sd">  Returns</span>
<span class="sd">  -------</span>
<span class="sd">  out: Array</span>
<span class="sd">    The sampled results.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">orthogonal</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<div class="viewcode-block" id="loggamma"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.loggamma.html#brainpy.math.random.loggamma">[docs]</a><span class="k">def</span> <span class="nf">loggamma</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;Sample log-gamma random values.</span>

<span class="sd">  Parameters</span>
<span class="sd">  ----------</span>
<span class="sd">  a: float, array_like</span>
<span class="sd">    A float or array of floats broadcast-compatible with shape representing the parameter of the distribution.</span>
<span class="sd">  size: optional, int, tuple of int</span>
<span class="sd">    A tuple of nonnegative integers specifying the result shape.</span>
<span class="sd">    Must be broadcast-compatible with `a`. The default (None) produces a result shape equal to `a.shape`.</span>

<span class="sd">  Returns</span>
<span class="sd">  -------</span>
<span class="sd">  out: array_like</span>
<span class="sd">    The sampled results.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">loggamma</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span></div>


<div class="viewcode-block" id="categorical"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.categorical.html#brainpy.math.random.categorical">[docs]</a><span class="k">def</span> <span class="nf">categorical</span><span class="p">(</span><span class="n">logits</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;Sample random values from categorical distributions.</span>

<span class="sd">  Args:</span>
<span class="sd">    logits: Unnormalized log probabilities of the categorical distribution(s) to sample from,</span>
<span class="sd">      so that `softmax(logits, axis)` gives the corresponding probabilities.</span>
<span class="sd">    axis: Axis along which logits belong to the same categorical distribution.</span>
<span class="sd">    shape: Optional, a tuple of nonnegative integers representing the result shape.</span>
<span class="sd">      Must be broadcast-compatible with ``np.delete(logits.shape, axis)``.</span>
<span class="sd">      The default (None) produces a result shape equal to ``np.delete(logits.shape, axis)``.</span>
<span class="sd">    key: a PRNG key used as the random key.</span>

<span class="sd">  Returns:</span>
<span class="sd">    A random array with int dtype and shape given by ``shape`` if ``shape``</span>
<span class="sd">    is not None, or else ``np.delete(logits.shape, axis)``.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">categorical</span><span class="p">(</span><span class="n">logits</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>



<div class="viewcode-block" id="rand_like"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.rand_like.html#brainpy.math.random.rand_like">[docs]</a><span class="k">def</span> <span class="nf">rand_like</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;Similar to ``rand_like`` in torch. </span>
<span class="sd">  </span>
<span class="sd">  Returns a tensor with the same size as input that is filled with random</span>
<span class="sd">  numbers from a uniform distribution on the interval ``[0, 1)``.</span>

<span class="sd">  Args:</span>
<span class="sd">    input:  the ``size`` of input will determine size of the output tensor.</span>
<span class="sd">    dtype:  the desired data type of returned Tensor. Default: if ``None``, defaults to the dtype of input.</span>
<span class="sd">    key: the seed or key for the random.</span>

<span class="sd">  Returns:</span>
<span class="sd">    The random data.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">rand_like</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>

<div class="viewcode-block" id="randn_like"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.randn_like.html#brainpy.math.random.randn_like">[docs]</a><span class="k">def</span> <span class="nf">randn_like</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;Similar to ``randn_like`` in torch. </span>
<span class="sd">  </span>
<span class="sd">  Returns a tensor with the same size as ``input`` that is filled with</span>
<span class="sd">  random numbers from a normal distribution with mean 0 and variance 1.</span>

<span class="sd">  Args:</span>
<span class="sd">    input:  the ``size`` of input will determine size of the output tensor.</span>
<span class="sd">    dtype:  the desired data type of returned Tensor. Default: if ``None``, defaults to the dtype of input.</span>
<span class="sd">    key: the seed or key for the random.</span>

<span class="sd">  Returns:</span>
<span class="sd">    The random data.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">randn_like</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<div class="viewcode-block" id="randint_like"><a class="viewcode-back" href="../../../../apis/auto/generated/brainpy.math.random.randint_like.html#brainpy.math.random.randint_like">[docs]</a><span class="k">def</span> <span class="nf">randint_like</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;Similar to ``randint_like`` in torch. </span>
<span class="sd">  </span>
<span class="sd">  Returns a tensor with the same shape as Tensor ``input`` filled with</span>
<span class="sd">  random integers generated uniformly between ``low`` (inclusive) and ``high`` (exclusive).</span>

<span class="sd">  Args:</span>
<span class="sd">    input:  the ``size`` of input will determine size of the output tensor.</span>
<span class="sd">    low: Lowest integer to be drawn from the distribution. Default: 0.</span>
<span class="sd">    high: One above the highest integer to be drawn from the distribution.</span>
<span class="sd">    dtype: the desired data type of returned Tensor. Default: if ``None``, defaults to the dtype of input.</span>
<span class="sd">    key: the seed or key for the random.</span>

<span class="sd">  Returns:</span>
<span class="sd">    The random data.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">DEFAULT</span><span class="o">.</span><span class="n">randint_like</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">low</span><span class="o">=</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">high</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span></div>


<span class="k">for</span> <span class="n">__k</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">RandomState</span><span class="p">):</span>
  <span class="n">__t</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">RandomState</span><span class="p">,</span> <span class="n">__k</span><span class="p">)</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="n">__k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;__&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">callable</span><span class="p">(</span><span class="n">__t</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">__t</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">):</span>
    <span class="n">__r</span> <span class="o">=</span> <span class="nb">globals</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">__k</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">__r</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">callable</span><span class="p">(</span><span class="n">__r</span><span class="p">):</span>
      <span class="n">__t</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">__r</span><span class="o">.</span><span class="vm">__doc__</span>


</pre></div>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By BrainPy Team
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
       Copyright 2020-2023, BrainPy.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on Apr 03, 2023.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>