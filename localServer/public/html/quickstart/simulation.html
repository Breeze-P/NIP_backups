

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Simulating a Brain Dynamics Model &#8212; BrainPy documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'quickstart/simulation';</script>
    <link rel="shortcut icon" href="../_static/logo-square.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Training a Brain Dynamics Model" href="training.html" />
    <link rel="prev" title="Installation" href="installation.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Quickstart</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Simulating a Brain Dynamics Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="training.html">Training a Brain Dynamics Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="analysis.html">Analyzing a Brain Dynamics Model</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">BrainPy Core Concepts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../core_concept/brainpy_transform_concept.html">Concept 1: Object-oriented Transformation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core_concept/brainpy_dynamical_system.html">Concept 2: Dynamical System</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Brain Dynamics Tutorials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorial_math/index.html">Math Foundation</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_math/variables.html"><code class="docutils literal notranslate"><span class="pre">brainpy.math.Variable</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_math/control_flows.html">Control Flows for JIT compilation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_math/random_number_generation.html">Random Number Generation for JIT Compilation</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorial_building/index.html">Model Building</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_building/overview_of_dynamic_model.html">Using Built-in Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_building/build_conductance_neurons.html">Building Conductance-based Neuron Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_building/build_synapse_models.html">Building Synapse Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_building/build_network_models.html">Building Network Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_building/customize_neuron_models.html">Customizing Your Neuron Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_building/customize_synapse_models.html">Customizing Your Synapse Models</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorial_simulation/index.html">Model Simulation</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_simulation/simulation_dsrunner.html">Simulation with <code class="docutils literal notranslate"><span class="pre">DSRunner</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_simulation/parallel_computing.html">Parallel Simulation for Parameter Exploration</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorial_training/index.html">Model Training</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_training/build_training_models.html">Building Training Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_training/offline_training.html">Training with Offline Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_training/online_training.html">Training with Online Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_training/bp_training.html">Training with Back-propagation Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_training/esn_introduction.html">Introduction to Echo State Network</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorial_analysis/index.html">Model Analysis</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_analysis/lowdim_analysis.html">Low-dimensional Analyzers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_analysis/highdim_analysis.html">High-dimensional Analyzers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial_analysis/decision_making_model.html">Analysis of a Decision-making Model</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Advanced Tutorials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../tutorial_advanced/adavanced_lowdim_analysis.html">How does low-dimensional analyzers work?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial_advanced/interoperation.html">Interoperation with other JAX frameworks</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Toolboxes</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../tutorial_toolbox/ode_numerical_solvers.html">Numerical Solvers for Ordinary Differential Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial_toolbox/sde_numerical_solvers.html">Numerical Solvers for Stochastic Differential Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial_toolbox/fde_numerical_solvers.html">Numerical Solvers for Fractional Differential Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial_toolbox/dde_numerical_solvers.html">Numerical Solvers for Delay Differential Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial_toolbox/joint_equations.html">Joint Differential Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial_toolbox/synaptic_connections.html">Synaptic Connections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial_toolbox/synaptic_weights.html">Synaptic Weights</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial_toolbox/optimizers.html">Gradient Descent Optimizers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial_toolbox/saving_and_loading.html">Saving and Loading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial_toolbox/inputs.html">Inputs Construction</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Frequently Asked Questions</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../tutorial_FAQs/citing_and_publication.html">How to cite BrainPy?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial_FAQs/uniqueness_of-brainpy-math.html">How is <code class="docutils literal notranslate"><span class="pre">brainpy</span></code> different from other frameworks?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial_FAQs/brainpy_ecosystem.html">BrainPy Ecosystem for Brain Dynamics Modeling</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../apis/auto/brainpy.html"><code class="docutils literal notranslate"><span class="pre">brainpy</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.Integrator.html">brainpy.Integrator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.JointEq.html">brainpy.JointEq</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.IntegratorRunner.html">brainpy.IntegratorRunner</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.odeint.html">brainpy.odeint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.sdeint.html">brainpy.sdeint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.fdeint.html">brainpy.fdeint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.DynamicalSystem.html">brainpy.DynamicalSystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.Container.html">brainpy.Container</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.Sequential.html">brainpy.Sequential</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.Network.html">brainpy.Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.NeuGroup.html">brainpy.NeuGroup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.SynConn.html">brainpy.SynConn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.SynOut.html">brainpy.SynOut</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.SynSTP.html">brainpy.SynSTP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.SynLTP.html">brainpy.SynLTP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.TwoEndConn.html">brainpy.TwoEndConn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.CondNeuGroup.html">brainpy.CondNeuGroup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.Channel.html">brainpy.Channel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.DSRunner.html">brainpy.DSRunner</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.DSTrainer.html">brainpy.DSTrainer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.BPTT.html">brainpy.BPTT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.BPFF.html">brainpy.BPFF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.OnlineTrainer.html">brainpy.OnlineTrainer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.ForceTrainer.html">brainpy.ForceTrainer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.OfflineTrainer.html">brainpy.OfflineTrainer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.RidgeTrainer.html">brainpy.RidgeTrainer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.NoSharedArg.html">brainpy.NoSharedArg</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.LoopOverTime.html">brainpy.LoopOverTime</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../apis/auto/math.html"><code class="docutils literal notranslate"><span class="pre">brainpy.math</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.BrainPyObject.html">brainpy.math.BrainPyObject</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.FunAsObject.html">brainpy.math.FunAsObject</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.dyn_seq.html">brainpy.math.dyn_seq</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.dyn_dict.html">brainpy.math.dyn_dict</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.Variable.html">brainpy.math.Variable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.Parameter.html">brainpy.math.Parameter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.TrainVar.html">brainpy.math.TrainVar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.Partial.html">brainpy.math.Partial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.grad.html">brainpy.math.grad</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.vector_grad.html">brainpy.math.vector_grad</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.jacobian.html">brainpy.math.jacobian</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.jacrev.html">brainpy.math.jacrev</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.jacfwd.html">brainpy.math.jacfwd</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.hessian.html">brainpy.math.hessian</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.make_loop.html">brainpy.math.make_loop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.make_while.html">brainpy.math.make_while</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.make_cond.html">brainpy.math.make_cond</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.cond.html">brainpy.math.cond</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.ifelse.html">brainpy.math.ifelse</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.for_loop.html">brainpy.math.for_loop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.while_loop.html">brainpy.math.while_loop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.to_object.html">brainpy.math.to_object</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.to_dynsys.html">brainpy.math.to_dynsys</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.function.html">brainpy.math.function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.jit.html">brainpy.math.jit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.ObjectTransform.html">brainpy.math.ObjectTransform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.pre2post_sum.html">brainpy.math.pre2post_sum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.pre2post_prod.html">brainpy.math.pre2post_prod</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.pre2post_max.html">brainpy.math.pre2post_max</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.pre2post_min.html">brainpy.math.pre2post_min</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.pre2post_mean.html">brainpy.math.pre2post_mean</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.pre2post_event_sum.html">brainpy.math.pre2post_event_sum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.pre2post_coo_event_sum.html">brainpy.math.pre2post_coo_event_sum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.pre2post_event_prod.html">brainpy.math.pre2post_event_prod</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.pre2syn.html">brainpy.math.pre2syn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.syn2post_sum.html">brainpy.math.syn2post_sum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.syn2post.html">brainpy.math.syn2post</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.syn2post_prod.html">brainpy.math.syn2post_prod</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.syn2post_max.html">brainpy.math.syn2post_max</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.syn2post_min.html">brainpy.math.syn2post_min</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.syn2post_mean.html">brainpy.math.syn2post_mean</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.syn2post_softmax.html">brainpy.math.syn2post_softmax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.sparse_matmul.html">brainpy.math.sparse_matmul</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.csr_matvec.html">brainpy.math.csr_matvec</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.event_csr_matvec.html">brainpy.math.event_csr_matvec</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.XLACustomOp.html">brainpy.math.XLACustomOp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.celu.html">brainpy.math.celu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.elu.html">brainpy.math.elu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.gelu.html">brainpy.math.gelu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.glu.html">brainpy.math.glu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.hard_tanh.html">brainpy.math.hard_tanh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.hard_sigmoid.html">brainpy.math.hard_sigmoid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.hard_silu.html">brainpy.math.hard_silu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.hard_swish.html">brainpy.math.hard_swish</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.leaky_relu.html">brainpy.math.leaky_relu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.log_sigmoid.html">brainpy.math.log_sigmoid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.log_softmax.html">brainpy.math.log_softmax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.one_hot.html">brainpy.math.one_hot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.normalize.html">brainpy.math.normalize</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.relu.html">brainpy.math.relu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.relu6.html">brainpy.math.relu6</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.sigmoid.html">brainpy.math.sigmoid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.soft_sign.html">brainpy.math.soft_sign</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.softmax.html">brainpy.math.softmax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.softplus.html">brainpy.math.softplus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.silu.html">brainpy.math.silu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.swish.html">brainpy.math.swish</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.selu.html">brainpy.math.selu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.identity.html">brainpy.math.identity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.TimeDelay.html">brainpy.math.TimeDelay</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.LengthDelay.html">brainpy.math.LengthDelay</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.NeuTimeDelay.html">brainpy.math.NeuTimeDelay</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.NeuLenDelay.html">brainpy.math.NeuLenDelay</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.DelayVariable.html">brainpy.math.DelayVariable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.ROTATE_UPDATE.html">brainpy.math.ROTATE_UPDATE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.CONCAT_UPDATE.html">brainpy.math.CONCAT_UPDATE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.set_float.html">brainpy.math.set_float</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.get_float.html">brainpy.math.get_float</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.set_int.html">brainpy.math.set_int</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.get_int.html">brainpy.math.get_int</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.set_bool.html">brainpy.math.set_bool</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.get_bool.html">brainpy.math.get_bool</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.set_complex.html">brainpy.math.set_complex</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.get_complex.html">brainpy.math.get_complex</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.set_dt.html">brainpy.math.set_dt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.get_dt.html">brainpy.math.get_dt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.set_mode.html">brainpy.math.set_mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.get_mode.html">brainpy.math.get_mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.set_environment.html">brainpy.math.set_environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.enable_x64.html">brainpy.math.enable_x64</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.disable_x64.html">brainpy.math.disable_x64</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.set_platform.html">brainpy.math.set_platform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.get_platform.html">brainpy.math.get_platform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.set_host_device_count.html">brainpy.math.set_host_device_count</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.clear_buffer_memory.html">brainpy.math.clear_buffer_memory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.enable_gpu_memory_preallocation.html">brainpy.math.enable_gpu_memory_preallocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.disable_gpu_memory_preallocation.html">brainpy.math.disable_gpu_memory_preallocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.ditype.html">brainpy.math.ditype</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.dftype.html">brainpy.math.dftype</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.environment.html">brainpy.math.environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.batching_environment.html">brainpy.math.batching_environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.training_environment.html">brainpy.math.training_environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.Mode.html">brainpy.math.Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.NonBatchingMode.html">brainpy.math.NonBatchingMode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.BatchingMode.html">brainpy.math.BatchingMode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.TrainingMode.html">brainpy.math.TrainingMode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.nonbatching_mode.html">brainpy.math.nonbatching_mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.batching_mode.html">brainpy.math.batching_mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.training_mode.html">brainpy.math.training_mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.as_device_array.html">brainpy.math.as_device_array</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.as_jax.html">brainpy.math.as_jax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.as_ndarray.html">brainpy.math.as_ndarray</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.as_numpy.html">brainpy.math.as_numpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.as_variable.html">brainpy.math.as_variable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.fill_diagonal.html">brainpy.math.fill_diagonal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.empty.html">brainpy.math.empty</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.empty_like.html">brainpy.math.empty_like</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.ones.html">brainpy.math.ones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.ones_like.html">brainpy.math.ones_like</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.zeros.html">brainpy.math.zeros</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.zeros_like.html">brainpy.math.zeros_like</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.array.html">brainpy.math.array</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.asarray.html">brainpy.math.asarray</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.arange.html">brainpy.math.arange</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.linspace.html">brainpy.math.linspace</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.logspace.html">brainpy.math.logspace</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.full.html">brainpy.math.full</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.full_like.html">brainpy.math.full_like</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.eye.html">brainpy.math.eye</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.identity.html">brainpy.math.identity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.diag.html">brainpy.math.diag</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.tri.html">brainpy.math.tri</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.tril.html">brainpy.math.tril</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.triu.html">brainpy.math.triu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.real.html">brainpy.math.real</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.imag.html">brainpy.math.imag</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.conj.html">brainpy.math.conj</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.conjugate.html">brainpy.math.conjugate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.ndim.html">brainpy.math.ndim</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.isreal.html">brainpy.math.isreal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.isscalar.html">brainpy.math.isscalar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.add.html">brainpy.math.add</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.reciprocal.html">brainpy.math.reciprocal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.negative.html">brainpy.math.negative</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.positive.html">brainpy.math.positive</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.multiply.html">brainpy.math.multiply</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.divide.html">brainpy.math.divide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.power.html">brainpy.math.power</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.subtract.html">brainpy.math.subtract</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.true_divide.html">brainpy.math.true_divide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.floor_divide.html">brainpy.math.floor_divide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.float_power.html">brainpy.math.float_power</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.fmod.html">brainpy.math.fmod</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.mod.html">brainpy.math.mod</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.modf.html">brainpy.math.modf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.divmod.html">brainpy.math.divmod</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.remainder.html">brainpy.math.remainder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.abs.html">brainpy.math.abs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.exp.html">brainpy.math.exp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.exp2.html">brainpy.math.exp2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.expm1.html">brainpy.math.expm1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.log.html">brainpy.math.log</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.log10.html">brainpy.math.log10</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.log1p.html">brainpy.math.log1p</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.log2.html">brainpy.math.log2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.logaddexp.html">brainpy.math.logaddexp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.logaddexp2.html">brainpy.math.logaddexp2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.lcm.html">brainpy.math.lcm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.gcd.html">brainpy.math.gcd</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.arccos.html">brainpy.math.arccos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.arccosh.html">brainpy.math.arccosh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.arcsin.html">brainpy.math.arcsin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.arcsinh.html">brainpy.math.arcsinh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.arctan.html">brainpy.math.arctan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.arctan2.html">brainpy.math.arctan2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.arctanh.html">brainpy.math.arctanh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.cos.html">brainpy.math.cos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.cosh.html">brainpy.math.cosh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.sin.html">brainpy.math.sin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.sinc.html">brainpy.math.sinc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.sinh.html">brainpy.math.sinh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.tan.html">brainpy.math.tan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.tanh.html">brainpy.math.tanh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.deg2rad.html">brainpy.math.deg2rad</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.hypot.html">brainpy.math.hypot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.rad2deg.html">brainpy.math.rad2deg</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.degrees.html">brainpy.math.degrees</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.radians.html">brainpy.math.radians</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.round.html">brainpy.math.round</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.around.html">brainpy.math.around</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.round_.html">brainpy.math.round_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.rint.html">brainpy.math.rint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.floor.html">brainpy.math.floor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.ceil.html">brainpy.math.ceil</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.trunc.html">brainpy.math.trunc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.fix.html">brainpy.math.fix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.prod.html">brainpy.math.prod</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.sum.html">brainpy.math.sum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.diff.html">brainpy.math.diff</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.median.html">brainpy.math.median</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.nancumprod.html">brainpy.math.nancumprod</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.nancumsum.html">brainpy.math.nancumsum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.nanprod.html">brainpy.math.nanprod</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.nansum.html">brainpy.math.nansum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.cumprod.html">brainpy.math.cumprod</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.cumsum.html">brainpy.math.cumsum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.ediff1d.html">brainpy.math.ediff1d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.cross.html">brainpy.math.cross</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.trapz.html">brainpy.math.trapz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.isfinite.html">brainpy.math.isfinite</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.isinf.html">brainpy.math.isinf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.isnan.html">brainpy.math.isnan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.signbit.html">brainpy.math.signbit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.copysign.html">brainpy.math.copysign</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.nextafter.html">brainpy.math.nextafter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.ldexp.html">brainpy.math.ldexp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.frexp.html">brainpy.math.frexp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.convolve.html">brainpy.math.convolve</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.sqrt.html">brainpy.math.sqrt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.cbrt.html">brainpy.math.cbrt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.square.html">brainpy.math.square</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.absolute.html">brainpy.math.absolute</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.fabs.html">brainpy.math.fabs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.sign.html">brainpy.math.sign</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.heaviside.html">brainpy.math.heaviside</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.maximum.html">brainpy.math.maximum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.minimum.html">brainpy.math.minimum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.fmax.html">brainpy.math.fmax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.fmin.html">brainpy.math.fmin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.interp.html">brainpy.math.interp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.clip.html">brainpy.math.clip</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.angle.html">brainpy.math.angle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.bitwise_and.html">brainpy.math.bitwise_and</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.bitwise_not.html">brainpy.math.bitwise_not</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.bitwise_or.html">brainpy.math.bitwise_or</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.bitwise_xor.html">brainpy.math.bitwise_xor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.invert.html">brainpy.math.invert</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.left_shift.html">brainpy.math.left_shift</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.right_shift.html">brainpy.math.right_shift</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.equal.html">brainpy.math.equal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.not_equal.html">brainpy.math.not_equal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.greater.html">brainpy.math.greater</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.greater_equal.html">brainpy.math.greater_equal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.less.html">brainpy.math.less</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.less_equal.html">brainpy.math.less_equal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.array_equal.html">brainpy.math.array_equal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.isclose.html">brainpy.math.isclose</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.allclose.html">brainpy.math.allclose</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.logical_and.html">brainpy.math.logical_and</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.logical_not.html">brainpy.math.logical_not</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.logical_or.html">brainpy.math.logical_or</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.logical_xor.html">brainpy.math.logical_xor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.all.html">brainpy.math.all</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.any.html">brainpy.math.any</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.alltrue.html">brainpy.math.alltrue</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.sometrue.html">brainpy.math.sometrue</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.shape.html">brainpy.math.shape</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.size.html">brainpy.math.size</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.reshape.html">brainpy.math.reshape</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.ravel.html">brainpy.math.ravel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.moveaxis.html">brainpy.math.moveaxis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.transpose.html">brainpy.math.transpose</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.swapaxes.html">brainpy.math.swapaxes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.concatenate.html">brainpy.math.concatenate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.stack.html">brainpy.math.stack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.vstack.html">brainpy.math.vstack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.hstack.html">brainpy.math.hstack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.dstack.html">brainpy.math.dstack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.column_stack.html">brainpy.math.column_stack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.split.html">brainpy.math.split</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.dsplit.html">brainpy.math.dsplit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.hsplit.html">brainpy.math.hsplit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.vsplit.html">brainpy.math.vsplit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.tile.html">brainpy.math.tile</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.repeat.html">brainpy.math.repeat</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.unique.html">brainpy.math.unique</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.append.html">brainpy.math.append</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.flip.html">brainpy.math.flip</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.fliplr.html">brainpy.math.fliplr</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.flipud.html">brainpy.math.flipud</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.roll.html">brainpy.math.roll</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.atleast_1d.html">brainpy.math.atleast_1d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.atleast_2d.html">brainpy.math.atleast_2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.atleast_3d.html">brainpy.math.atleast_3d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.expand_dims.html">brainpy.math.expand_dims</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.squeeze.html">brainpy.math.squeeze</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.sort.html">brainpy.math.sort</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.argsort.html">brainpy.math.argsort</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.argmax.html">brainpy.math.argmax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.argmin.html">brainpy.math.argmin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.argwhere.html">brainpy.math.argwhere</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.nonzero.html">brainpy.math.nonzero</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.flatnonzero.html">brainpy.math.flatnonzero</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.where.html">brainpy.math.where</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.searchsorted.html">brainpy.math.searchsorted</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.extract.html">brainpy.math.extract</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.count_nonzero.html">brainpy.math.count_nonzero</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.max.html">brainpy.math.max</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.min.html">brainpy.math.min</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.amax.html">brainpy.math.amax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.amin.html">brainpy.math.amin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.array_split.html">brainpy.math.array_split</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.meshgrid.html">brainpy.math.meshgrid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.vander.html">brainpy.math.vander</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.tril_indices.html">brainpy.math.tril_indices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.tril_indices_from.html">brainpy.math.tril_indices_from</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.triu_indices.html">brainpy.math.triu_indices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.triu_indices_from.html">brainpy.math.triu_indices_from</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.take.html">brainpy.math.take</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.select.html">brainpy.math.select</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.nanmin.html">brainpy.math.nanmin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.nanmax.html">brainpy.math.nanmax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.ptp.html">brainpy.math.ptp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.percentile.html">brainpy.math.percentile</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.nanpercentile.html">brainpy.math.nanpercentile</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.quantile.html">brainpy.math.quantile</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.nanquantile.html">brainpy.math.nanquantile</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.average.html">brainpy.math.average</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.mean.html">brainpy.math.mean</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.std.html">brainpy.math.std</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.var.html">brainpy.math.var</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.nanmedian.html">brainpy.math.nanmedian</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.nanmean.html">brainpy.math.nanmean</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.nanstd.html">brainpy.math.nanstd</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.nanvar.html">brainpy.math.nanvar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.corrcoef.html">brainpy.math.corrcoef</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.correlate.html">brainpy.math.correlate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.cov.html">brainpy.math.cov</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.histogram.html">brainpy.math.histogram</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.bincount.html">brainpy.math.bincount</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.digitize.html">brainpy.math.digitize</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.bartlett.html">brainpy.math.bartlett</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.blackman.html">brainpy.math.blackman</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.hamming.html">brainpy.math.hamming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.hanning.html">brainpy.math.hanning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.kaiser.html">brainpy.math.kaiser</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.dot.html">brainpy.math.dot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.vdot.html">brainpy.math.vdot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.inner.html">brainpy.math.inner</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.outer.html">brainpy.math.outer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.kron.html">brainpy.math.kron</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.matmul.html">brainpy.math.matmul</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.trace.html">brainpy.math.trace</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.product.html">brainpy.math.product</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.row_stack.html">brainpy.math.row_stack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.apply_over_axes.html">brainpy.math.apply_over_axes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.apply_along_axis.html">brainpy.math.apply_along_axis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.array_equiv.html">brainpy.math.array_equiv</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.array_repr.html">brainpy.math.array_repr</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.array_str.html">brainpy.math.array_str</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.block.html">brainpy.math.block</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.broadcast_arrays.html">brainpy.math.broadcast_arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.broadcast_shapes.html">brainpy.math.broadcast_shapes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.broadcast_to.html">brainpy.math.broadcast_to</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.compress.html">brainpy.math.compress</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.cumproduct.html">brainpy.math.cumproduct</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.diag_indices.html">brainpy.math.diag_indices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.diag_indices_from.html">brainpy.math.diag_indices_from</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.diagflat.html">brainpy.math.diagflat</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.diagonal.html">brainpy.math.diagonal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.einsum.html">brainpy.math.einsum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.einsum_path.html">brainpy.math.einsum_path</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.geomspace.html">brainpy.math.geomspace</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.gradient.html">brainpy.math.gradient</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.histogram2d.html">brainpy.math.histogram2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.histogram_bin_edges.html">brainpy.math.histogram_bin_edges</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.histogramdd.html">brainpy.math.histogramdd</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.i0.html">brainpy.math.i0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.in1d.html">brainpy.math.in1d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.indices.html">brainpy.math.indices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.insert.html">brainpy.math.insert</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.intersect1d.html">brainpy.math.intersect1d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.iscomplex.html">brainpy.math.iscomplex</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.isin.html">brainpy.math.isin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.ix_.html">brainpy.math.ix_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.lexsort.html">brainpy.math.lexsort</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.load.html">brainpy.math.load</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.save.html">brainpy.math.save</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.savez.html">brainpy.math.savez</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.mask_indices.html">brainpy.math.mask_indices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.msort.html">brainpy.math.msort</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.nan_to_num.html">brainpy.math.nan_to_num</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.nanargmax.html">brainpy.math.nanargmax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.setdiff1d.html">brainpy.math.setdiff1d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.nanargmin.html">brainpy.math.nanargmin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.pad.html">brainpy.math.pad</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.poly.html">brainpy.math.poly</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.polyadd.html">brainpy.math.polyadd</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.polyder.html">brainpy.math.polyder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.polyfit.html">brainpy.math.polyfit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.polyint.html">brainpy.math.polyint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.polymul.html">brainpy.math.polymul</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.polysub.html">brainpy.math.polysub</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.polyval.html">brainpy.math.polyval</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.resize.html">brainpy.math.resize</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.rollaxis.html">brainpy.math.rollaxis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.roots.html">brainpy.math.roots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.rot90.html">brainpy.math.rot90</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.setxor1d.html">brainpy.math.setxor1d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.tensordot.html">brainpy.math.tensordot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.trim_zeros.html">brainpy.math.trim_zeros</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.union1d.html">brainpy.math.union1d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.unravel_index.html">brainpy.math.unravel_index</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.unwrap.html">brainpy.math.unwrap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.take_along_axis.html">brainpy.math.take_along_axis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.can_cast.html">brainpy.math.can_cast</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.choose.html">brainpy.math.choose</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.copy.html">brainpy.math.copy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.frombuffer.html">brainpy.math.frombuffer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.fromfile.html">brainpy.math.fromfile</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.fromfunction.html">brainpy.math.fromfunction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.fromiter.html">brainpy.math.fromiter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.fromstring.html">brainpy.math.fromstring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.get_printoptions.html">brainpy.math.get_printoptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.iscomplexobj.html">brainpy.math.iscomplexobj</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.isneginf.html">brainpy.math.isneginf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.isposinf.html">brainpy.math.isposinf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.isrealobj.html">brainpy.math.isrealobj</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.issubdtype.html">brainpy.math.issubdtype</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.issubsctype.html">brainpy.math.issubsctype</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.iterable.html">brainpy.math.iterable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.packbits.html">brainpy.math.packbits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.piecewise.html">brainpy.math.piecewise</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.printoptions.html">brainpy.math.printoptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.set_printoptions.html">brainpy.math.set_printoptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.promote_types.html">brainpy.math.promote_types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.ravel_multi_index.html">brainpy.math.ravel_multi_index</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.result_type.html">brainpy.math.result_type</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.sort_complex.html">brainpy.math.sort_complex</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.unpackbits.html">brainpy.math.unpackbits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.delete.html">brainpy.math.delete</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.add_newdoc.html">brainpy.math.add_newdoc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.array2string.html">brainpy.math.array2string</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.asanyarray.html">brainpy.math.asanyarray</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.ascontiguousarray.html">brainpy.math.ascontiguousarray</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.asfarray.html">brainpy.math.asfarray</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.asscalar.html">brainpy.math.asscalar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.common_type.html">brainpy.math.common_type</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.disp.html">brainpy.math.disp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.genfromtxt.html">brainpy.math.genfromtxt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.loadtxt.html">brainpy.math.loadtxt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.info.html">brainpy.math.info</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.issubclass_.html">brainpy.math.issubclass_</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.place.html">brainpy.math.place</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.polydiv.html">brainpy.math.polydiv</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.put.html">brainpy.math.put</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.putmask.html">brainpy.math.putmask</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.safe_eval.html">brainpy.math.safe_eval</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.savetxt.html">brainpy.math.savetxt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.savez_compressed.html">brainpy.math.savez_compressed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.show_config.html">brainpy.math.show_config</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.typename.html">brainpy.math.typename</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.copyto.html">brainpy.math.copyto</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.matrix.html">brainpy.math.matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.asmatrix.html">brainpy.math.asmatrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.mat.html">brainpy.math.mat</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.dtype.html">brainpy.math.dtype</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.finfo.html">brainpy.math.finfo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.iinfo.html">brainpy.math.iinfo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.e.html">brainpy.math.e</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.pi.html">brainpy.math.pi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.inf.html">brainpy.math.inf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.add_docstring.html">brainpy.math.add_docstring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.add_newdoc_ufunc.html">brainpy.math.add_newdoc_ufunc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.flatten.html">brainpy.math.flatten</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.cat.html">brainpy.math.cat</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.unsqueeze.html">brainpy.math.unsqueeze</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.abs.html">brainpy.math.abs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.absolute.html">brainpy.math.absolute</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.acos.html">brainpy.math.acos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.arccos.html">brainpy.math.arccos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.acosh.html">brainpy.math.acosh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.arccosh.html">brainpy.math.arccosh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.add.html">brainpy.math.add</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.addcdiv.html">brainpy.math.addcdiv</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.addcmul.html">brainpy.math.addcmul</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.angle.html">brainpy.math.angle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.asin.html">brainpy.math.asin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.arcsin.html">brainpy.math.arcsin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.asinh.html">brainpy.math.asinh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.atan.html">brainpy.math.atan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.arctan.html">brainpy.math.arctan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.atan2.html">brainpy.math.atan2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.atanh.html">brainpy.math.atanh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.Tensor.html">brainpy.math.Tensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.concat.html">brainpy.math.concat</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.reduce_sum.html">brainpy.math.reduce_sum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.reduce_max.html">brainpy.math.reduce_max</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.reduce_min.html">brainpy.math.reduce_min</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.reduce_mean.html">brainpy.math.reduce_mean</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.reduce_all.html">brainpy.math.reduce_all</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.reduce_any.html">brainpy.math.reduce_any</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.reduce_logsumexp.html">brainpy.math.reduce_logsumexp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.reduce_prod.html">brainpy.math.reduce_prod</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.reduce_std.html">brainpy.math.reduce_std</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.reduce_variance.html">brainpy.math.reduce_variance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.reduce_euclidean_norm.html">brainpy.math.reduce_euclidean_norm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.unsorted_segment_sqrt_n.html">brainpy.math.unsorted_segment_sqrt_n</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.segment_mean.html">brainpy.math.segment_mean</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.unsorted_segment_sum.html">brainpy.math.unsorted_segment_sum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.unsorted_segment_prod.html">brainpy.math.unsorted_segment_prod</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.unsorted_segment_max.html">brainpy.math.unsorted_segment_max</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.unsorted_segment_min.html">brainpy.math.unsorted_segment_min</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.unsorted_segment_mean.html">brainpy.math.unsorted_segment_mean</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.segment_sum.html">brainpy.math.segment_sum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.segment_prod.html">brainpy.math.segment_prod</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.segment_max.html">brainpy.math.segment_max</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.segment_min.html">brainpy.math.segment_min</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.clip_by_value.html">brainpy.math.clip_by_value</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.cast.html">brainpy.math.cast</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.surrogate.sigmoid.html">brainpy.math.surrogate.sigmoid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.surrogate.piecewise_quadratic.html">brainpy.math.surrogate.piecewise_quadratic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.surrogate.piecewise_exp.html">brainpy.math.surrogate.piecewise_exp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.surrogate.soft_sign.html">brainpy.math.surrogate.soft_sign</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.surrogate.arctan.html">brainpy.math.surrogate.arctan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.surrogate.nonzero_sign_log.html">brainpy.math.surrogate.nonzero_sign_log</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.surrogate.erf.html">brainpy.math.surrogate.erf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.surrogate.piecewise_leaky_relu.html">brainpy.math.surrogate.piecewise_leaky_relu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.surrogate.squarewave_fourier_series.html">brainpy.math.surrogate.squarewave_fourier_series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.surrogate.s2nn.html">brainpy.math.surrogate.s2nn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.surrogate.q_pseudo_spike.html">brainpy.math.surrogate.q_pseudo_spike</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.surrogate.leaky_relu.html">brainpy.math.surrogate.leaky_relu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.surrogate.log_tailed_relu.html">brainpy.math.surrogate.log_tailed_relu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.surrogate.relu_grad.html">brainpy.math.surrogate.relu_grad</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.surrogate.gaussian_grad.html">brainpy.math.surrogate.gaussian_grad</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.surrogate.inv_square_grad.html">brainpy.math.surrogate.inv_square_grad</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.surrogate.multi_gaussian_grad.html">brainpy.math.surrogate.multi_gaussian_grad</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.surrogate.slayer_grad.html">brainpy.math.surrogate.slayer_grad</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.surrogate.inv_square_grad2.html">brainpy.math.surrogate.inv_square_grad2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.surrogate.relu_grad2.html">brainpy.math.surrogate.relu_grad2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.seed.html">brainpy.math.random.seed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.split_key.html">brainpy.math.random.split_key</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.default_rng.html">brainpy.math.random.default_rng</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.rand.html">brainpy.math.random.rand</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.randint.html">brainpy.math.random.randint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.random_integers.html">brainpy.math.random.random_integers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.randn.html">brainpy.math.random.randn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.random.html">brainpy.math.random.random</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.random_sample.html">brainpy.math.random.random_sample</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.ranf.html">brainpy.math.random.ranf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.sample.html">brainpy.math.random.sample</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.choice.html">brainpy.math.random.choice</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.permutation.html">brainpy.math.random.permutation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.shuffle.html">brainpy.math.random.shuffle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.beta.html">brainpy.math.random.beta</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.exponential.html">brainpy.math.random.exponential</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.gamma.html">brainpy.math.random.gamma</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.gumbel.html">brainpy.math.random.gumbel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.laplace.html">brainpy.math.random.laplace</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.logistic.html">brainpy.math.random.logistic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.normal.html">brainpy.math.random.normal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.pareto.html">brainpy.math.random.pareto</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.poisson.html">brainpy.math.random.poisson</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.standard_cauchy.html">brainpy.math.random.standard_cauchy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.standard_exponential.html">brainpy.math.random.standard_exponential</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.standard_gamma.html">brainpy.math.random.standard_gamma</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.standard_normal.html">brainpy.math.random.standard_normal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.standard_t.html">brainpy.math.random.standard_t</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.uniform.html">brainpy.math.random.uniform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.truncated_normal.html">brainpy.math.random.truncated_normal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.bernoulli.html">brainpy.math.random.bernoulli</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.lognormal.html">brainpy.math.random.lognormal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.binomial.html">brainpy.math.random.binomial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.chisquare.html">brainpy.math.random.chisquare</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.dirichlet.html">brainpy.math.random.dirichlet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.geometric.html">brainpy.math.random.geometric</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.f.html">brainpy.math.random.f</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.hypergeometric.html">brainpy.math.random.hypergeometric</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.logseries.html">brainpy.math.random.logseries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.multinomial.html">brainpy.math.random.multinomial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.multivariate_normal.html">brainpy.math.random.multivariate_normal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.negative_binomial.html">brainpy.math.random.negative_binomial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.noncentral_chisquare.html">brainpy.math.random.noncentral_chisquare</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.noncentral_f.html">brainpy.math.random.noncentral_f</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.power.html">brainpy.math.random.power</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.rayleigh.html">brainpy.math.random.rayleigh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.triangular.html">brainpy.math.random.triangular</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.vonmises.html">brainpy.math.random.vonmises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.wald.html">brainpy.math.random.wald</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.weibull.html">brainpy.math.random.weibull</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.weibull_min.html">brainpy.math.random.weibull_min</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.zipf.html">brainpy.math.random.zipf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.maxwell.html">brainpy.math.random.maxwell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.t.html">brainpy.math.random.t</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.orthogonal.html">brainpy.math.random.orthogonal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.loggamma.html">brainpy.math.random.loggamma</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.categorical.html">brainpy.math.random.categorical</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.rand_like.html">brainpy.math.random.rand_like</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.randint_like.html">brainpy.math.random.randint_like</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.randn_like.html">brainpy.math.random.randn_like</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.RandomState.html">brainpy.math.random.RandomState</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.Generator.html">brainpy.math.random.Generator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.random.DEFAULT.html">brainpy.math.random.DEFAULT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.linalg.cholesky.html">brainpy.math.linalg.cholesky</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.linalg.cond.html">brainpy.math.linalg.cond</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.linalg.det.html">brainpy.math.linalg.det</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.linalg.eig.html">brainpy.math.linalg.eig</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.linalg.eigh.html">brainpy.math.linalg.eigh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.linalg.eigvals.html">brainpy.math.linalg.eigvals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.linalg.eigvalsh.html">brainpy.math.linalg.eigvalsh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.linalg.inv.html">brainpy.math.linalg.inv</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.linalg.svd.html">brainpy.math.linalg.svd</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.linalg.lstsq.html">brainpy.math.linalg.lstsq</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.linalg.matrix_power.html">brainpy.math.linalg.matrix_power</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.linalg.matrix_rank.html">brainpy.math.linalg.matrix_rank</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.linalg.norm.html">brainpy.math.linalg.norm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.linalg.pinv.html">brainpy.math.linalg.pinv</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.linalg.qr.html">brainpy.math.linalg.qr</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.linalg.solve.html">brainpy.math.linalg.solve</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.linalg.slogdet.html">brainpy.math.linalg.slogdet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.linalg.tensorinv.html">brainpy.math.linalg.tensorinv</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.linalg.tensorsolve.html">brainpy.math.linalg.tensorsolve</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.linalg.multi_dot.html">brainpy.math.linalg.multi_dot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.fft.fft.html">brainpy.math.fft.fft</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.fft.fft2.html">brainpy.math.fft.fft2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.fft.fftfreq.html">brainpy.math.fft.fftfreq</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.fft.fftn.html">brainpy.math.fft.fftn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.fft.fftshift.html">brainpy.math.fft.fftshift</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.fft.hfft.html">brainpy.math.fft.hfft</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.fft.ifft.html">brainpy.math.fft.ifft</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.fft.ifft2.html">brainpy.math.fft.ifft2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.fft.ifftn.html">brainpy.math.fft.ifftn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.fft.ifftshift.html">brainpy.math.fft.ifftshift</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.fft.ihfft.html">brainpy.math.fft.ihfft</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.fft.irfft.html">brainpy.math.fft.irfft</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.fft.irfft2.html">brainpy.math.fft.irfft2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.fft.irfftn.html">brainpy.math.fft.irfftn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.fft.rfft.html">brainpy.math.fft.rfft</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.fft.rfft2.html">brainpy.math.fft.rfft2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.fft.rfftfreq.html">brainpy.math.fft.rfftfreq</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.math.fft.rfftn.html">brainpy.math.fft.rfftn</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../apis/auto/channels.html"><code class="docutils literal notranslate"><span class="pre">brainpy.channels</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.channels.Ion.html">brainpy.channels.Ion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.channels.IonChannel.html">brainpy.channels.IonChannel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.channels.Calcium.html">brainpy.channels.Calcium</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.channels.IhChannel.html">brainpy.channels.IhChannel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.channels.CalciumChannel.html">brainpy.channels.CalciumChannel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.channels.SodiumChannel.html">brainpy.channels.SodiumChannel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.channels.PotassiumChannel.html">brainpy.channels.PotassiumChannel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.channels.LeakyChannel.html">brainpy.channels.LeakyChannel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.channels.INa_Ba2002.html">brainpy.channels.INa_Ba2002</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.channels.INa_TM1991.html">brainpy.channels.INa_TM1991</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.channels.INa_HH1952.html">brainpy.channels.INa_HH1952</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.channels.IKDR_Ba2002.html">brainpy.channels.IKDR_Ba2002</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.channels.IK_TM1991.html">brainpy.channels.IK_TM1991</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.channels.IK_HH1952.html">brainpy.channels.IK_HH1952</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.channels.IKA1_HM1992.html">brainpy.channels.IKA1_HM1992</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.channels.IKA2_HM1992.html">brainpy.channels.IKA2_HM1992</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.channels.IKK2A_HM1992.html">brainpy.channels.IKK2A_HM1992</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.channels.IKK2B_HM1992.html">brainpy.channels.IKK2B_HM1992</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.channels.IKNI_Ya1989.html">brainpy.channels.IKNI_Ya1989</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.channels.CalciumFixed.html">brainpy.channels.CalciumFixed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.channels.CalciumDyna.html">brainpy.channels.CalciumDyna</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.channels.CalciumDetailed.html">brainpy.channels.CalciumDetailed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.channels.CalciumFirstOrder.html">brainpy.channels.CalciumFirstOrder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.channels.ICaN_IS2008.html">brainpy.channels.ICaN_IS2008</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.channels.ICaT_HM1992.html">brainpy.channels.ICaT_HM1992</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.channels.ICaT_HP1992.html">brainpy.channels.ICaT_HP1992</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.channels.ICaHT_HM1992.html">brainpy.channels.ICaHT_HM1992</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.channels.ICaL_IS2008.html">brainpy.channels.ICaL_IS2008</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.channels.IAHP_De1994.html">brainpy.channels.IAHP_De1994</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.channels.Ih_HM1992.html">brainpy.channels.Ih_HM1992</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.channels.Ih_De1996.html">brainpy.channels.Ih_De1996</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.channels.IL.html">brainpy.channels.IL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.channels.IKL.html">brainpy.channels.IKL</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../apis/auto/layers.html"><code class="docutils literal notranslate"><span class="pre">brainpy.layers</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.Layer.html">brainpy.layers.Layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.Conv1D.html">brainpy.layers.Conv1d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.Conv2D.html">brainpy.layers.Conv2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.Conv3D.html">brainpy.layers.Conv3d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.ConvTranspose1d.html">brainpy.layers.ConvTranspose1d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.ConvTranspose2d.html">brainpy.layers.ConvTranspose2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.ConvTranspose3d.html">brainpy.layers.ConvTranspose3d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.Dropout.html">brainpy.layers.Dropout</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.Activation.html">brainpy.layers.Activation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.Flatten.html">brainpy.layers.Flatten</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.FunAsLayer.html">brainpy.layers.FunAsLayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.Dense.html">brainpy.layers.Dense</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.Linear.html">brainpy.layers.Linear</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.Identity.html">brainpy.layers.Identity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.BatchNorm1D.html">brainpy.layers.BatchNorm1d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.BatchNorm2D.html">brainpy.layers.BatchNorm2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.BatchNorm3D.html">brainpy.layers.BatchNorm3d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.LayerNorm.html">brainpy.layers.LayerNorm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.GroupNorm.html">brainpy.layers.GroupNorm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.InstanceNorm.html">brainpy.layers.InstanceNorm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.NVAR.html">brainpy.layers.NVAR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.MaxPool.html">brainpy.layers.MaxPool</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.MinPool.html">brainpy.layers.MinPool</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.AvgPool.html">brainpy.layers.AvgPool</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.AvgPool1d.html">brainpy.layers.AvgPool1d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.AvgPool2d.html">brainpy.layers.AvgPool2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.AvgPool3d.html">brainpy.layers.AvgPool3d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.MaxPool1d.html">brainpy.layers.MaxPool1d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.MaxPool2d.html">brainpy.layers.MaxPool2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.MaxPool3d.html">brainpy.layers.MaxPool3d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.AdaptiveAvgPool1d.html">brainpy.layers.AdaptiveAvgPool1d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.AdaptiveAvgPool2d.html">brainpy.layers.AdaptiveAvgPool2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.AdaptiveAvgPool3d.html">brainpy.layers.AdaptiveAvgPool3d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.AdaptiveMaxPool1d.html">brainpy.layers.AdaptiveMaxPool1d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.AdaptiveMaxPool2d.html">brainpy.layers.AdaptiveMaxPool2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.AdaptiveMaxPool3d.html">brainpy.layers.AdaptiveMaxPool3d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.Reservoir.html">brainpy.layers.Reservoir</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.RNNCell.html">brainpy.layers.RNNCell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.GRUCell.html">brainpy.layers.GRUCell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.LSTMCell.html">brainpy.layers.LSTMCell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.Conv1dLSTMCell.html">brainpy.layers.Conv1dLSTMCell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.Conv2dLSTMCell.html">brainpy.layers.Conv2dLSTMCell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.Conv3dLSTMCell.html">brainpy.layers.Conv3dLSTMCell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.VanillaRNN.html">brainpy.layers.VanillaRNN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.GRU.html">brainpy.layers.GRU</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.layers.LSTM.html">brainpy.layers.LSTM</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../apis/auto/neurons.html"><code class="docutils literal notranslate"><span class="pre">brainpy.neurons</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.neurons.HH.html">brainpy.neurons.HH</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.neurons.MorrisLecar.html">brainpy.neurons.MorrisLecar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.neurons.PinskyRinzelModel.html">brainpy.neurons.PinskyRinzelModel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.neurons.WangBuzsakiModel.html">brainpy.neurons.WangBuzsakiModel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.neurons.FractionalNeuron.html">brainpy.neurons.FractionalNeuron</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.neurons.FractionalFHR.html">brainpy.neurons.FractionalFHR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.neurons.FractionalIzhikevich.html">brainpy.neurons.FractionalIzhikevich</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.neurons.LeakyIntegrator.html">brainpy.neurons.LeakyIntegrator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.neurons.LIF.html">brainpy.neurons.LIF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.neurons.ExpIF.html">brainpy.neurons.ExpIF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.neurons.AdExIF.html">brainpy.neurons.AdExIF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.neurons.QuaIF.html">brainpy.neurons.QuaIF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.neurons.AdQuaIF.html">brainpy.neurons.AdQuaIF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.neurons.GIF.html">brainpy.neurons.GIF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.neurons.ALIFBellec2020.html">brainpy.neurons.ALIFBellec2020</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.neurons.Izhikevich.html">brainpy.neurons.Izhikevich</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.neurons.HindmarshRose.html">brainpy.neurons.HindmarshRose</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.neurons.FHN.html">brainpy.neurons.FHN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.neurons.OUProcess.html">brainpy.neurons.OUProcess</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.neurons.InputGroup.html">brainpy.neurons.InputGroup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.neurons.OutputGroup.html">brainpy.neurons.OutputGroup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.neurons.SpikeTimeGroup.html">brainpy.neurons.SpikeTimeGroup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.neurons.PoissonGroup.html">brainpy.neurons.PoissonGroup</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../apis/auto/rates.html"><code class="docutils literal notranslate"><span class="pre">brainpy.rates</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.rates.RateModel.html">brainpy.rates.RateModel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.rates.FHN.html">brainpy.rates.FHN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.rates.FeedbackFHN.html">brainpy.rates.FeedbackFHN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.rates.QIF.html">brainpy.rates.QIF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.rates.StuartLandauOscillator.html">brainpy.rates.StuartLandauOscillator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.rates.WilsonCowanModel.html">brainpy.rates.WilsonCowanModel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.rates.ThresholdLinearModel.html">brainpy.rates.ThresholdLinearModel</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../apis/auto/synapses.html"><code class="docutils literal notranslate"><span class="pre">brainpy.synapses</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.synapses.Delta.html">brainpy.synapses.Delta</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.synapses.Exponential.html">brainpy.synapses.Exponential</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.synapses.DualExponential.html">brainpy.synapses.DualExponential</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.synapses.Alpha.html">brainpy.synapses.Alpha</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.synapses.NMDA.html">brainpy.synapses.NMDA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.synapses.PoissonInput.html">brainpy.synapses.PoissonInput</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.synapses.AMPA.html">brainpy.synapses.AMPA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.synapses.GABAa.html">brainpy.synapses.GABAa</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.synapses.BioNMDA.html">brainpy.synapses.BioNMDA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.synapses.DelayCoupling.html">brainpy.synapses.DelayCoupling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.synapses.DiffusiveCoupling.html">brainpy.synapses.DiffusiveCoupling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.synapses.AdditiveCoupling.html">brainpy.synapses.AdditiveCoupling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.synapses.GapJunction.html">brainpy.synapses.GapJunction</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../apis/auto/synouts.html"><code class="docutils literal notranslate"><span class="pre">brainpy.synouts</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.synouts.COBA.html">brainpy.synouts.COBA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.synouts.CUBA.html">brainpy.synouts.CUBA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.synouts.MgBlock.html">brainpy.synouts.MgBlock</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../apis/auto/synplast.html"><code class="docutils literal notranslate"><span class="pre">brainpy.synplast</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.synplast.STD.html">brainpy.synplast.STD</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.synplast.STP.html">brainpy.synplast.STP</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../apis/auto/integrators.html"><code class="docutils literal notranslate"><span class="pre">brainpy.integrators</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.ode.ODEIntegrator.html">brainpy.integrators.ode.ODEIntegrator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.ode.set_default_odeint.html">brainpy.integrators.ode.set_default_odeint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.ode.get_default_odeint.html">brainpy.integrators.ode.get_default_odeint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.ode.register_ode_integrator.html">brainpy.integrators.ode.register_ode_integrator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.ode.get_supported_methods.html">brainpy.integrators.ode.get_supported_methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.ode.ExplicitRKIntegrator.html">brainpy.integrators.ode.ExplicitRKIntegrator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.ode.Euler.html">brainpy.integrators.ode.Euler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.ode.MidPoint.html">brainpy.integrators.ode.MidPoint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.ode.Heun2.html">brainpy.integrators.ode.Heun2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.ode.Ralston2.html">brainpy.integrators.ode.Ralston2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.ode.RK2.html">brainpy.integrators.ode.RK2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.ode.RK3.html">brainpy.integrators.ode.RK3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.ode.Heun3.html">brainpy.integrators.ode.Heun3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.ode.Ralston3.html">brainpy.integrators.ode.Ralston3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.ode.SSPRK3.html">brainpy.integrators.ode.SSPRK3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.ode.RK4.html">brainpy.integrators.ode.RK4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.ode.Ralston4.html">brainpy.integrators.ode.Ralston4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.ode.RK4Rule38.html">brainpy.integrators.ode.RK4Rule38</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.ode.AdaptiveRKIntegrator.html">brainpy.integrators.ode.AdaptiveRKIntegrator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.ode.RKF12.html">brainpy.integrators.ode.RKF12</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.ode.RKF45.html">brainpy.integrators.ode.RKF45</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.ode.DormandPrince.html">brainpy.integrators.ode.DormandPrince</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.ode.CashKarp.html">brainpy.integrators.ode.CashKarp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.ode.BogackiShampine.html">brainpy.integrators.ode.BogackiShampine</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.ode.HeunEuler.html">brainpy.integrators.ode.HeunEuler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.ode.ExponentialEuler.html">brainpy.integrators.ode.ExponentialEuler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.sde.SDEIntegrator.html">brainpy.integrators.sde.SDEIntegrator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.sde.set_default_sdeint.html">brainpy.integrators.sde.set_default_sdeint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.sde.get_default_sdeint.html">brainpy.integrators.sde.get_default_sdeint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.sde.register_sde_integrator.html">brainpy.integrators.sde.register_sde_integrator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.sde.get_supported_methods.html">brainpy.integrators.sde.get_supported_methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.sde.Euler.html">brainpy.integrators.sde.Euler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.sde.Heun.html">brainpy.integrators.sde.Heun</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.sde.Milstein.html">brainpy.integrators.sde.Milstein</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.sde.MilsteinGradFree.html">brainpy.integrators.sde.MilsteinGradFree</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.sde.ExponentialEuler.html">brainpy.integrators.sde.ExponentialEuler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.sde.SRK1W1.html">brainpy.integrators.sde.SRK1W1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.sde.SRK2W1.html">brainpy.integrators.sde.SRK2W1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.sde.KlPl.html">brainpy.integrators.sde.KlPl</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.fde.FDEIntegrator.html">brainpy.integrators.fde.FDEIntegrator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.fde.set_default_fdeint.html">brainpy.integrators.fde.set_default_fdeint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.fde.get_default_fdeint.html">brainpy.integrators.fde.get_default_fdeint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.fde.register_fde_integrator.html">brainpy.integrators.fde.register_fde_integrator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.fde.get_supported_methods.html">brainpy.integrators.fde.get_supported_methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.fde.CaputoEuler.html">brainpy.integrators.fde.CaputoEuler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.fde.CaputoL1Schema.html">brainpy.integrators.fde.CaputoL1Schema</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.integrators.fde.GLShortMemory.html">brainpy.integrators.fde.GLShortMemory</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../apis/auto/analysis.html"><code class="docutils literal notranslate"><span class="pre">brainpy.analysis</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.analysis.PhasePlane1D.html">brainpy.analysis.PhasePlane1D</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.analysis.PhasePlane2D.html">brainpy.analysis.PhasePlane2D</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.analysis.Bifurcation1D.html">brainpy.analysis.Bifurcation1D</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.analysis.Bifurcation2D.html">brainpy.analysis.Bifurcation2D</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.analysis.FastSlow1D.html">brainpy.analysis.FastSlow1D</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.analysis.FastSlow2D.html">brainpy.analysis.FastSlow2D</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.analysis.SlowPointFinder.html">brainpy.analysis.SlowPointFinder</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../apis/auto/connect.html"><code class="docutils literal notranslate"><span class="pre">brainpy.connect</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-17"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.mat2coo.html">brainpy.connect.mat2coo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.mat2csc.html">brainpy.connect.mat2csc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.mat2csr.html">brainpy.connect.mat2csr</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.csr2csc.html">brainpy.connect.csr2csc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.csr2mat.html">brainpy.connect.csr2mat</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.csr2coo.html">brainpy.connect.csr2coo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.coo2csr.html">brainpy.connect.coo2csr</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.coo2csc.html">brainpy.connect.coo2csc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.coo2mat.html">brainpy.connect.coo2mat</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.Connector.html">brainpy.connect.Connector</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.TwoEndConnector.html">brainpy.connect.TwoEndConnector</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.OneEndConnector.html">brainpy.connect.OneEndConnector</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.CONN_MAT.html">brainpy.connect.CONN_MAT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.PRE_IDS.html">brainpy.connect.PRE_IDS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.POST_IDS.html">brainpy.connect.POST_IDS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.PRE2POST.html">brainpy.connect.PRE2POST</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.POST2PRE.html">brainpy.connect.POST2PRE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.PRE2SYN.html">brainpy.connect.PRE2SYN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.POST2SYN.html">brainpy.connect.POST2SYN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.MatConn.html">brainpy.connect.MatConn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.IJConn.html">brainpy.connect.IJConn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.CSRConn.html">brainpy.connect.CSRConn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.SparseMatConn.html">brainpy.connect.SparseMatConn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.FixedProb.html">brainpy.connect.FixedProb</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.FixedPreNum.html">brainpy.connect.FixedPreNum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.FixedPostNum.html">brainpy.connect.FixedPostNum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.FixedTotalNum.html">brainpy.connect.FixedTotalNum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.GaussianProb.html">brainpy.connect.GaussianProb</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.ProbDist.html">brainpy.connect.ProbDist</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.SmallWorld.html">brainpy.connect.SmallWorld</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.ScaleFreeBA.html">brainpy.connect.ScaleFreeBA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.ScaleFreeBADual.html">brainpy.connect.ScaleFreeBADual</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.PowerLaw.html">brainpy.connect.PowerLaw</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.One2One.html">brainpy.connect.one2one</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.All2All.html">brainpy.connect.all2all</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.GridFour.html">brainpy.connect.GridFour</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.GridEight.html">brainpy.connect.GridEight</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.GridN.html">brainpy.connect.GridN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.grid_four.html">brainpy.connect.grid_four</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.connect.grid_eight.html">brainpy.connect.grid_eight</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../apis/auto/encoding.html"><code class="docutils literal notranslate"><span class="pre">brainpy.encoding</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-18"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.encoding.Encoder.html">brainpy.encoding.Encoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.encoding.LatencyEncoder.html">brainpy.encoding.LatencyEncoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.encoding.WeightedPhaseEncoder.html">brainpy.encoding.WeightedPhaseEncoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.encoding.PoissonEncoder.html">brainpy.encoding.PoissonEncoder</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../apis/auto/initialize.html"><code class="docutils literal notranslate"><span class="pre">brainpy.initialize</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-19"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.initialize.Initializer.html">brainpy.initialize.Initializer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.initialize.InterLayerInitializer.html">brainpy.initialize.InterLayerInitializer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.initialize.IntraLayerInitializer.html">brainpy.initialize.IntraLayerInitializer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.initialize.ZeroInit.html">brainpy.initialize.ZeroInit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.initialize.Constant.html">brainpy.initialize.Constant</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.initialize.OneInit.html">brainpy.initialize.OneInit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.initialize.Identity.html">brainpy.initialize.Identity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.initialize.Normal.html">brainpy.initialize.Normal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.initialize.Uniform.html">brainpy.initialize.Uniform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.initialize.VarianceScaling.html">brainpy.initialize.VarianceScaling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.initialize.KaimingUniform.html">brainpy.initialize.KaimingUniform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.initialize.KaimingNormal.html">brainpy.initialize.KaimingNormal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.initialize.XavierUniform.html">brainpy.initialize.XavierUniform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.initialize.XavierNormal.html">brainpy.initialize.XavierNormal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.initialize.LecunUniform.html">brainpy.initialize.LecunUniform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.initialize.LecunNormal.html">brainpy.initialize.LecunNormal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.initialize.Orthogonal.html">brainpy.initialize.Orthogonal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.initialize.DeltaOrthogonal.html">brainpy.initialize.DeltaOrthogonal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.initialize.GaussianDecay.html">brainpy.initialize.GaussianDecay</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.initialize.DOGDecay.html">brainpy.initialize.DOGDecay</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../apis/auto/inputs.html"><code class="docutils literal notranslate"><span class="pre">brainpy.inputs</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-20"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.inputs.section_input.html">brainpy.inputs.section_input</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.inputs.constant_input.html">brainpy.inputs.constant_input</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.inputs.spike_input.html">brainpy.inputs.spike_input</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.inputs.ramp_input.html">brainpy.inputs.ramp_input</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.inputs.wiener_process.html">brainpy.inputs.wiener_process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.inputs.ou_process.html">brainpy.inputs.ou_process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.inputs.sinusoidal_input.html">brainpy.inputs.sinusoidal_input</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.inputs.square_input.html">brainpy.inputs.square_input</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../apis/auto/losses.html"><code class="docutils literal notranslate"><span class="pre">brainpy.losses</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-21"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.losses.cross_entropy_loss.html">brainpy.losses.cross_entropy_loss</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.losses.cross_entropy_sparse.html">brainpy.losses.cross_entropy_sparse</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.losses.cross_entropy_sigmoid.html">brainpy.losses.cross_entropy_sigmoid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.losses.l1_loos.html">brainpy.losses.l1_loos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.losses.l2_loss.html">brainpy.losses.l2_loss</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.losses.huber_loss.html">brainpy.losses.huber_loss</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.losses.mean_absolute_error.html">brainpy.losses.mean_absolute_error</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.losses.mean_squared_error.html">brainpy.losses.mean_squared_error</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.losses.mean_squared_log_error.html">brainpy.losses.mean_squared_log_error</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.losses.binary_logistic_loss.html">brainpy.losses.binary_logistic_loss</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.losses.multiclass_logistic_loss.html">brainpy.losses.multiclass_logistic_loss</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.losses.sigmoid_binary_cross_entropy.html">brainpy.losses.sigmoid_binary_cross_entropy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.losses.softmax_cross_entropy.html">brainpy.losses.softmax_cross_entropy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.losses.log_cosh_loss.html">brainpy.losses.log_cosh_loss</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.losses.ctc_loss_with_forward_probs.html">brainpy.losses.ctc_loss_with_forward_probs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.losses.ctc_loss.html">brainpy.losses.ctc_loss</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.losses.l2_norm.html">brainpy.losses.l2_norm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.losses.mean_absolute.html">brainpy.losses.mean_absolute</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.losses.mean_square.html">brainpy.losses.mean_square</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.losses.log_cosh.html">brainpy.losses.log_cosh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.losses.smooth_labels.html">brainpy.losses.smooth_labels</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../apis/auto/measure.html"><code class="docutils literal notranslate"><span class="pre">brainpy.measure</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-22"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.measure.cross_correlation.html">brainpy.measure.cross_correlation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.measure.voltage_fluctuation.html">brainpy.measure.voltage_fluctuation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.measure.matrix_correlation.html">brainpy.measure.matrix_correlation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.measure.weighted_correlation.html">brainpy.measure.weighted_correlation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.measure.functional_connectivity.html">brainpy.measure.functional_connectivity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.measure.raster_plot.html">brainpy.measure.raster_plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.measure.firing_rate.html">brainpy.measure.firing_rate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.measure.unitary_LFP.html">brainpy.measure.unitary_LFP</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../apis/auto/optim.html"><code class="docutils literal notranslate"><span class="pre">brainpy.optim</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-23"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.optim.Optimizer.html">brainpy.optim.Optimizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.optim.SGD.html">brainpy.optim.SGD</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.optim.Momentum.html">brainpy.optim.Momentum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.optim.MomentumNesterov.html">brainpy.optim.MomentumNesterov</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.optim.Adagrad.html">brainpy.optim.Adagrad</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.optim.Adadelta.html">brainpy.optim.Adadelta</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.optim.RMSProp.html">brainpy.optim.RMSProp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.optim.Adam.html">brainpy.optim.Adam</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.optim.LARS.html">brainpy.optim.LARS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.optim.Adan.html">brainpy.optim.Adan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.optim.AdamW.html">brainpy.optim.AdamW</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.optim.make_schedule.html">brainpy.optim.make_schedule</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.optim.Scheduler.html">brainpy.optim.Scheduler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.optim.Constant.html">brainpy.optim.Constant</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.optim.StepLR.html">brainpy.optim.StepLR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.optim.MultiStepLR.html">brainpy.optim.MultiStepLR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.optim.CosineAnnealingLR.html">brainpy.optim.CosineAnnealingLR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.optim.CosineAnnealingWarmRestarts.html">brainpy.optim.CosineAnnealingWarmRestarts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.optim.ExponentialLR.html">brainpy.optim.ExponentialLR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.optim.ExponentialDecay.html">brainpy.optim.ExponentialDecay</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.optim.InverseTimeDecay.html">brainpy.optim.InverseTimeDecay</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.optim.PolynomialDecay.html">brainpy.optim.PolynomialDecay</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.optim.PiecewiseConstant.html">brainpy.optim.PiecewiseConstant</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../apis/auto/running.html"><code class="docutils literal notranslate"><span class="pre">brainpy.running</span></code> module</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-24"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.running.jax_vectorize_map.html">brainpy.running.jax_vectorize_map</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.running.jax_parallelize_map.html">brainpy.running.jax_parallelize_map</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.running.process_pool.html">brainpy.running.process_pool</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.running.process_pool_lock.html">brainpy.running.process_pool_lock</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.running.cpu_ordered_parallel.html">brainpy.running.cpu_ordered_parallel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apis/auto/generated/brainpy.running.cpu_unordered_parallel.html">brainpy.running.cpu_unordered_parallel</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../apis/auto/changelog.html">Release notes (brainpy)</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/quickstart/simulation.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Simulating a Brain Dynamics Model</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simulating-an-e-i-balanced-network">Simulating an E-I balanced network</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#building-an-e-i-balanced-network">Building an E-I balanced network</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#running-a-simulation">Running a simulation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simulating-a-decision-making-network">Simulating a decision-making network</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#building-a-decision-making-network">Building a decision-making network</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Running a simulation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simulating-a-firing-rate-based-network">Simulating a firing rate-based network</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#neural-mass-model">Neural mass model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#whole-brain-model">Whole-brain model</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="simulating-a-brain-dynamics-model">
<h1>Simulating a Brain Dynamics Model<a class="headerlink" href="#simulating-a-brain-dynamics-model" title="Permalink to this heading">#</a></h1>
<p>&#64;<a class="reference external" href="mailto:c-xy17&#37;&#52;&#48;tsinghua&#46;org&#46;cn">Xiaoyu Chen</a> &#64;<a class="reference external" href="https://github.com/chaoming0625">Chaoming Wang</a></p>
<p>One of the most important approaches of studying brain dynamics is building a dynamic model and doing simulation. Generally, there are two ways to construct a dynamic model. The first one is called spiking models, which attempt to finely simulate the activity of each neuron in the target population. They are named spiking models because the simulation process records the precise timing of spiking of every neuron. The second is called rate models, which regard a population of neurons with similar properties as a single firing unit and examine the firing rate of this population. In this section, we will illustrate how to build and simulate a spiking neural network, e.i. SNN.</p>
<p>To begin with, the BrainPy package should be imported:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">brainpy</span> <span class="k">as</span> <span class="nn">bp</span>
<span class="kn">import</span> <span class="nn">brainpy.math</span> <span class="k">as</span> <span class="nn">bm</span>

<span class="c1"># bm.set_platform(&#39;cpu&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bp</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;2.3.1&#39;
</pre></div>
</div>
</div>
</div>
<section id="simulating-an-e-i-balanced-network">
<h2>Simulating an E-I balanced network<a class="headerlink" href="#simulating-an-e-i-balanced-network" title="Permalink to this heading">#</a></h2>
<section id="building-an-e-i-balanced-network">
<h3>Building an E-I balanced network<a class="headerlink" href="#building-an-e-i-balanced-network" title="Permalink to this heading">#</a></h3>
<p>Firstly, let’s try to build an E-I balanced network. It was proposed to interpret the irregular firing of neurons in the cortical area [1]. Since the structure of an E-I balanced network is relatively simple, it is a good practice that helps users to learn the basic paradigm of brain dynamic simulation in BrainPy. The structure of a E-I balanced network is as follows:</p>
<center><img src="../_static/E_I_balance_network.png" width="400 px"></center>
<center>The stucture of an E-I Balanced Network</center><p>An E-I balanced network is composed of two neuron groups and the synaptic connections between them. Specifically, they include:</p>
<ol class="arabic simple">
<li><p>a group of excitatory neurons, <span class="math notranslate nohighlight">\(\mathrm{E}\)</span>,</p></li>
<li><p>a group of inhibitory neurons, <span class="math notranslate nohighlight">\(\mathrm{I}\)</span>,</p></li>
<li><p>synaptic connections within the excitatory and inhibitory neuron groups, respectively, and</p></li>
<li><p>the inter-connections between these two groups.</p></li>
</ol>
<p>To construct the network, we need to define these components one by one. BrainPy provides plenty of handy built-in models for brain dynamic simulation. They are contained in <code class="docutils literal notranslate"><span class="pre">brainpy.dyn</span></code>. Let’s choose the simplest yet the most canonical neuron model, the Leaky Integrate-and-Fire (LIF) model, to build the excitatory and inhibitory neuron groups:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">neurons</span><span class="o">.</span><span class="n">LIF</span><span class="p">(</span><span class="mi">3200</span><span class="p">,</span> <span class="n">V_rest</span><span class="o">=-</span><span class="mf">60.</span><span class="p">,</span> <span class="n">V_th</span><span class="o">=-</span><span class="mf">50.</span><span class="p">,</span> <span class="n">V_reset</span><span class="o">=-</span><span class="mf">60.</span><span class="p">,</span>
                   <span class="n">tau</span><span class="o">=</span><span class="mf">20.</span><span class="p">,</span> <span class="n">tau_ref</span><span class="o">=</span><span class="mf">5.</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;exp_auto&#39;</span><span class="p">,</span>
                   <span class="n">V_initializer</span><span class="o">=</span><span class="n">bp</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="o">-</span><span class="mf">60.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">))</span>

<span class="n">I</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">neurons</span><span class="o">.</span><span class="n">LIF</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="n">V_rest</span><span class="o">=-</span><span class="mf">60.</span><span class="p">,</span> <span class="n">V_th</span><span class="o">=-</span><span class="mf">50.</span><span class="p">,</span> <span class="n">V_reset</span><span class="o">=-</span><span class="mf">60.</span><span class="p">,</span>
                   <span class="n">tau</span><span class="o">=</span><span class="mf">20.</span><span class="p">,</span> <span class="n">tau_ref</span><span class="o">=</span><span class="mf">5.</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;exp_auto&#39;</span><span class="p">,</span>
                   <span class="n">V_initializer</span><span class="o">=</span><span class="n">bp</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="o">-</span><span class="mf">60.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>When defining the LIF neuron group, the parameters can be tuned according to users’ need. The first parameter denotes the number of neurons. Here the ratio of excitatory and inhibitory neurons is set to 4:1. <code class="docutils literal notranslate"><span class="pre">V_rest</span></code> denotes the resting potential, <code class="docutils literal notranslate"><span class="pre">V_th</span></code> denotes the firing threshold, <code class="docutils literal notranslate"><span class="pre">V_reset</span></code> denotes the reset value after firing, <code class="docutils literal notranslate"><span class="pre">tau</span></code> is the time constant, and <code class="docutils literal notranslate"><span class="pre">tau_ref</span></code> is the duration of the refractory period. <code class="docutils literal notranslate"><span class="pre">method</span></code> refers to the numerical integration method to be used in simulation.</p>
<p>Then the synaptic connections between these two groups can be defined as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E2E</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">FixedProb</span><span class="p">(</span><span class="n">prob</span><span class="o">=</span><span class="mf">0.02</span><span class="p">),</span> <span class="n">g_max</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
                              <span class="n">tau</span><span class="o">=</span><span class="mf">5.</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="n">bp</span><span class="o">.</span><span class="n">synouts</span><span class="o">.</span><span class="n">COBA</span><span class="p">(</span><span class="n">E</span><span class="o">=</span><span class="mf">0.</span><span class="p">),</span>
                              <span class="n">method</span><span class="o">=</span><span class="s1">&#39;exp_auto&#39;</span><span class="p">)</span>

<span class="n">E2I</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">FixedProb</span><span class="p">(</span><span class="n">prob</span><span class="o">=</span><span class="mf">0.02</span><span class="p">),</span> <span class="n">g_max</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
                              <span class="n">tau</span><span class="o">=</span><span class="mf">5.</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="n">bp</span><span class="o">.</span><span class="n">synouts</span><span class="o">.</span><span class="n">COBA</span><span class="p">(</span><span class="n">E</span><span class="o">=</span><span class="mf">0.</span><span class="p">),</span>
                              <span class="n">method</span><span class="o">=</span><span class="s1">&#39;exp_auto&#39;</span><span class="p">)</span>

<span class="n">I2E</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">FixedProb</span><span class="p">(</span><span class="n">prob</span><span class="o">=</span><span class="mf">0.02</span><span class="p">),</span> <span class="n">g_max</span><span class="o">=</span><span class="mf">6.7</span><span class="p">,</span>
                              <span class="n">tau</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="n">bp</span><span class="o">.</span><span class="n">synouts</span><span class="o">.</span><span class="n">COBA</span><span class="p">(</span><span class="n">E</span><span class="o">=-</span><span class="mf">80.</span><span class="p">),</span>
                              <span class="n">method</span><span class="o">=</span><span class="s1">&#39;exp_auto&#39;</span><span class="p">)</span>

<span class="n">I2I</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">FixedProb</span><span class="p">(</span><span class="n">prob</span><span class="o">=</span><span class="mf">0.02</span><span class="p">),</span> <span class="n">g_max</span><span class="o">=</span><span class="mf">6.7</span><span class="p">,</span>
                              <span class="n">tau</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="n">bp</span><span class="o">.</span><span class="n">synouts</span><span class="o">.</span><span class="n">COBA</span><span class="p">(</span><span class="n">E</span><span class="o">=-</span><span class="mf">80.</span><span class="p">),</span>
                              <span class="n">method</span><span class="o">=</span><span class="s1">&#39;exp_auto&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Here we use the Exponential synapse model (<code class="docutils literal notranslate"><span class="pre">bp.synapses.Exponential</span></code>) to simulate synaptic connections. Among the parameters of the model, the first two denotes the pre- and post-synaptic neuron groups, respectively. The third one refers to the connection types. In this example, we use <code class="docutils literal notranslate"><span class="pre">bp.conn.FixedProb</span></code>, which connects the presynaptic neurons to postsynaptic neurons with a given probability (detailed information is available in <a class="reference internal" href="../tutorial_toolbox/synaptic_connections.html"><span class="doc std std-doc">Synaptic Connection</span></a>). The following three parameters describes the dynamic properties of the synapse, and the last one is the numerical integration method as that in the LIF model.</p>
<p>After defining all the components, they can be combined to form a network:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">net</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">Network</span><span class="p">(</span><span class="n">E2E</span><span class="p">,</span> <span class="n">E2I</span><span class="p">,</span> <span class="n">I2E</span><span class="p">,</span> <span class="n">I2I</span><span class="p">,</span> <span class="n">E</span><span class="o">=</span><span class="n">E</span><span class="p">,</span> <span class="n">I</span><span class="o">=</span><span class="n">I</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In the definition, neurons and synapses are given to the network. The excitatory and inhibitory neuron groups (<code class="docutils literal notranslate"><span class="pre">E</span></code> and <code class="docutils literal notranslate"><span class="pre">I</span></code>) are passed with a name, for they will be specifically operated in the simulation (here they will be given with input currents).</p>
<p>We have successfully constructed an E-I balanced network by using BrainPy’s biult-in models. On the other hand, BrianPy also enables users to customize their own dynamic models such as neuron groups, synapses, and networks flexibly. In fact, <code class="docutils literal notranslate"><span class="pre">brainpy.dyn.Network()</span></code> is a simple example of customizing a network model. Please refer to <a class="reference internal" href="../tutorial_simulation/index.html"><span class="doc std std-doc">Dynamic Simulation</span></a> for more information.</p>
</section>
<section id="running-a-simulation">
<h3>Running a simulation<a class="headerlink" href="#running-a-simulation" title="Permalink to this heading">#</a></h3>
<p>After building a SNN, we can use it for dynamic simulation. To run a simulation, we need to wrap the network model into a <strong>runner</strong> first. BrainPy provides <code class="docutils literal notranslate"><span class="pre">DSRunner</span></code> in <code class="docutils literal notranslate"><span class="pre">brainpy.dyn</span></code>, which will be expanded in the <a class="reference internal" href="../tutorial_simulation/index.html"><span class="doc std std-doc">Runners</span></a> tutorial. Users can initialize <code class="docutils literal notranslate"><span class="pre">DSRunner</span></code> as followed:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">runner</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">DSRunner</span><span class="p">(</span><span class="n">net</span><span class="p">,</span>
                     <span class="n">monitors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;E.spike&#39;</span><span class="p">,</span> <span class="s1">&#39;I.spike&#39;</span><span class="p">],</span>
                     <span class="n">inputs</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;E.input&#39;</span><span class="p">,</span> <span class="mf">20.</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;I.input&#39;</span><span class="p">,</span> <span class="mf">20.</span><span class="p">)],</span>
                     <span class="n">dt</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>To make dynamic simulation more applicable and powerful, users can monitor variable trajectories and give inputs to target neuron groups. Here we monitor the <code class="docutils literal notranslate"><span class="pre">spike</span></code> variable in the <code class="docutils literal notranslate"><span class="pre">E</span></code> and <code class="docutils literal notranslate"><span class="pre">I</span></code> LIF model, which refers to the spking status of the neuron group, and give a constant input to both neuron groups. The time interval of numerical integration <code class="docutils literal notranslate"><span class="pre">dt</span></code> (with the default value of 0.1) can also be specified.</p>
<p>More details of how to give inputs and monitors please refer to <a class="reference internal" href="../tutorial_simulation/index.html"><span class="doc std std-doc">Dynamic Simulation</span></a>.</p>
<p>After creating the runner, we can run a simulation by calling the runner:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "d67019e143c5420a9db97ff5ce1d985c"}</script></div>
</div>
<p>where the calling function receives the simulation time (usually in milliseconds) as the input. BrainPy achieves an extraordinary simulation speed with the assistance of just-in-time (JIT) compilation. Please refer to <span class="xref myst">Just-In-Time Compilation</span> for more details.</p>
<p>The simulation results are stored as NumPy arrays in the monitors, and can be visualized easily:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">bp</span><span class="o">.</span><span class="n">visualize</span><span class="o">.</span><span class="n">raster_plot</span><span class="p">(</span><span class="n">runner</span><span class="o">.</span><span class="n">mon</span><span class="o">.</span><span class="n">ts</span><span class="p">,</span> <span class="n">runner</span><span class="o">.</span><span class="n">mon</span><span class="p">[</span><span class="s1">&#39;E.spike&#39;</span><span class="p">],</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">bp</span><span class="o">.</span><span class="n">visualize</span><span class="o">.</span><span class="n">raster_plot</span><span class="p">(</span><span class="n">runner</span><span class="o">.</span><span class="n">mon</span><span class="o">.</span><span class="n">ts</span><span class="p">,</span> <span class="n">runner</span><span class="o">.</span><span class="n">mon</span><span class="p">[</span><span class="s1">&#39;I.spike&#39;</span><span class="p">],</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2d47ee34e7c19207de179b26305f42a30adf055066484a565b2e95ef2cb5d743.png" src="../_images/2d47ee34e7c19207de179b26305f42a30adf055066484a565b2e95ef2cb5d743.png" />
</div>
</div>
<p>In the code above, <code class="docutils literal notranslate"><span class="pre">brianpy.visualize</span></code> contains some useful functions to visualize simulation results based on the <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> package. Since the simulation results are stored as NumPy arrays, users can directly use <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> for visualization.</p>
</section>
</section>
<section id="simulating-a-decision-making-network">
<h2>Simulating a decision-making network<a class="headerlink" href="#simulating-a-decision-making-network" title="Permalink to this heading">#</a></h2>
<section id="building-a-decision-making-network">
<h3>Building a decision-making network<a class="headerlink" href="#building-a-decision-making-network" title="Permalink to this heading">#</a></h3>
<p>After learning how to build a E-I balanced network, we can try to handle a more complex model. In 2002, Wang proposed a decision-making model that could choose between two conflict inputs by accumulating evidence over time [2].</p>
<p>The structure of a decision-making network is as follows. Similar to the E-I balanced network, the decision-making network contains an excitatory and an inhibitory neuron group, forming connections within each group and between each other. What is different is that there are two specific subpopulation of neurons, A and B, that receive conflict inputs from outside (other brain areas). After given the external inputs, if the activity of A prevail over B, it means the network chooses option A, and vice versa.</p>
<center><img src="../_static/dmnet_diagram.png" width="400 px"></center>
<center>The stucture of an E-I Balanced Network</center><p>To construct a decision-making network, we should build all neuron groups:</p>
<ol class="arabic simple">
<li><p>Two excitatory neuron groups with different selectivity, <span class="math notranslate nohighlight">\(\mathrm{A}\)</span> and <span class="math notranslate nohighlight">\(\mathrm{B}\)</span>, and other excitatory neurons, <span class="math notranslate nohighlight">\(\mathrm{N}\)</span>;</p></li>
<li><p>An inhibitory neuron group, <span class="math notranslate nohighlight">\(\mathrm{I}\)</span>;</p></li>
<li><p>Neurons generating external inputs <span class="math notranslate nohighlight">\(\mathrm{I_A}\)</span> and <span class="math notranslate nohighlight">\(\mathrm{I_B}\)</span>;</p></li>
<li><p>Neurons generating noise to all neuron groups, <span class="math notranslate nohighlight">\(\mathrm{noise_A}\)</span>, <span class="math notranslate nohighlight">\(\mathrm{noise_B}\)</span>, <span class="math notranslate nohighlight">\(\mathrm{noise_N}\)</span>, and <span class="math notranslate nohighlight">\(\mathrm{noise_I}\)</span>.</p></li>
</ol>
<p>And the synapse connection between them:</p>
<ol class="arabic simple">
<li><p>Connection from excitatory neurons to others, <span class="math notranslate nohighlight">\(\mathrm{A2A}\)</span>, <span class="math notranslate nohighlight">\(\mathrm{A2B}\)</span>, <span class="math notranslate nohighlight">\(\mathrm{A2N}\)</span>, <span class="math notranslate nohighlight">\(\mathrm{A2I}\)</span>, <span class="math notranslate nohighlight">\(\mathrm{B2A}\)</span>, <span class="math notranslate nohighlight">\(\mathrm{B2B}\)</span>, <span class="math notranslate nohighlight">\(\mathrm{B2N}\)</span>, <span class="math notranslate nohighlight">\(\mathrm{B2I}\)</span>, and <span class="math notranslate nohighlight">\(\mathrm{N2A}\)</span>, <span class="math notranslate nohighlight">\(\mathrm{N2B}\)</span>, <span class="math notranslate nohighlight">\(\mathrm{N2N}\)</span>, <span class="math notranslate nohighlight">\(\mathrm{N2I}\)</span>;</p></li>
<li><p>Connection from inhibitory neurons to others, <span class="math notranslate nohighlight">\(\mathrm{I2A}\)</span>, <span class="math notranslate nohighlight">\(\mathrm{I2B}\)</span>, <span class="math notranslate nohighlight">\(\mathrm{I2N}\)</span>, <span class="math notranslate nohighlight">\(\mathrm{I2I}\)</span>;</p></li>
<li><p>Connection from external inputs to selective neuron groups, <span class="math notranslate nohighlight">\(\mathrm{IA2A}\)</span>, <span class="math notranslate nohighlight">\(\mathrm{IB2B}\)</span>;</p></li>
<li><p>Connection from noise neurons to excitatory and inhibitory neurons, <span class="math notranslate nohighlight">\(\mathrm{noise2A}\)</span>, <span class="math notranslate nohighlight">\(\mathrm{noise2B}\)</span>, <span class="math notranslate nohighlight">\(\mathrm{noise2N}\)</span>, <span class="math notranslate nohighlight">\(\mathrm{noise2I}\)</span>.</p></li>
</ol>
<p>Now let’s build these neuron groups and connections.</p>
<p>First of all, to imitate the biophysical experiments, we define three periods:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pre_stimulus_period</span> <span class="o">=</span> <span class="mf">100.</span>  <span class="c1"># time before the external simuli are given</span>
<span class="n">stimulus_period</span> <span class="o">=</span> <span class="mf">1000.</span>  <span class="c1"># time within which the external simuli are given</span>
<span class="n">delay_period</span> <span class="o">=</span> <span class="mf">500.</span>  <span class="c1"># time after the external simuli are removed</span>
<span class="n">total_period</span> <span class="o">=</span> <span class="n">pre_stimulus_period</span> <span class="o">+</span> <span class="n">stimulus_period</span> <span class="o">+</span> <span class="n">delay_period</span>
</pre></div>
</div>
</div>
</div>
<p>To build <span class="math notranslate nohighlight">\(\mathrm{I_A}\)</span> and <span class="math notranslate nohighlight">\(\mathrm{I_B}\)</span>, we shall define a class of neuron groups that can generate stochastic Possion stimulu. To define neuron groups, they should inherit from <code class="docutils literal notranslate"><span class="pre">brainpy.dyn.NeuGroup</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">PoissonStim</span><span class="p">(</span><span class="n">bp</span><span class="o">.</span><span class="n">NeuGroup</span><span class="p">):</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">freq_mean</span><span class="p">,</span> <span class="n">freq_var</span><span class="p">,</span> <span class="n">t_interval</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">PoissonStim</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># initialize parameters</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">freq_mean</span> <span class="o">=</span> <span class="n">freq_mean</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">freq_var</span> <span class="o">=</span> <span class="n">freq_var</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">t_interval</span> <span class="o">=</span> <span class="n">t_interval</span>

    <span class="c1"># initialize variables</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">freq</span> <span class="o">=</span> <span class="n">bm</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">bm</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">freq_t_last_change</span> <span class="o">=</span> <span class="n">bm</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">bm</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1e7</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">spike</span> <span class="o">=</span> <span class="n">bm</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">bm</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rng</span> <span class="o">=</span> <span class="n">bm</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tdi</span><span class="p">):</span>
    <span class="n">in_interval</span> <span class="o">=</span> <span class="n">bm</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">pre_stimulus_period</span> <span class="o">&lt;</span> <span class="n">tdi</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">tdi</span><span class="o">.</span><span class="n">t</span> <span class="o">&lt;</span> <span class="n">pre_stimulus_period</span> <span class="o">+</span> <span class="n">stimulus_period</span><span class="p">)</span>
    <span class="n">freq</span> <span class="o">=</span> <span class="n">bm</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">in_interval</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">freq</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">change</span> <span class="o">=</span> <span class="n">bm</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">in_interval</span><span class="p">,</span> <span class="p">(</span><span class="n">tdi</span><span class="o">.</span><span class="n">t</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">freq_t_last_change</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_interval</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">freq</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">bm</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">change</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">freq_mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">freq_var</span><span class="p">),</span> <span class="n">freq</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">freq_t_last_change</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">bm</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">change</span><span class="p">,</span> <span class="n">tdi</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">freq_t_last_change</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">spike</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">freq</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">tdi</span><span class="o">.</span><span class="n">dt</span> <span class="o">/</span> <span class="mf">1000.</span>
</pre></div>
</div>
</div>
</div>
<p>Because there are too many neuron groups and connections, it will be much clearer if we define a new network class inheriting <code class="docutils literal notranslate"><span class="pre">brainpy.dyn.Network</span></code> to accommodate all these neurons and synapses:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">DecisionMaking</span><span class="p">(</span><span class="n">bp</span><span class="o">.</span><span class="n">Network</span><span class="p">):</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">mu0</span><span class="o">=</span><span class="mf">40.</span><span class="p">,</span> <span class="n">coherence</span><span class="o">=</span><span class="mf">25.6</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">bm</span><span class="o">.</span><span class="n">get_dt</span><span class="p">()):</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">DecisionMaking</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="c1"># initialize neuron-group parameters</span>
    <span class="n">num_exc</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1600</span> <span class="o">*</span> <span class="n">scale</span><span class="p">)</span>
    <span class="n">num_inh</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">400</span> <span class="o">*</span> <span class="n">scale</span><span class="p">)</span>
    <span class="n">num_A</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">f</span> <span class="o">*</span> <span class="n">num_exc</span><span class="p">)</span>
    <span class="n">num_B</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">f</span> <span class="o">*</span> <span class="n">num_exc</span><span class="p">)</span>
    <span class="n">num_N</span> <span class="o">=</span> <span class="n">num_exc</span> <span class="o">-</span> <span class="n">num_A</span> <span class="o">-</span> <span class="n">num_B</span>
    <span class="n">poisson_freq</span> <span class="o">=</span> <span class="mf">2400.</span>  <span class="c1"># Hz</span>

    <span class="c1"># initialize synapse parameters</span>
    <span class="n">w_pos</span> <span class="o">=</span> <span class="mf">1.7</span>
    <span class="n">w_neg</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">f</span> <span class="o">*</span> <span class="p">(</span><span class="n">w_pos</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span>
    <span class="n">g_ext2E_AMPA</span> <span class="o">=</span> <span class="mf">2.1</span>  <span class="c1"># nS</span>
    <span class="n">g_ext2I_AMPA</span> <span class="o">=</span> <span class="mf">1.62</span>  <span class="c1"># nS</span>
    <span class="n">g_E2E_AMPA</span> <span class="o">=</span> <span class="mf">0.05</span> <span class="o">/</span> <span class="n">scale</span>  <span class="c1"># nS</span>
    <span class="n">g_E2I_AMPA</span> <span class="o">=</span> <span class="mf">0.04</span> <span class="o">/</span> <span class="n">scale</span>  <span class="c1"># nS</span>
    <span class="n">g_E2E_NMDA</span> <span class="o">=</span> <span class="mf">0.165</span> <span class="o">/</span> <span class="n">scale</span>  <span class="c1"># nS</span>
    <span class="n">g_E2I_NMDA</span> <span class="o">=</span> <span class="mf">0.13</span> <span class="o">/</span> <span class="n">scale</span>  <span class="c1"># nS</span>
    <span class="n">g_I2E_GABAa</span> <span class="o">=</span> <span class="mf">1.3</span> <span class="o">/</span> <span class="n">scale</span>  <span class="c1"># nS</span>
    <span class="n">g_I2I_GABAa</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">scale</span>  <span class="c1"># nS</span>

    <span class="c1"># parameters of the AMPA synapse</span>
    <span class="n">ampa_par</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">delay_step</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">/</span> <span class="n">dt</span><span class="p">),</span> <span class="n">tau</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="n">bp</span><span class="o">.</span><span class="n">synouts</span><span class="o">.</span><span class="n">COBA</span><span class="p">(</span><span class="n">E</span><span class="o">=</span><span class="mf">0.</span><span class="p">))</span>

    <span class="c1"># parameters of the GABA synapse</span>
    <span class="n">gaba_par</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">delay_step</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">/</span> <span class="n">dt</span><span class="p">),</span> <span class="n">tau</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="n">bp</span><span class="o">.</span><span class="n">synouts</span><span class="o">.</span><span class="n">COBA</span><span class="p">(</span><span class="n">E</span><span class="o">=-</span><span class="mf">70.</span><span class="p">))</span>

    <span class="c1"># parameters of the NMDA synapse</span>
    <span class="n">nmda_par</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">delay_step</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">/</span> <span class="n">dt</span><span class="p">),</span> <span class="n">tau_decay</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">tau_rise</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span>
                    <span class="n">a</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="n">bp</span><span class="o">.</span><span class="n">synouts</span><span class="o">.</span><span class="n">MgBlock</span><span class="p">(</span><span class="n">E</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">cc_Mg</span><span class="o">=</span><span class="mf">1.</span><span class="p">))</span>

    <span class="c1"># excitatory and inhibitory neuron groups, A, B, N, and I</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">neurons</span><span class="o">.</span><span class="n">LIF</span><span class="p">(</span><span class="n">num_A</span><span class="p">,</span> <span class="n">V_rest</span><span class="o">=-</span><span class="mf">70.</span><span class="p">,</span> <span class="n">V_reset</span><span class="o">=-</span><span class="mf">55.</span><span class="p">,</span> <span class="n">V_th</span><span class="o">=-</span><span class="mf">50.</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="mf">20.</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mf">0.04</span><span class="p">,</span>
                       <span class="n">tau_ref</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">V_initializer</span><span class="o">=</span><span class="n">bp</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">OneInit</span><span class="p">(</span><span class="o">-</span><span class="mf">70.</span><span class="p">))</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">neurons</span><span class="o">.</span><span class="n">LIF</span><span class="p">(</span><span class="n">num_B</span><span class="p">,</span> <span class="n">V_rest</span><span class="o">=-</span><span class="mf">70.</span><span class="p">,</span> <span class="n">V_reset</span><span class="o">=-</span><span class="mf">55.</span><span class="p">,</span> <span class="n">V_th</span><span class="o">=-</span><span class="mf">50.</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="mf">20.</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mf">0.04</span><span class="p">,</span>
                       <span class="n">tau_ref</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">V_initializer</span><span class="o">=</span><span class="n">bp</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">OneInit</span><span class="p">(</span><span class="o">-</span><span class="mf">70.</span><span class="p">))</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">neurons</span><span class="o">.</span><span class="n">LIF</span><span class="p">(</span><span class="n">num_N</span><span class="p">,</span> <span class="n">V_rest</span><span class="o">=-</span><span class="mf">70.</span><span class="p">,</span> <span class="n">V_reset</span><span class="o">=-</span><span class="mf">55.</span><span class="p">,</span> <span class="n">V_th</span><span class="o">=-</span><span class="mf">50.</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="mf">20.</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mf">0.04</span><span class="p">,</span>
                       <span class="n">tau_ref</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">V_initializer</span><span class="o">=</span><span class="n">bp</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">OneInit</span><span class="p">(</span><span class="o">-</span><span class="mf">70.</span><span class="p">))</span>
    <span class="n">I</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">neurons</span><span class="o">.</span><span class="n">LIF</span><span class="p">(</span><span class="n">num_inh</span><span class="p">,</span> <span class="n">V_rest</span><span class="o">=-</span><span class="mf">70.</span><span class="p">,</span> <span class="n">V_reset</span><span class="o">=-</span><span class="mf">55.</span><span class="p">,</span> <span class="n">V_th</span><span class="o">=-</span><span class="mf">50.</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
                       <span class="n">tau_ref</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">V_initializer</span><span class="o">=</span><span class="n">bp</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">OneInit</span><span class="p">(</span><span class="o">-</span><span class="mf">70.</span><span class="p">))</span>

    <span class="c1"># neurons generating external inputs, I_A and I_B</span>
    <span class="n">IA</span> <span class="o">=</span> <span class="n">PoissonStim</span><span class="p">(</span><span class="n">num_A</span><span class="p">,</span> <span class="n">freq_var</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">t_interval</span><span class="o">=</span><span class="mf">50.</span><span class="p">,</span> <span class="n">freq_mean</span><span class="o">=</span><span class="n">mu0</span> <span class="o">+</span> <span class="n">mu0</span> <span class="o">/</span> <span class="mf">100.</span> <span class="o">*</span> <span class="n">coherence</span><span class="p">)</span>
    <span class="n">IB</span> <span class="o">=</span> <span class="n">PoissonStim</span><span class="p">(</span><span class="n">num_B</span><span class="p">,</span> <span class="n">freq_var</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">t_interval</span><span class="o">=</span><span class="mf">50.</span><span class="p">,</span> <span class="n">freq_mean</span><span class="o">=</span><span class="n">mu0</span> <span class="o">-</span> <span class="n">mu0</span> <span class="o">/</span> <span class="mf">100.</span> <span class="o">*</span> <span class="n">coherence</span><span class="p">)</span>

    <span class="c1"># noise neurons</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">noise_A</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">neurons</span><span class="o">.</span><span class="n">PoissonGroup</span><span class="p">(</span><span class="n">num_A</span><span class="p">,</span> <span class="n">freqs</span><span class="o">=</span><span class="n">poisson_freq</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">noise_B</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">neurons</span><span class="o">.</span><span class="n">PoissonGroup</span><span class="p">(</span><span class="n">num_B</span><span class="p">,</span> <span class="n">freqs</span><span class="o">=</span><span class="n">poisson_freq</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">noise_N</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">neurons</span><span class="o">.</span><span class="n">PoissonGroup</span><span class="p">(</span><span class="n">num_N</span><span class="p">,</span> <span class="n">freqs</span><span class="o">=</span><span class="n">poisson_freq</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">noise_I</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">neurons</span><span class="o">.</span><span class="n">PoissonGroup</span><span class="p">(</span><span class="n">num_inh</span><span class="p">,</span> <span class="n">freqs</span><span class="o">=</span><span class="n">poisson_freq</span><span class="p">)</span>

    <span class="c1"># connection from excitatory neurons to others</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">N2B_AMPA</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">All2All</span><span class="p">(),</span> <span class="n">g_max</span><span class="o">=</span><span class="n">g_E2E_AMPA</span> <span class="o">*</span> <span class="n">w_neg</span><span class="p">,</span> <span class="o">**</span><span class="n">ampa_par</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">N2A_AMPA</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">All2All</span><span class="p">(),</span> <span class="n">g_max</span><span class="o">=</span><span class="n">g_E2E_AMPA</span> <span class="o">*</span> <span class="n">w_neg</span><span class="p">,</span> <span class="o">**</span><span class="n">ampa_par</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">N2N_AMPA</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">All2All</span><span class="p">(),</span> <span class="n">g_max</span><span class="o">=</span><span class="n">g_E2E_AMPA</span><span class="p">,</span> <span class="o">**</span><span class="n">ampa_par</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">N2I_AMPA</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">All2All</span><span class="p">(),</span> <span class="n">g_max</span><span class="o">=</span><span class="n">g_E2I_AMPA</span><span class="p">,</span> <span class="o">**</span><span class="n">ampa_par</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">N2B_NMDA</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">NMDA</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">All2All</span><span class="p">(),</span> <span class="n">g_max</span><span class="o">=</span><span class="n">g_E2E_NMDA</span> <span class="o">*</span> <span class="n">w_neg</span><span class="p">,</span> <span class="o">**</span><span class="n">nmda_par</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">N2A_NMDA</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">NMDA</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">All2All</span><span class="p">(),</span> <span class="n">g_max</span><span class="o">=</span><span class="n">g_E2E_NMDA</span> <span class="o">*</span> <span class="n">w_neg</span><span class="p">,</span> <span class="o">**</span><span class="n">nmda_par</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">N2N_NMDA</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">NMDA</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">All2All</span><span class="p">(),</span> <span class="n">g_max</span><span class="o">=</span><span class="n">g_E2E_NMDA</span><span class="p">,</span> <span class="o">**</span><span class="n">nmda_par</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">N2I_NMDA</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">NMDA</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">All2All</span><span class="p">(),</span> <span class="n">g_max</span><span class="o">=</span><span class="n">g_E2I_NMDA</span><span class="p">,</span> <span class="o">**</span><span class="n">nmda_par</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">B2B_AMPA</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">All2All</span><span class="p">(),</span> <span class="n">g_max</span><span class="o">=</span><span class="n">g_E2E_AMPA</span> <span class="o">*</span> <span class="n">w_pos</span><span class="p">,</span> <span class="o">**</span><span class="n">ampa_par</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">B2A_AMPA</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">All2All</span><span class="p">(),</span> <span class="n">g_max</span><span class="o">=</span><span class="n">g_E2E_AMPA</span> <span class="o">*</span> <span class="n">w_neg</span><span class="p">,</span> <span class="o">**</span><span class="n">ampa_par</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">B2N_AMPA</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">All2All</span><span class="p">(),</span> <span class="n">g_max</span><span class="o">=</span><span class="n">g_E2E_AMPA</span><span class="p">,</span> <span class="o">**</span><span class="n">ampa_par</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">B2I_AMPA</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">All2All</span><span class="p">(),</span> <span class="n">g_max</span><span class="o">=</span><span class="n">g_E2I_AMPA</span><span class="p">,</span> <span class="o">**</span><span class="n">ampa_par</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">B2B_NMDA</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">NMDA</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">All2All</span><span class="p">(),</span> <span class="n">g_max</span><span class="o">=</span><span class="n">g_E2E_NMDA</span> <span class="o">*</span> <span class="n">w_pos</span><span class="p">,</span> <span class="o">**</span><span class="n">nmda_par</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">B2A_NMDA</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">NMDA</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">All2All</span><span class="p">(),</span> <span class="n">g_max</span><span class="o">=</span><span class="n">g_E2E_NMDA</span> <span class="o">*</span> <span class="n">w_neg</span><span class="p">,</span> <span class="o">**</span><span class="n">nmda_par</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">B2N_NMDA</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">NMDA</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">All2All</span><span class="p">(),</span> <span class="n">g_max</span><span class="o">=</span><span class="n">g_E2E_NMDA</span><span class="p">,</span> <span class="o">**</span><span class="n">nmda_par</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">B2I_NMDA</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">NMDA</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">All2All</span><span class="p">(),</span> <span class="n">g_max</span><span class="o">=</span><span class="n">g_E2I_NMDA</span><span class="p">,</span> <span class="o">**</span><span class="n">nmda_par</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">A2B_AMPA</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">All2All</span><span class="p">(),</span> <span class="n">g_max</span><span class="o">=</span><span class="n">g_E2E_AMPA</span> <span class="o">*</span> <span class="n">w_neg</span><span class="p">,</span> <span class="o">**</span><span class="n">ampa_par</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">A2A_AMPA</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">All2All</span><span class="p">(),</span> <span class="n">g_max</span><span class="o">=</span><span class="n">g_E2E_AMPA</span> <span class="o">*</span> <span class="n">w_pos</span><span class="p">,</span> <span class="o">**</span><span class="n">ampa_par</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">A2N_AMPA</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">All2All</span><span class="p">(),</span> <span class="n">g_max</span><span class="o">=</span><span class="n">g_E2E_AMPA</span><span class="p">,</span> <span class="o">**</span><span class="n">ampa_par</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">A2I_AMPA</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">All2All</span><span class="p">(),</span> <span class="n">g_max</span><span class="o">=</span><span class="n">g_E2I_AMPA</span><span class="p">,</span> <span class="o">**</span><span class="n">ampa_par</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">A2B_NMDA</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">NMDA</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">All2All</span><span class="p">(),</span> <span class="n">g_max</span><span class="o">=</span><span class="n">g_E2E_NMDA</span> <span class="o">*</span> <span class="n">w_neg</span><span class="p">,</span> <span class="o">**</span><span class="n">nmda_par</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">A2A_NMDA</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">NMDA</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">All2All</span><span class="p">(),</span> <span class="n">g_max</span><span class="o">=</span><span class="n">g_E2E_NMDA</span> <span class="o">*</span> <span class="n">w_pos</span><span class="p">,</span> <span class="o">**</span><span class="n">nmda_par</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">A2N_NMDA</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">NMDA</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">All2All</span><span class="p">(),</span> <span class="n">g_max</span><span class="o">=</span><span class="n">g_E2E_NMDA</span><span class="p">,</span> <span class="o">**</span><span class="n">nmda_par</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">A2I_NMDA</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">NMDA</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">All2All</span><span class="p">(),</span> <span class="n">g_max</span><span class="o">=</span><span class="n">g_E2I_NMDA</span><span class="p">,</span> <span class="o">**</span><span class="n">nmda_par</span><span class="p">)</span>

    <span class="c1"># connection from inhibitory neurons to others</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">I2B</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">All2All</span><span class="p">(),</span> <span class="n">g_max</span><span class="o">=</span><span class="n">g_I2E_GABAa</span><span class="p">,</span> <span class="o">**</span><span class="n">gaba_par</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">I2A</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">All2All</span><span class="p">(),</span> <span class="n">g_max</span><span class="o">=</span><span class="n">g_I2E_GABAa</span><span class="p">,</span> <span class="o">**</span><span class="n">gaba_par</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">I2N</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">All2All</span><span class="p">(),</span> <span class="n">g_max</span><span class="o">=</span><span class="n">g_I2E_GABAa</span><span class="p">,</span> <span class="o">**</span><span class="n">gaba_par</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">I2I</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">All2All</span><span class="p">(),</span> <span class="n">g_max</span><span class="o">=</span><span class="n">g_I2I_GABAa</span><span class="p">,</span> <span class="o">**</span><span class="n">gaba_par</span><span class="p">)</span>

    <span class="c1"># connection from external inputs to selective neuron groups</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">IA2A</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="n">IA</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">One2One</span><span class="p">(),</span> <span class="n">g_max</span><span class="o">=</span><span class="n">g_ext2E_AMPA</span><span class="p">,</span> <span class="o">**</span><span class="n">ampa_par</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">IB2B</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="n">IB</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">One2One</span><span class="p">(),</span> <span class="n">g_max</span><span class="o">=</span><span class="n">g_ext2E_AMPA</span><span class="p">,</span> <span class="o">**</span><span class="n">ampa_par</span><span class="p">)</span>

    <span class="c1"># connectioni from noise neurons to excitatory and inhibitory neurons</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">noise2B</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">noise_B</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">One2One</span><span class="p">(),</span> <span class="n">g_max</span><span class="o">=</span><span class="n">g_ext2E_AMPA</span><span class="p">,</span> <span class="o">**</span><span class="n">ampa_par</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">noise2A</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">noise_A</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">One2One</span><span class="p">(),</span> <span class="n">g_max</span><span class="o">=</span><span class="n">g_ext2E_AMPA</span><span class="p">,</span> <span class="o">**</span><span class="n">ampa_par</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">noise2N</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">noise_N</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">One2One</span><span class="p">(),</span> <span class="n">g_max</span><span class="o">=</span><span class="n">g_ext2E_AMPA</span><span class="p">,</span> <span class="o">**</span><span class="n">ampa_par</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">noise2I</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">noise_I</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">bp</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">One2One</span><span class="p">(),</span> <span class="n">g_max</span><span class="o">=</span><span class="n">g_ext2I_AMPA</span><span class="p">,</span> <span class="o">**</span><span class="n">ampa_par</span><span class="p">)</span>

    <span class="c1"># add A, B, I, N to the class</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="n">A</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="o">=</span> <span class="n">B</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="n">N</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">I</span> <span class="o">=</span> <span class="n">I</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">IA</span> <span class="o">=</span> <span class="n">IA</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">IB</span> <span class="o">=</span> <span class="n">IB</span>
</pre></div>
</div>
</div>
</div>
<p>Though the code seems longer than the E-I balanced network, the basic building paradigm is the same: building neuron groups and the connections among them.</p>
</section>
<section id="id1">
<h3>Running a simulation<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<p>After building it, the simulation process will be much the same as running a E-I balanced network. First we should wrap the network into a runner:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">net</span> <span class="o">=</span> <span class="n">DecisionMaking</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">coherence</span><span class="o">=</span><span class="mf">25.6</span><span class="p">,</span> <span class="n">mu0</span><span class="o">=</span><span class="mf">40.</span><span class="p">)</span>
<span class="n">runner</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">DSRunner</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">monitors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A.spike&#39;</span><span class="p">,</span> <span class="s1">&#39;B.spike&#39;</span><span class="p">,</span> <span class="s1">&#39;IA.freq&#39;</span><span class="p">,</span> <span class="s1">&#39;IB.freq&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Then we call the runner to run the simulation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">total_period</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "ab016404b8a44572852243eb54a3732f"}</script></div>
</div>
<p>Finally, we visualize the simulation result by using <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">gs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">t_start</span> <span class="o">=</span> <span class="mf">0.</span>

<span class="c1"># the raster plot of A</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">bp</span><span class="o">.</span><span class="n">visualize</span><span class="o">.</span><span class="n">raster_plot</span><span class="p">(</span><span class="n">runner</span><span class="o">.</span><span class="n">mon</span><span class="o">.</span><span class="n">ts</span><span class="p">,</span> <span class="n">runner</span><span class="o">.</span><span class="n">mon</span><span class="p">[</span><span class="s1">&#39;A.spike&#39;</span><span class="p">],</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Spiking activity of group A&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Neuron Index&quot;</span><span class="p">)</span>

<span class="c1"># the raster plot of A</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">bp</span><span class="o">.</span><span class="n">visualize</span><span class="o">.</span><span class="n">raster_plot</span><span class="p">(</span><span class="n">runner</span><span class="o">.</span><span class="n">mon</span><span class="o">.</span><span class="n">ts</span><span class="p">,</span> <span class="n">runner</span><span class="o">.</span><span class="n">mon</span><span class="p">[</span><span class="s1">&#39;B.spike&#39;</span><span class="p">],</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Spiking activity of group B&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Neuron Index&quot;</span><span class="p">)</span>

<span class="c1"># the firing rate of A and B</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">rateA</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">measure</span><span class="o">.</span><span class="n">firing_rate</span><span class="p">(</span><span class="n">runner</span><span class="o">.</span><span class="n">mon</span><span class="p">[</span><span class="s1">&#39;A.spike&#39;</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mf">10.</span><span class="p">)</span>
<span class="n">rateB</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">measure</span><span class="o">.</span><span class="n">firing_rate</span><span class="p">(</span><span class="n">runner</span><span class="o">.</span><span class="n">mon</span><span class="p">[</span><span class="s1">&#39;B.spike&#39;</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mf">10.</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">runner</span><span class="o">.</span><span class="n">mon</span><span class="o">.</span><span class="n">ts</span><span class="p">,</span> <span class="n">rateA</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Group A&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">runner</span><span class="o">.</span><span class="n">mon</span><span class="o">.</span><span class="n">ts</span><span class="p">,</span> <span class="n">rateB</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Group B&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Firing rate [Hz]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Population activity&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># the external stimuli</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">runner</span><span class="o">.</span><span class="n">mon</span><span class="o">.</span><span class="n">ts</span><span class="p">,</span> <span class="n">runner</span><span class="o">.</span><span class="n">mon</span><span class="p">[</span><span class="s1">&#39;IA.freq&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;group A&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">runner</span><span class="o">.</span><span class="n">mon</span><span class="o">.</span><span class="n">ts</span><span class="p">,</span> <span class="n">runner</span><span class="o">.</span><span class="n">mon</span><span class="p">[</span><span class="s1">&#39;IB.freq&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;group B&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Input activity&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Firing rate [Hz]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
  <span class="n">gs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">pre_stimulus_period</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sa">u</span><span class="s1">&#39;#444444&#39;</span><span class="p">)</span>
  <span class="n">gs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">pre_stimulus_period</span> <span class="o">+</span> <span class="n">stimulus_period</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sa">u</span><span class="s1">&#39;#444444&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">t_start</span><span class="p">,</span> <span class="n">total_period</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time [ms]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6507ca74eeab7f2a4a9833d80dfbec8921054f6c416a6aba6af4384da1cc94c1.png" src="../_images/6507ca74eeab7f2a4a9833d80dfbec8921054f6c416a6aba6af4384da1cc94c1.png" />
</div>
</div>
<p>For more information about brain dynamic simulation, please refer to <a class="reference internal" href="../tutorial_simulation/index.html"><span class="doc std std-doc">Dynamics Simulation</span></a> in the BDP tutorial.</p>
</section>
</section>
<section id="simulating-a-firing-rate-based-network">
<h2>Simulating a firing rate-based network<a class="headerlink" href="#simulating-a-firing-rate-based-network" title="Permalink to this heading">#</a></h2>
<section id="neural-mass-model">
<h3>Neural mass model<a class="headerlink" href="#neural-mass-model" title="Permalink to this heading">#</a></h3>
<p>A neural mass models is a low-dimensional population model of spiking neural networks. It aims to describe the coarse grained activity of large populations of neurons and synapses. Mathematically, it is a dynamical system of non-linear ODEs. A classical neural mass model is the two-dimensional <a class="reference external" href="https://en.wikipedia.org/wiki/Wilson%E2%80%93Cowan_model">Wilson–Cowan model</a>. This model tracks the activity of an excitatory population of neurons coupled to an inhibitory population. With the augmentation of such models by more realistic forms of synaptic and network interaction they have proved especially successful in providing fits to neuro-imaging data.</p>
<p>Here, let’s try the Wilson-Cowan model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wc</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">rates</span><span class="o">.</span><span class="n">WilsonCowanModel</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>
                               <span class="n">wEE</span><span class="o">=</span><span class="mf">16.</span><span class="p">,</span> <span class="n">wIE</span><span class="o">=</span><span class="mf">15.</span><span class="p">,</span> <span class="n">wEI</span><span class="o">=</span><span class="mf">12.</span><span class="p">,</span> <span class="n">wII</span><span class="o">=</span><span class="mf">3.</span><span class="p">,</span>
                               <span class="n">E_a</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">I_a</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">E_theta</span><span class="o">=</span><span class="mf">3.</span><span class="p">,</span> <span class="n">I_theta</span><span class="o">=</span><span class="mf">3.</span><span class="p">,</span>
                               <span class="n">method</span><span class="o">=</span><span class="s1">&#39;exp_euler_auto&#39;</span><span class="p">,</span>
                               <span class="n">x_initializer</span><span class="o">=</span><span class="n">bm</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]),</span>
                               <span class="n">y_initializer</span><span class="o">=</span><span class="n">bm</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]))</span>

<span class="n">runner</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">DSRunner</span><span class="p">(</span><span class="n">wc</span><span class="p">,</span> <span class="n">monitors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;input&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">])</span>
<span class="n">runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mf">10.</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">gs</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">visualize</span><span class="o">.</span><span class="n">get_figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">bp</span><span class="o">.</span><span class="n">visualize</span><span class="o">.</span><span class="n">line_plot</span><span class="p">(</span><span class="n">runner</span><span class="o">.</span><span class="n">mon</span><span class="o">.</span><span class="n">ts</span><span class="p">,</span> <span class="n">runner</span><span class="o">.</span><span class="n">mon</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">plot_ids</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">bp</span><span class="o">.</span><span class="n">visualize</span><span class="o">.</span><span class="n">line_plot</span><span class="p">(</span><span class="n">runner</span><span class="o">.</span><span class="n">mon</span><span class="o">.</span><span class="n">ts</span><span class="p">,</span> <span class="n">runner</span><span class="o">.</span><span class="n">mon</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">plot_ids</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "256651e4664b4a9c853c2af1a6c1e9d1"}</script><img alt="../_images/11dc8ff14165795fe187806be1f753231c3ff98305bfe1811ddeb22af58c4260.png" src="../_images/11dc8ff14165795fe187806be1f753231c3ff98305bfe1811ddeb22af58c4260.png" />
</div>
</div>
<p>We can see this model at least has two stable states.</p>
<p><strong>Bifurcation diagram</strong></p>
<p>With the automatic analysis module in BrainPy, we can easily inspect the bifurcation digram of the model. Bifurcation diagrams can give us an overview of how different parameters of the model affect its dynamics (the details of the automatic analysis support of BrainPy please see the introduction in <a class="reference internal" href="analysis.html"><span class="doc std std-doc">Analyzing a Dynamical Model</span></a> and tutorials in <a class="reference internal" href="../tutorial_analysis/index.html"><span class="doc std std-doc">Dynamics Analysis</span></a>). In this case, we make <code class="docutils literal notranslate"><span class="pre">x_ext</span></code> as a bifurcation parameter, and try to see how the system behavior changes with the change of <code class="docutils literal notranslate"><span class="pre">x_ext</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bf</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">Bifurcation2D</span><span class="p">(</span>
  <span class="n">wc</span><span class="p">,</span>
  <span class="n">target_vars</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]},</span>
  <span class="n">target_pars</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;x_ext&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]},</span>
  <span class="n">pars_update</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;y_ext&#39;</span><span class="p">:</span> <span class="mf">0.</span><span class="p">},</span>
  <span class="n">resolutions</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;x_ext&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">bf</span><span class="o">.</span><span class="n">plot_bifurcation</span><span class="p">()</span>
<span class="n">bf</span><span class="o">.</span><span class="n">plot_limit_cycle_by_sim</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">bf</span><span class="o">.</span><span class="n">show_figure</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>I am making bifurcation analysis ...
I am filtering out fixed point candidates with auxiliary function ...
I am trying to find fixed points by optimization ...
	There are 40000 candidates
I am trying to filter out duplicate fixed points ...
	Found 579 fixed points.
I am plotting the limit cycle ...
</pre></div>
</div>
<img alt="../_images/3e1dad4ca5099b115d2fdc12e6ec5fffb01961f882612d90c0aa39cd52bedbef.png" src="../_images/3e1dad4ca5099b115d2fdc12e6ec5fffb01961f882612d90c0aa39cd52bedbef.png" />
<img alt="../_images/b4f3ba0f2cd2eb3f7eb7c3f2c417a98d9d10a682ecd780c97866de989d600d87.png" src="../_images/b4f3ba0f2cd2eb3f7eb7c3f2c417a98d9d10a682ecd780c97866de989d600d87.png" />
</div>
</div>
<p>Similarly, simulating and analyzing a rate-based FitzHugh-Nagumo model is also a piece of cake by using BrainPy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fhn</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">rates</span><span class="o">.</span><span class="n">FHN</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;exp_auto&#39;</span><span class="p">)</span>

<span class="n">bf</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">Bifurcation2D</span><span class="p">(</span>
  <span class="n">fhn</span><span class="p">,</span>
  <span class="n">target_vars</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]},</span>
  <span class="n">target_pars</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;x_ext&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]},</span>
  <span class="n">pars_update</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;y_ext&#39;</span><span class="p">:</span> <span class="mf">0.</span><span class="p">},</span>
  <span class="n">resolutions</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;x_ext&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">bf</span><span class="o">.</span><span class="n">plot_bifurcation</span><span class="p">()</span>
<span class="n">bf</span><span class="o">.</span><span class="n">plot_limit_cycle_by_sim</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">bf</span><span class="o">.</span><span class="n">show_figure</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>I am making bifurcation analysis ...
I am filtering out fixed point candidates with auxiliary function ...
I am trying to find fixed points by optimization ...
	There are 20000 candidates
I am trying to filter out duplicate fixed points ...
	Found 200 fixed points.
I am plotting the limit cycle ...
</pre></div>
</div>
<img alt="../_images/4f43e52a1a92363d7c7a5d9375cca6f4a3c27289f73d78694b803dcb104bee42.png" src="../_images/4f43e52a1a92363d7c7a5d9375cca6f4a3c27289f73d78694b803dcb104bee42.png" />
<img alt="../_images/0c4ccdb2620bf72fcd77d51a8d0f55f94eddfc755f25513e0d70c508c9be2a41.png" src="../_images/0c4ccdb2620bf72fcd77d51a8d0f55f94eddfc755f25513e0d70c508c9be2a41.png" />
</div>
</div>
<p>In this model, we find that when the external input <code class="docutils literal notranslate"><span class="pre">x_ext</span></code> has the value in [0.72, 1.4], the model will generate limit cycles. We can verify this by simulation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">runner</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">DSRunner</span><span class="p">(</span><span class="n">fhn</span><span class="p">,</span> <span class="n">monitors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;input&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mf">100.</span><span class="p">)</span>

<span class="n">bp</span><span class="o">.</span><span class="n">visualize</span><span class="o">.</span><span class="n">line_plot</span><span class="p">(</span><span class="n">runner</span><span class="o">.</span><span class="n">mon</span><span class="o">.</span><span class="n">ts</span><span class="p">,</span> <span class="n">runner</span><span class="o">.</span><span class="n">mon</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">bp</span><span class="o">.</span><span class="n">visualize</span><span class="o">.</span><span class="n">line_plot</span><span class="p">(</span><span class="n">runner</span><span class="o">.</span><span class="n">mon</span><span class="o">.</span><span class="n">ts</span><span class="p">,</span> <span class="n">runner</span><span class="o">.</span><span class="n">mon</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "aaf7c785ae5941e69d2d30837197f265"}</script><img alt="../_images/9250b8b1d816e5f503af8c1600ce9b87090dbec1b1eb7511f4ca995a35fc3535.png" src="../_images/9250b8b1d816e5f503af8c1600ce9b87090dbec1b1eb7511f4ca995a35fc3535.png" />
</div>
</div>
</section>
<section id="whole-brain-model">
<h3>Whole-brain model<a class="headerlink" href="#whole-brain-model" title="Permalink to this heading">#</a></h3>
<p>A rate-based whole-brain model is a network model which consists of coupled brain regions. Each brain region is represented by a neural mass model which is connected to other brain regions according to the underlying network structure of the brain, also known as the connectome. In order to illustrate how to use BrainPy’s support for whole-brain modeling, here we provide a processed data in the following link:</p>
<ul class="simple">
<li><p>A processed data from ConnectomeDB of the Human Connectome Project (HCP): <a class="reference external" href="https://share.weiyun.com/wkPpARKy">https://share.weiyun.com/wkPpARKy</a></p></li>
</ul>
<p>Please download the dataset and place it in your favorite <code class="docutils literal notranslate"><span class="pre">PATH</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">PATH</span> <span class="o">=</span> <span class="s1">&#39;./data/hcp.npz&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>In general, a dataset for whole-brain modeling consists of the following parts:</p>
<p>1. A structural connectivity matrix which captures the synaptic connection strengths between brain areas. It often derived from DTI tractography of the whole brain. The connectome is then typically parcellated in a preferred atlas (for example the AAL2 atlas) and the number of axonal fibers connecting each brain area with every other area is counted. This number serves as an indication of the synaptic coupling strengths between the areas of the brain.</p>
<p>2. A delay matrix which calculated from the average length of the axonal fibers connecting each brain area with another.</p>
<p>3. A set of functional data that can act as a target for model optimization. Resting-state fMRI offers an easy and fairly unbiased way for calibrating whole-brain models. EEG data could be used as well.</p>
<p>Now, let’s load the dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">bm</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">PATH</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The structural connectivity matrix</span>

<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Cmat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(80, 80)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The fiber length matrix</span>

<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Dmat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(80, 80)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The functional data for 7 subjects</span>

<span class="n">data</span><span class="p">[</span><span class="s1">&#39;FCs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(7, 80, 80)
</pre></div>
</div>
</div>
</div>
<p>Let’s have a look what the data looks like.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;image.cmap&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;plasma&#39;</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.28</span><span class="p">)</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Cmat&#39;</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Connection matrix&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.046</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Dmat&#39;</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;inferno&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Fiber length matrix&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.046</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;FCs&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;inferno&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Empirical FC of subject 1&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.046</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/51d426717d6909aaddcb8415548ab8e527c7b0685beb687bf566fcc25ef3ba04.png" src="../_images/51d426717d6909aaddcb8415548ab8e527c7b0685beb687bf566fcc25ef3ba04.png" />
</div>
</div>
<p>Let’s first get the delay matrix according to the fiber length matrix, the signal transmission speed between areas, and the numerical integration step <code class="docutils literal notranslate"><span class="pre">dt</span></code>. Here, we assume the axonal transmission speed is 20 and the simulation time step <code class="docutils literal notranslate"><span class="pre">dt=0.1</span></code> ms.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sigal_speed</span> <span class="o">=</span> <span class="mf">20.</span>

<span class="c1"># the number of the delay steps</span>
<span class="n">delay_mat</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Dmat&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">sigal_speed</span> <span class="o">/</span> <span class="n">bm</span><span class="o">.</span><span class="n">get_dt</span><span class="p">()</span>
<span class="n">delay_mat</span> <span class="o">=</span> <span class="n">bm</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">delay_mat</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">bm</span><span class="o">.</span><span class="n">int_</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The connectivity matrix can be directly obtained through the structural connectivity matrix, which times a global coupling strength parameter <code class="docutils literal notranslate"><span class="pre">gc</span></code>. b</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gc</span> <span class="o">=</span> <span class="mf">1.</span>

<span class="n">conn_mat</span> <span class="o">=</span> <span class="n">bm</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Cmat&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">gc</span><span class="p">)</span>

<span class="c1"># It is necessary to exclude the self-connections</span>
<span class="n">bm</span><span class="o">.</span><span class="n">fill_diagonal</span><span class="p">(</span><span class="n">conn_mat</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We now are ready to instantiate a whole-brain model with the neural mass model and the dataset the processed before.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">WholeBrainNet</span><span class="p">(</span><span class="n">bp</span><span class="o">.</span><span class="n">Network</span><span class="p">):</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Cmat</span><span class="p">,</span> <span class="n">Dmat</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">WholeBrainNet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">fhn</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">rates</span><span class="o">.</span><span class="n">FHN</span><span class="p">(</span>
      <span class="mi">80</span><span class="p">,</span>
      <span class="n">x_ou_sigma</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
      <span class="n">y_ou_sigma</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
      <span class="n">method</span><span class="o">=</span><span class="s1">&#39;exp_auto&#39;</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">syn</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">DiffusiveCoupling</span><span class="p">(</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">fhn</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">fhn</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
      <span class="n">var_to_output</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fhn</span><span class="o">.</span><span class="n">input</span><span class="p">,</span>
      <span class="n">conn_mat</span><span class="o">=</span><span class="n">Cmat</span><span class="p">,</span>
      <span class="n">delay_steps</span><span class="o">=</span><span class="n">Dmat</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">bm</span><span class="o">.</span><span class="n">int_</span><span class="p">),</span>
      <span class="n">initial_delay_data</span><span class="o">=</span><span class="n">bp</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">net</span> <span class="o">=</span> <span class="n">WholeBrainNet</span><span class="p">(</span><span class="n">conn_mat</span><span class="p">,</span> <span class="n">delay_mat</span><span class="p">)</span>

<span class="n">runner</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">DSRunner</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">monitors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;fhn.x&#39;</span><span class="p">],</span> <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;fhn.input&#39;</span><span class="p">,</span> <span class="mf">0.72</span><span class="p">])</span>
<span class="n">runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mf">6e3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "258e015bbea84e8fa7dd128ab573d57b"}</script></div>
</div>
<p>The simulated results can be used to estimate the functional correlation matrix.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">fc</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">measure</span><span class="o">.</span><span class="n">functional_connectivity</span><span class="p">(</span><span class="n">runner</span><span class="o">.</span><span class="n">mon</span><span class="p">[</span><span class="s1">&#39;fhn.x&#39;</span><span class="p">])</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">fc</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">runner</span><span class="o">.</span><span class="n">mon</span><span class="o">.</span><span class="n">ts</span><span class="p">,</span> <span class="n">runner</span><span class="o">.</span><span class="n">mon</span><span class="p">[</span><span class="s1">&#39;fhn.x&#39;</span><span class="p">][:,</span> <span class="p">::</span><span class="mi">5</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9b757c334d4e79cf2991c0b9b1c919457ed2ab7de1e334b751a96c4f24bcc8a3.png" src="../_images/9b757c334d4e79cf2991c0b9b1c919457ed2ab7de1e334b751a96c4f24bcc8a3.png" />
</div>
</div>
<p>We can compute the element-wise Pearson correlation of the functional connectivity matrices of the simulated data to the empirical data to estimate how well the model captures the inter-areal functional correlations found in empirical resting-state recordings.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scores</span> <span class="o">=</span> <span class="p">[</span><span class="n">bp</span><span class="o">.</span><span class="n">measure</span><span class="o">.</span><span class="n">matrix_correlation</span><span class="p">(</span><span class="n">fc</span><span class="p">,</span> <span class="n">fcemp</span><span class="p">)</span>
          <span class="k">for</span> <span class="n">fcemp</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;FCs&#39;</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Correlation per subject:&quot;</span><span class="p">,</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">s</span><span class="si">:</span><span class="s2">.2</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">scores</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean FC/FC correlation: </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bm</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bm</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">scores</span><span class="p">))))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Correlation per subject: [&#39;0.61&#39;, &#39;0.48&#39;, &#39;0.56&#39;, &#39;0.5&#39;, &#39;0.56&#39;, &#39;0.49&#39;, &#39;0.44&#39;]
Mean FC/FC correlation: 0.52
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>van Vreeswijk, C., &amp; Sompolinsky, H. (1996). Chaos in neuronal networks with balanced excitatory and inhibitory activity. Science (New York, N.Y.), 274(5293), 1724–1726. https://doi.org/10.1126/science.274.5293.1724</p></li>
<li><p>Wang X. J. (2002). Probabilistic decision making by slow reverberation in cortical circuits. Neuron, 36(5), 955–968. https://doi.org/10.1016/s0896-6273(02)01092-9</p></li>
</ol>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "brainpy"
        },
        kernelOptions: {
            name: "brainpy",
            path: "./quickstart"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'brainpy'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="installation.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Installation</p>
      </div>
    </a>
    <a class="right-next"
       href="training.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Training a Brain Dynamics Model</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simulating-an-e-i-balanced-network">Simulating an E-I balanced network</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#building-an-e-i-balanced-network">Building an E-I balanced network</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#running-a-simulation">Running a simulation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simulating-a-decision-making-network">Simulating a decision-making network</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#building-a-decision-making-network">Building a decision-making network</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Running a simulation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simulating-a-firing-rate-based-network">Simulating a firing rate-based network</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#neural-mass-model">Neural mass model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#whole-brain-model">Whole-brain model</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By BrainPy Team
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2020-2023, BrainPy.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on Apr 03, 2023.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>